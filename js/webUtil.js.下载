"use strict";function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}if(typeof webUtil=="undefined"){var webUtil={}}$(document).ready(function(){if(!!window.chrome)$(".a").addClass("isFontChrome");if(!window.chrome&&navigator.userAgent.indexOf("Safari")>-1){$("body").addClass("isSafari")}});if(typeof sysUtil=="undefined"){webUtil.onlineMapDrag=function(mdId){};webUtil.setMoreColumn=function(mdId){}}webUtil.initFormTab_bak=function(id,delayTime,autoPlay,effectMode,template){template=template||"formTab";require(["jquery","SuperSlide"],function($){$("#"+id+" .formTabText li").removeClass("on");$("#"+id+" td.formTab_td").hide();$("#"+id+" .formTabText li:first").addClass("on");$("#"+id+" td.formTab_td:first").show();var formWidth=$("#"+template+"_"+id).width();$("#"+template+"_"+id+" .formTabBox > div").slide({titCell:".formTabText li",mainCell:".formTabContent tr",effect:"fade",easing:"swing",prevCell:".formPrv",nextCell:".formNext",trigger:effectMode,defaultIndex:0,delayTime:delayTime,autoPlay:autoPlay,pnLoop:true,startFun:function startFun(i,c){var photoPanel2=$("#"+template+"_"+id+" .formTab_td").eq(i).find(".listPhotoPanel2");if(photoPanel2.length>0){photoPanel2.find(".tempWrap").css({width:formWidth-100})}var photoPanel3=$("#"+template+"_"+id+" .formTab_td").eq(i).find(".listPhotoPanel3");if(photoPanel3.length>0){photoPanel3.find(".tempWrap").css({width:formWidth})}var productBox2=$("#"+template+"_"+id+" .formTab_td").eq(i).find(".productStyleBox2");if(productBox2.length>0){productBox2.find(".tempWrap").css({width:formWidth})}}})})};webUtil.initFormTab=function(id,delayTime,autoPlay,effectMode,template){template=template||"formTab";require(["jquery","SuperSlide"],function($){var mainCellSelector=$("#"+id+" .formTabContent").hasClass("noTable")?".formTabContent .noTabletr":".formTabContent tr";$("#"+id+" .formTabText li").removeClass("on");$("#"+id+" .formTab_td").hide();$("#"+id+" .formTabText li:first").addClass("on");$("#"+id+" .formTab_td:first").show();var formWidth=$("#"+template+"_"+id).width();$("#"+template+"_"+id+" .formTabBox > div").slide({titCell:".formTabText li",mainCell:mainCellSelector,effect:"fade",easing:"swing",prevCell:".formPrv",nextCell:".formNext",trigger:effectMode,defaultIndex:0,delayTime:delayTime,autoPlay:autoPlay,pnLoop:true,startFun:function startFun(i,c){var photoPanel2=$("#"+template+"_"+id+" .formTab_td").eq(i).find(".listPhotoPanel2");if(photoPanel2.length>0){photoPanel2.find(".tempWrap").css({width:formWidth-100})}var photoPanel3=$("#"+template+"_"+id+" .formTab_td").eq(i).find(".listPhotoPanel3");if(photoPanel3.length>0){photoPanel3.find(".tempWrap").css({width:formWidth})}var productBox2=$("#"+template+"_"+id+" .formTab_td").eq(i).find(".productStyleBox2");if(productBox2.length>0){productBox2.find(".tempWrap").css({width:formWidth})}}})})};webUtil.setImageFit=function(dom,mdId){require(["jquery","imagefit"],function(){var imgdefereds=[];var $imgs=$(dom+" img");if($imgs.length>0){$imgs.each(function(){var dfd=$.Deferred();$(this).bind("load",function(){dfd.resolve()}).bind("error",function(){});if(this.complete)dfd.resolve();imgdefereds.push(dfd)});$.when.apply(null,imgdefereds).done(function(){if(mdId){$(dom).imagefit(mdId)}else{$(dom).imagefit()}})}})};webUtil.setProductEffects=function(id,template,imageEffects,sHex,opacity){require(["jquery","color_exchange","SuperSlide"],function($){var templateID="#"+template+"_"+id;var box_w=$(templateID+" .productImgForm:first").data("pwidth");var box_h=$(templateID+" .productImgForm:first").data("pheight");var sRgbColor=sHex.colorRgb();var rgba=sRgbColor+","+opacity;if(imageEffects=="effects2"){$(templateID+" .effects2 li.imgDiv").hover(function(){$(this).find(".productImgForm_c a.productEffects span").css({width:box_w,height:box_h});$(this).find(".productImgForm_c a.productEffects").fadeIn(500)},function(){$(this).find(".productImgForm_c a.productEffects").stop(true,true).fadeOut(500)})}else if(imageEffects=="effects4"){$(templateID+" .effects4 .productDetailForm,"+templateID+" .effects4 .productDetailForm2").css({"background-color":"rgba("+rgba+")",width:box_w,height:box_h});$(templateID+" .effects4 li.imgDiv").hover(function(){var pTags=$(this).find(".productDetailForm1");pTags.parent().is("a")?pTags.unwrap():"";pTags.fadeIn(500);pTags.wrap('<a href="'+pTags.attr("data-href")+'" target="'+pTags.attr("data-target")+'"/>')},function(){var pTags=$(this).find(".productDetailForm1");pTags.parent().is("a")?pTags.unwrap():"";pTags.stop(true,true).fadeOut(500)})}else if(imageEffects=="effects5"){$(templateID+" .effects5 .productDetailForm,"+templateID+" .effects5 .productDetailForm2").css({"background-color":"rgba("+rgba+")",width:box_w});$(templateID+" .effects5 li.imgDiv").hover(function(){$(this).find(".productDetailForm1").slideDown(500)},function(){$(this).find(".productDetailForm1").stop(true,true).slideUp(500)});$(templateID+" .effects5 .productDetailForm1").click(function(){if($(this).data("target")=="_blank"){window.open($(this).data("href"))}else{window.location.href=$(this).data("href")}})}})};webUtil.setProductModel=function(id,template,modelstyle,temp,productParameter,witching,rolling){require(["jquery","SuperSlide"],function(){var templateID="#"+template+"_"+id;var tempClass="."+template+"_"+id;var boxm=$(templateID+" #proList_"+id).data("boxm");var num=$(templateID+" #proList_"+id).data("boxw");if(modelstyle=="productStyleBox2"||modelstyle=="productStyleBox3"){if(modelstyle=="productStyleBox3"&&$("body").hasClass("edit")){num=num-120}$(templateID+" ul#proList_"+id).data("listw",num/temp)}if(modelstyle=="productStyleBox2"){$(tempClass+"_view").slide({mainCell:".bd ul",autoPlay:true,effect:"leftMarquee",vis:temp,interTime:rolling,pnLoop:true,trigger:"click",autoPage:true})}if(modelstyle=="productStyleBox3"){$(tempClass+"_view").slide({mainCell:".bd ul",effect:"left",delayTime:800,vis:temp,scroll:witching,pnLoop:false,trigger:"click",easing:"easeOutCubic",autoPage:true})}if(modelstyle=="productStyleBox2"||modelstyle=="productStyleBox3"){$(templateID+" .tempWrap").css({width:num});$(templateID+" .tempWrap .imgDiv").css({width:num/temp})}if(modelstyle=="productStyleBox1"||modelstyle=="productStyleBox2"||modelstyle=="productStyleBox3"){var $div=$(templateID+" .imgDiv a.productImgForm");var box_w=$div.data("pwidth");if(productParameter!=="parameter5"){$(templateID+" .productDetailForm").css({width:box_w,margin:"0 auto"})}}if(WebModel=="view"){webUtil.setImageFit("#proList_"+id+" .imgDiv a.productImgForm")}})};webUtil.setProductParameter=function(id,template,Parameter,modelstyle,column){var templateID="#"+template+"_"+id;var num=$(templateID+" .imgDiv").width();var num1=$(templateID+" .productImgForm").data("pwidth");var num2=$(templateID+" #proList_"+id).data("boxw");var boxm=$(templateID+" #proList_"+id).data("boxm");num2=num2-Number(boxm);if(modelstyle=="productStyleBox4"){num2=num2/column;if(num1>num2/2){$(templateID+" .productDetailForm1").css({width:num2/2-17+"px"})}else{$(templateID+" .productDetailForm1").css({width:num2-num1-17+"px"})}}else{if(num1>num){$(templateID+" .productDetailForm2,"+templateID+" .productDetailForm").css({width:num-2-40+"px"})}else{$(templateID+" .productDetailForm2,"+templateID+" .productDetailForm").css({width:num1-2-40+"px"})}}};webUtil.lazyloadList=function(img,rebox){require(["jquerylazyload"],function(){$(img).lazyload({re_box:rebox,data_attribute:"src",effect:"fadeIn",effectspeed:200,threshold:0})})};webUtil.setListImageEffect=function(mdId,showRowPicNum,temp,opp,delayTime,autoPlay,scroll,interTime,styleMode){autoPlay=window.WebModel=="edit"?false:autoPlay;require(["jquery","SuperSlide"],function($){var con_w=$("#"+mdId+" .photoListContainer").width();var list_w=$("#"+mdId+" .listPhotoBox_view").width();if(list_w<=con_w){var box_w=($("#"+mdId+" .photoListContainer").width()-100)/showRowPicNum;$("#picList_"+mdId+" li.listPhotoSize").css({width:box_w})}var $parentBox=$("#"+mdId+" .scroll_list");if($parentBox.children("div").hasClass("tempWrap")){var tempHtml=$parentBox.children("div.tempWrap").html();$parentBox.html(tempHtml)}if(styleMode=="1"){$("#"+temp+"_"+mdId+" .listPhotoPanel2").slide({titCell:"listPhotoPanel2 ul",mainCell:".scroll_list ul",effect:"left",easing:"swing",opp:opp,delayTime:delayTime,autoPlay:autoPlay,vis:showRowPicNum,pnLoop:false,scroll:scroll,autoPage:true})}else if(styleMode=="2"){var SM2AutoPlay=window.WebModel=="edit"?false:true;if(!$("body").hasClass("edit")){$("#listPhoto_"+mdId+" .listPhotoBox .listPhotoPanel3 .picList").find(".clone").remove()}$("#"+temp+"_"+mdId+" .listPhotoPanel3").slide({mainCell:"ul",effect:"leftMarquee",opp:opp,vis:showRowPicNum,autoPlay:SM2AutoPlay,interTime:interTime,switchLoad:"_src"})}})};webUtil.setListPhotoSlide=function(mdId,picOutMode,slideMode,showMode,styleMode){require(["fancyJs"],function(){if(picOutMode=="1"&&slideMode=="0"){$("#picList_"+mdId+" .fancybox_"+mdId).fancybox({titleShow:true,titlePosition:"over",helpers:{overlay:{closeClick:false},title:{type:"over"}}})}if(picOutMode=="1"&&slideMode=="1"){require(["fancybox/jquery.fancybox-thumbs"],function(){$("#picList_"+mdId+" .fancybox-thumbs_"+mdId).fancybox({prevEffect:"none",nextEffect:"none",closeBtn:true,arrows:true,nextClick:true,titleShow:true,helpers:{thumbs:{width:50,height:50},title:{type:"over"},overlay:{closeClick:false}}})})}});if(showMode!=="0"){if($("#picList_"+mdId+" img.lazy").length>0){webUtil.lazyloadList("#picList_"+mdId+" img.lazy",".photo_list")}else{webUtil.setImageFit("#picList_"+mdId+" div.photo_list")}}};webUtil.setListPhotoOffset=function(mdId,showRowPicNum){var widthSize=$("#picList_"+mdId+" .photo_list:first").css("width");$("#picList_"+mdId+" .listPhotoText").css({width:widthSize});if(showRowPicNum=="3"){$("#picList_"+mdId+" .listPhotoText").css({width:widthSize});$("#picList_"+mdId+" .photo_fullText").css({width:widthSize,left:86});$("#picList_"+mdId+" .photo_halfText").css({width:widthSize,left:86})}else if(showRowPicNum=="2"){$("#picList_"+mdId+" .listPhotoText").css({width:widthSize});$("#picList_"+mdId+" .photo_fullText").css({width:widthSize,left:186});$("#picList_"+mdId+" .photo_halfText").css({width:widthSize,left:186})}else if(showRowPicNum=="1"){$("#picList_"+mdId+" .listPhotoText").css({width:widthSize});$("#picList_"+mdId+" .photo_fullText").css({width:widthSize,left:484});$("#picList_"+mdId+" .photo_halfText").css({width:widthSize,left:484})}};webUtil.setListPhotoDev=function(mdId){var widthSize=$("#picList_"+mdId+" .photo_list:first").data("pwidth");var halfWidth=-widthSize/2;$("#picList_"+mdId+" .listPhotoText").css({width:widthSize});$("#picList_"+mdId+" .photo_fullText,#picList_"+mdId+" .photo_halfText").css({width:widthSize,left:"50%","margin-left":halfWidth})};webUtil.setListBgColor=function(opacity,bgColor,bgDom){var color=dataUtil.ChangeRgb(bgColor);var fcolor="rgba("+color+","+opacity+")";$(bgDom).css({background:fcolor})};webUtil.setListPhotoEffect=function(mdId,hoverMode,dscHeight,picOutMode){if(hoverMode!="3"||hoverMode!="4"){if(picOutMode!="2"){$("#picList_"+mdId+" .listPhotoTextAlign").click(function(e){var parNode=this.parentNode;var alignDom=parNode.getElementsByTagName("a");for(var i=0;i<alignDom.length;i++){alignDom[0].click()}})}}if(hoverMode=="1"){$("#picList_"+mdId+" .photo_borderMask").hide();$("#picList_"+mdId+" li.listPhotoSpacing").hover(function(){$(this).find(".photo_borderMask").stop().fadeIn(500)},function(){$(this).find(".photo_borderMask").stop().fadeOut(500)})}else if(hoverMode=="2"){$("#picList_"+mdId+" .photo_mask").hide();$("#picList_"+mdId+" li.listPhotoSpacing").hover(function(){$(this).find(".photo_mask").stop().fadeIn(500)},function(){$(this).find(".photo_mask").stop().fadeOut(500)})}else if(hoverMode=="3"){var fmDom=$("#picList_"+mdId+" .fBgcolor");$(fmDom).hide();$("#picList_"+mdId+" li.listPhotoSpacing").hover(function(){$(this).find(".photo_fullMask").stop().fadeTo(500,1);$(this).find(".photo_fullText").stop().fadeIn(500)},function(){$(this).find(".photo_fullMask").stop().fadeTo(500,0);$(this).find(".photo_fullText").stop().fadeOut(500)})}else if(hoverMode=="4"){$("#picList_"+mdId+" li.listPhotoSpacing").hover(function(){$(this).find(".photo_halfMask").stop().animate({bottom:"0"},500);$(this).find(".photo_halfText").stop().animate({bottom:"0"},500)},function(){$(this).find(".photo_halfMask").stop().animate({bottom:-dscHeight},500);$(this).find(".photo_halfText").stop().animate({bottom:-dscHeight},500)})}};webUtil.setListPhotoPage=function(mdId,num_entries,showCount,pageNum,picOutMode,hoverMode,dscHeight,opacity,bgColor){require(["jquery.Mpagination"],function(){$("#Pagination_"+mdId).pagination(num_entries,{first_text:langUtil.Global_first,end_text:langUtil.Global_endPage,prev_text:langUtil.Global_prePage,next_text:langUtil.Global_nextPage,num_edge_entries:1,num_display_entries:6,callback:pageselectCallback,items_per_page:showCount});function pageselectCallback(page_index,jq){var max_elem=Math.min((page_index+1)*showCount,num_entries);$("#picList_"+mdId).html("");for(var i=page_index*showCount;i<max_elem;i++){var resultId=$("#result_"+mdId).children("span").eq(i);var resultHtml=$("#photo_tpl_"+mdId);var data_img=resultId.data("img");var data_name=resultId.data("name");var data_link=resultId.data("link");if(resultId.text()!=""){try{data_link=JSON.parse(resultId.text())}catch(error){data_link=resultId.text()}}var data_open=resultId.data("open");var data_describe="";var data_result=String(data_name);var data_title=data_result.replace(/<br>/gi,"&#10;");var data_type=resultId.data("type");var linkObj={};if(resultId.data("describe")){data_describe=resultId.data("describe")}if(picOutMode=="1"){resultHtml.find("a").attr("href",data_img)}else if(picOutMode=="0"){var linkDom=resultHtml.find("a");linkDom.removeAttr("data-video").removeClass("appLink_member_login appLink_online_video appLink_online_anchor appLink_online_copy");if(data_type){if(data_type=="setAppLink"){linkObj.class=data_open;if(data_open=="appLink_online_video"){linkObj.video=data_link}else if(data_open=="appLink_online_anchor"){linkObj.anchor=data_link}else if(data_open=="appLink_online_copy"){linkObj.copy=data_link}}else if(data_link){linkObj.href=data_link;if(data_open){linkObj.target=data_open}}if(linkObj.href){linkDom.attr("href",linkObj.href)}else{linkDom.removeAttr("href")}if(linkObj.target){linkDom.attr("target",linkObj.target)}if(linkObj.video){linkDom.attr("data-video",linkObj.video)}else{linkDom.removeAttr("data-video")}if(linkObj.anchor){linkDom.attr("data-anchor",linkObj.anchor)}else{linkDom.removeAttr("data-anchor")}if(linkObj.copy){linkDom.attr("data-copytext",linkObj.copy.copyText||"");linkDom.attr("data-copytips",linkObj.copy.copyTips||"")}else{linkDom.removeAttr("data-copytext").removeAttr("data-copytips")}if(linkObj.class){linkDom.addClass(linkObj.class)}}else{if(data_link){linkDom.attr("href",data_link)}else{linkDom.attr("href","javascript:void(0)")}}}resultHtml.find("a").attr("title",data_name);resultHtml.find("img").addClass("lazy").attr("alt",data_name);var fancyTitle="<p><b>"+data_name+"</b></p>"+data_describe;resultHtml.find("a").attr("data-fancybox-title",fancyTitle);resultHtml.find("img").attr("data-src",data_img);resultHtml.find(".listPhotoTextAlign").children(".desTitle").html(data_name);resultHtml.find(".listPhotoTextAlign").attr("title",data_title);resultHtml.find(".listPhotoTextAlign").children(".desText").html(data_describe);$("#photo_tpl_"+mdId).children("li").clone().appendTo("#picList_"+mdId);if((i+1)%pageNum==0){var html='<div style="clear: both;"></div>';$(html).appendTo("#picList_"+mdId)}}var bgDom;if(hoverMode=="3"){bgDom=$("#picList_"+mdId+" .fBgcolor")}else if(hoverMode=="4"){bgDom=$("#picList_"+mdId+" .listPhotoTextAlign")}webUtil.setListBgColor(opacity,bgColor,bgDom);webUtil.setListPhotoOffset(mdId,pageNum);if($("#picList_"+mdId+" img.lazy").length>0){webUtil.lazyloadList("#picList_"+mdId+" img.lazy",".re_box")}else{webUtil.setImageFit("#picList_"+mdId+" .re_box")}webUtil.setListPhotoEffect(mdId,hoverMode,dscHeight,picOutMode);return false}})};webUtil.createProType=function(id,temp,fid,tempClass,childMenu,showStyle,defaultStyle,navStyle){var data=dataUtil.loadProductType();var dom="proList_"+id;var pId=dataUtil.GetQueryString("proTypeID");var reg=new RegExp(/design\/website\/(\S*)/);if(data.result=="SUCCESS"){var html="";var tempUrl="";var tempOn="";fid=Number(fid);$.each(data.data.rows,function(i,item){if(item.fatherId==fid){var n=0;$.each(data.data.rows,function(i,child){if(child.fatherId==item.productTypeId){n=n+1}});html+='<li class="sec '+tempClass+'"><a href="';if(temp=="1"&&n&&childMenu==1){html+="#";html+='" class="sp'+(item.productTypeId==pId?" on":"")+(showStyle==1&&defaultStyle==1?" navOpen":"")}else{html+="product.html?proTypeID="+item.productTypeId;if(item.productTypeId==pId){html+='" class="on action_jump';html+=showStyle==1&&defaultStyle==1?" navOpen":""}else{html+='" class="action_jump'}}html+='"';html+="><span>"+item.typeName+"</span></a>";if(childMenu==1){if(n){html+="<ul>"}$.each(data.data.rows,function(i,child){if(child.fatherId==item.productTypeId){var s=0;$.each(data.data.rows,function(i,gchild){if(gchild.fatherId==child.productTypeId){s=s+1}});html+='<li><a href="';if(temp=="1"&&s){html+="#";html+='" class="sp'+(child.productTypeId==pId?" on":"")+(showStyle==1&&defaultStyle==1?" navOpen":"")}else{html+="product.html?proTypeID="+child.productTypeId;if(child.productTypeId==pId){html+='" class="on action_jump';html+=showStyle==1&&defaultStyle==1?" navOpen":""}else{html+='" class="action_jump'}}html+='"';html+="><span>"+child.typeName+"</span></a>";if(s){html+="<ul>"}$.each(data.data.rows,function(i,gchild){if(gchild.fatherId==child.productTypeId){html+='<li><a href="';html+="product.html?proTypeID="+gchild.productTypeId;tempOn=gchild.productTypeId==pId?' class="on action_jump"':'class="action_jump"';html+='"'+tempOn+"><span>"+gchild.typeName+"</span></a>";html+="</li>"}});if(s){html+="</ul>"}html+="</li>"}});if(n){html+="</ul>"}}html+="</li>"}});$("#"+dom).html("");$("#"+dom).html(html);webUtil.setProType(id,navStyle,showStyle,childMenu,defaultStyle)}};webUtil.setProType=function(id,navStyle,showStyle,childMenu,defaultStyle){var dom="proList_"+id;var pId=dataUtil.GetQueryString("proTypeID");var temp=0;if(navStyle=="2"){$("#"+dom+" li").hover(function(){$(this).children("ul").stop(true,true).show("fast")},function(){$(this).children("ul").stop(true,true).hide("fast")})}else{if(showStyle=="1"){if(showStyle==1&&defaultStyle==1){$("#"+dom).children("li").children("ul").show();$("#"+dom).find("a.sp").addClass("navOpen")}else{$("#"+dom).children("li").find("ul").hide();$("#"+dom).find("a.sp").removeClass("navOpen")}if($("#"+dom).find("a").hasClass("on")){temp=1}if(temp==1){if($("#"+dom).find("a.on").next().length>0){$("#"+dom).find("a.on").addClass("navOpen")}var $obj=$("#"+dom).find("a.on").parent("li").parent("ul:not('.productList')");var $obj1=$obj.parent("li").parent("ul:not('.productList')");var $obj2=$("#"+dom).find("a.on").parent("li").children("ul");if($obj){if($obj.prev().length>0){$obj.prev().addClass("navOpen")}$obj.show()}if($obj1){if($obj1.prev().length>0){$obj1.prev().addClass("navOpen")}$obj1.show()}if($obj2){if($obj2.prev().length>0){$obj2.prev().addClass("navOpen")}$obj2.show()}}if(childMenu==1){$("#"+dom).find("a.sp").click(function(){if($(this).hasClass("navOpen")){$(this).parent("li").children("ul").slideUp("fast");$(this).removeClass("navOpen")}else{$(this).parent("li").children("ul").slideDown("fast");$(this).addClass("navOpen")}})}}}if(childMenu=="0"){$("#"+dom).children("li").find("ul").hide();$("#"+dom).find("a.sp").removeClass("navOpen")}};webUtil.setDisProSlide=function(id,dom,temp,autoPage,effect){require(["jquery","SuperSlide"],function($){$("#"+id+" .picShow").slide(_defineProperty({titCell:".hdd ul",mainCell:".bdd ul",autoPage:autoPage,effect:effect,autoPlay:false,scroll:1,vis:temp,delayTime:500,pnLoop:false,easing:"easeOutCirc",trigger:"click"},"autoPage",true));$("#disp_"+id+" .descShow").slide({delayTime:0});$("#disp_"+id+" .imgList li a").mouseenter(function(e){var $dom=$(e.currentTarget);var $el=$("#disp_"+id+" .bigImgShow p");if($dom.attr("data-type")==2){$("#disp_"+id+" .bigImg").hide();$el.addClass("edui-upload-video");$el.css({"background-image":"url("+$el.attr("middtbnurl")+")"});$("#disp_"+id+" .bigImgShow p#isVideoEl").show()}else{$("#disp_"+id+" .bigImg").show();$el.removeClass("edui-upload-video");$el.css({"background-image":""});$("#disp_"+id+" .bigImgShow p#isVideoEl").hide();if($("#disp_"+id+" .picZoomer-pic").length>0){$("#disp_"+id+" .picZoomer-pic").attr("src",$(this).find("img").attr("src"));var w=$("#disp_"+id+" .bigImg").width();var h=$("#disp_"+id+" .bigImg").height();$(".picZoomer-pic-wp").css({width:$("#disp_"+id+" .picZoomer").width(),height:$("#disp_"+id+" .picZoomer").height()});$(".picZoomer-zoom-pic").css({width:w*3,height:h*3})}else{$("#disp_"+id+" .bigImg").attr("src",$(this).find("img").attr("src"))}}})})};webUtil.setDisProSlideNew=function(id,dom,temp,autoPage,effect){require(["jquery","SuperSlide"],function($){$("#"+id+" .picShow").slide(_defineProperty({titCell:".hdd ul",mainCell:".bdd ul",autoPage:autoPage,effect:effect,autoPlay:false,scroll:1,vis:temp,delayTime:500,pnLoop:false,easing:"easeOutCirc",trigger:"click"},"autoPage",true));$("#disp_"+id+" .descShow").slide({delayTime:0});$("#disp_"+id+" .imgList li a").mouseenter(function(e){var $dom=$(e.currentTarget);var $el=$("#disp_"+id+" .bigImgShow p");if($dom.attr("data-type")==2){$("#disp_"+id+" .jqzoom").hide();$el.addClass("edui-upload-video");$el.css({"background-image":"url("+$el.attr("middtbnurl")+")"});$("#disp_"+id+" .bigImgShow p#isVideoEl").show()}else{$("#disp_"+id+" .jqzoom").show();$el.removeClass("edui-upload-video");$el.css({"background-image":""});$("#disp_"+id+" .bigImgShow p#isVideoEl").hide();$(".jqzoom").attr("src",$(this).find("img").attr("src"));$(".jqzoom").attr("rel",$(this).find("img").attr("src"))}})})};webUtil.setNewsDate=function(id,articleStyle){$("#article_list_"+id+" .title").css({width:"100%"});if(articleStyle=="default6"){$("#article_list_"+id+" .list").css({"padding-left":"0"})}else if(articleStyle=="default2"||articleStyle=="default3"||articleStyle=="default7"){$("#article_list_"+id+" .title").css({"padding-right":"0"});$("#article_list_"+id+" .title").css({width:"auto"})}};webUtil.getFmidRequest=function(addedStr,langId,callback){$.ajax({url:window.formUrl+"p/formplatform/listFormByLangIdAndMemberId.do"+addedStr,type:"POST",dataType:"json",data:{lid:langId},crossDomain:true,xhrFields:{withCredentials:true},success:function success(json){if(json.result==="SUCCESS"){callback(json.data)}else{return false}}})};webUtil.getFmidByLangId=function(successCallback,errorCallback){var langId=dataUtil.currentLangId();if(WebModel=="edit"){require(["kenfor/global"],function(glo){var memberId=glo.getMemberId(),memberIdStr="?mid="+memberId;webUtil.getFmidRequest(memberIdStr,langId,function(data){if(data&&data.length>0){successCallback(data[0].fmid)}else{if(errorCallback&&typeof errorCallback=="function"){errorCallback()}}})})}else{var midStr="?mid="+memberId_center.mid;webUtil.getFmidRequest(midStr,langId,function(data){if(data&&data.length>0){successCallback(data[0].fmid)}else{if(errorCallback&&typeof errorCallback=="function"){errorCallback()}}})}};webUtil.getLangObj=function(lid){var tempLangObjArr=[{content:"留言内容",symbol:"：",codeName:"验证码",subName:"提交",blog:"博客",reArticles:"相关文章",reProducts:"相关商品",noData:"暂无数据",read:"阅读",subSuccess:"提交成功",backward:"返回"},{content:"留言内容",symbol:"：",codeName:"验证码",subName:"提交",blog:"博客",reArticles:"相关文章",reProducts:"相关商品",noData:"暂无数据",read:"阅读",subSuccess:"提交成功",backward:"返回"},{content:"留言内容",symbol:"：",codeName:"驗證碼",subName:"提交",blog:"博客",reArticles:"相關文章",reProducts:"相關商品",noData:"暫無數據",read:"閱讀",subSuccess:"提交成功",backward:"返回"},{content:"Message",symbol:": ",codeName:"Verification code",subName:"Submit",blog:"Blog",reArticles:"Related Articles",reProducts:"Related Products",noData:"No Data",read:"views",subSuccess:"Submit succeed",backward:"Back"},{content:"메모 내용",symbol:": ",codeName:"인증 코드",subName:"제출하려면",blog:"블로그",reArticles:"관련 기사",reProducts:"관련 제품",noData:"데이터가 없습니다.",read:"독서",subSuccess:"제출 완료",backward:"귀국"},{content:"伝言の内容",symbol:"：",codeName:"確認コード",subName:"提出する",blog:"ブログ",reArticles:"関連記事",reProducts:"関連商品",noData:"まだデータがありません",read:"読み物",subSuccess:"送信しました",backward:"戻る"},{content:"содержание сообщения",symbol:"：",codeName:"Код подтверждения",subName:"представить",blog:"Блог",reArticles:"Статьи по теме",reProducts:"Сопутствующие товары",noData:"Данных пока нет",read:"считывание",subSuccess:"Отправлено успешно",backward:"возвращение"},{content:"Message",symbol:": ",codeName:"Code de vérification",subName:"Pour soumettre",blog:"Blog",reArticles:"Articles connexes",reProducts:"Produits connexes",noData:"Pas encore de données",read:"La lecture",subSuccess:"Soumis avec succès",backward:"Retour"},{content:"O conteúdo Da Mensagem",symbol:": ",codeName:"Código de verificação",subName:"Para Enviar",blog:"Blog",reArticles:"Artigos relacionados",reProducts:"Produtos relacionados",noData:"Nenhum dado ainda",read:"Leitura",subSuccess:"Enviado com sucesso",backward:"Retorno"},{content:"Contenido del mensaje",symbol:": ",codeName:"Código de verificación",subName:"Para Enviar",blog:"Blog",reArticles:"Artículos relacionados",reProducts:"Productos relacionados",noData:"Aún no hay datos",read:"La lectura",subSuccess:"Enviado con éxito",backward:"Volver"},{content:"Messaggio",symbol:": ",codeName:"Codice di verifica",subName:"Presentazione della descrizione",blog:"blog",reArticles:"Articoli correlati",reProducts:"Prodotti correlati",noData:"Nessun dato ancora",read:"leggere",subSuccess:"Inviato correttamente",backward:"ritorno"},{content:"Einreichen",symbol:": ",codeName:"Prüfcode",subName:"Einreichen",blog:"Blog",reArticles:"Verwandte Artikel",reProducts:"Verwandte Produkte",noData:"Noch keine Daten",read:"Lesen",subSuccess:"Erfolgreich übermittelt",backward:"Rückkehr"},{content:"Thông",symbol:": ",codeName:"Mã xác minh",subName:"Để gửi",blog:"Blog",reArticles:"Bài viết liên quan",reProducts:"Sản phẩm liên quan",noData:"Chưa có dữ liệu",read:"Đọc sách",subSuccess:"Gửi thành công",backward:"Trở về"},{content:"محتوى الرسالة",symbol:": ",codeName:"رمز التحقق",subName:"لإرسال",blog:"بلوق",reArticles:"مقالات ذات صلة",reProducts:"المنتجات ذات الصلة",noData:"لا توجد بيانات حتى الآن",read:"قرأ",subSuccess:"تم الإرسال بنجاح",backward:"عودة"},{content:"समीक्षा",symbol:": ",codeName:"सत्यापन कोड",subName:"जमा करें",blog:"ब्लॉग",reArticles:"संबंधित लेख",reProducts:"संबंधित उत्पाद",noData:"अभी तक कोई डेटा नहीं",read:"पढ़ना",subSuccess:"सफलतापूर्वक प्रस्तुत किया गया",backward:"वापसी"},{content:"Gösteri",symbol:": ",codeName:"Doğrulama kodu",subName:"Sunmak",Blog:"博客",reArticles:"İlgili makaleler",reProducts:"İlgili ürünler",noData:"Henüz veri yok",read:"okumak",subSuccess:"Başarıyla gönderildi",backward:"dönüş"},{content:"Mesej",symbol:": ",codeName:"Kod pengesahan",subName:"Hantar",Blog:"博客",reArticles:"Artikel yang berkaitan",reProducts:"Produk berkaitan",noData:"Belum ada data",read:"Membaca",subSuccess:"Dihantar dengan jayanya",backward:"Kembali"}],tempLid=Number(lid),tempLangObj="";tempLangObj=tempLangObjArr[tempLid];return tempLangObj};webUtil.renderMsgSubmit=function(mdId,fmid){if(!fmid){return false}require(["public/langUtil","msgSubmit"],function(){if(WebModel=="edit"){getFormProp()}else{getFormProp({mid:memberId_center.mid})}function getFormProp(addedObj){$("#"+mdId+" .submit-tips").hide();var msg="";var postData=Object.assign({fmid:fmid},addedObj);var frontUrl=WebModel==="edit"?window.webUrl:"";$.ajax({url:"/w/smartForm/infoSmartFormPropertyConfig.do",type:"POST",dataType:"json",data:postData,success:function success(json){if(json.result==="SUCCESS"){msg=json.data;if(Object.prototype.toString.call(msg)=="[object Object]"){createForm(msg,langUtil.onlineForm_content,langUtil.Global_verification);$("#form_submit"+mdId).find(".submit-tips").hide()}else{$("#form_submit"+mdId).html("数据加载错误")}}else{$("#form_submit"+mdId).html("数据加载错误")}}})}function createForm(data){require(["laydate/laydate"],function(){var str="",formJsonData="";if(data.jsondata){formJsonData=JSON.parse(data.jsondata)}var isNeedReCode=!formJsonData||formJsonData&&(formJsonData["CAPTCHAOpen"]==true||formJsonData.baseData&&formJsonData.baseData["CAPTCHAOpen"]==true)?true:false,html="";var $container=$("#form_submit"+mdId);var nums=1;var msgName=data.fmn;var lid=data.lid;if(formJsonData){if(formJsonData["tipLangID"]!=undefined){lid=formJsonData["tipLangID"]}if(formJsonData.baseData&&formJsonData.baseData["tipLangID"]!=undefined){lid=formJsonData.baseData["tipLangID"]}}var tempLangObj=dataUtil.getLangObj(lid),tempSymbol=tempLangObj["symbol"]||"：",tempCodeName=tempLangObj["codeName"]||"验证码",tempSubName=tempLangObj["subName"]||"提交";$container.attr("data-name",msgName);if(formJsonData){if(formJsonData.subBtnText){tempSubName=formJsonData.subBtnText}else{if(formJsonData.subBtnData&&formJsonData.subBtnData.subBtnText){tempSubName=formJsonData.subBtnData.subBtnText}}}$.map(data.propcfList,function(item,key){if(item.propsts){var fisrq="",finptp=item.inptp,propn=item.propn,col="",itemDescHtml="",itemJsonData="",defaultProv="",defaultProvVal="",defaultCity="",defaultCityVal="",defaultDist="",defaultDistVal="",siteDistHtml="",siteDetailHtml="",tempPlaceholder="";if(item.isrq==1){fisrq="form_isrq"}if(item.jsondata){itemJsonData=JSON.parse(item.jsondata);if(itemJsonData.componentDesc){itemDescHtml="<div class='clear'></div><div class='itemDescText'>"+itemJsonData.componentDesc+"</div>"}}switch(item.inptp){case"input":case"phone":case"mail":case"identity":case"phonenum":if(item.propvList.length>0&&item.propvList[0].propv){tempPlaceholder=item.propvList[0].propv}else{tempPlaceholder=propn}html+='<ul class="list input">'+"<span>"+item.propn+tempSymbol+"</span>"+"<li>"+'<input class="'+fisrq+' saveinput" type="text" name="'+mdId+"_"+item.fmpropcfgid+'" data-ftip="'+propn+'" data-itype="'+finptp+'" placeholder="'+tempPlaceholder+'">'+(item.isrq?'<i class="msgSubSign">*</i>':"")+itemDescHtml+"</li>"+"</ul>";break;case"textarea":if(item.propvList.length>0&&item.propvList[0].propv){tempPlaceholder=item.propvList[0].propv}else{tempPlaceholder=propn}html+='<ul class="list textarea">'+"<span>"+item.propn+tempSymbol+"</span>"+"<li>"+'<textarea class="'+fisrq+' saveinput" name="'+mdId+"_"+item.fmpropcfgid+'" data-ftip="'+propn+'" data-itype="'+finptp+'" placeholder="'+tempPlaceholder+'" rows="4"></textarea>'+(item.isrq?'<i class="msgSubSign">*</i>':"")+itemDescHtml+"</li>"+"</ul>";break;case"radio":html+="<ul class='list radio saveinput "+fisrq+"' id='"+mdId+"_"+item.fmpropcfgid+"' data-ftip='"+propn+"'  data-itype='"+finptp+"'>"+"<span>"+item.propn+langUtil.Global_symbol+"</span>"+"<li>"+'<span class="showPropn">'+item.propn+langUtil.Global_symbol+"</span>";$.map(item.propvList,function(value,key){var index=key+1,checkedStr=value.isdef==1?"checked":"";html+="<label class='option-wrap'>"+"<input name='"+mdId+"_"+item.fmpropcfgid+"' type='radio' value='"+value.propv+"' "+checkedStr+"/>"+value.propv+"</label>"});html+=(item.isrq?'<i class="msgSubSign">*</i>':"")+itemDescHtml+"</li>"+"</ul>";break;case"checkbox":html+="<ul class='list checkbox saveinput "+fisrq+"' id='"+mdId+"_"+item.fmpropcfgid+"' data-ftip='"+propn+"'  data-itype='"+finptp+"'>"+"<span>"+item.propn+langUtil.Global_symbol+"</span>"+"<li>"+'<span class="showPropn">'+item.propn+langUtil.Global_symbol+"</span>";$.map(item.propvList,function(value,key){var index=key+1,checkedStr=value.isdef==1?"checked":"";html+="<label class='option-wrap'>"+"<input name='"+mdId+"_"+item.fmpropcfgid+"' type='checkbox' value='"+value.propv+"' "+checkedStr+"/>"+value.propv+"</label>"});html+=(item.isrq?'<i class="msgSubSign">*</i>':"")+itemDescHtml+"</li>"+"</ul>";break;case"select":html+="<ul class='list select saveinput "+fisrq+"' name='"+mdId+"_"+item.fmpropcfgid+"' data-ftip='"+propn+"'  data-itype='"+finptp+"'>"+"<span>"+item.propn+tempSymbol+"</span>"+"<li>"+'<span class="showPropn">'+item.propn+langUtil.Global_symbol+"</span>"+"<select class='input-style "+fisrq+"' data-ftip='"+propn+"'  data-itype='"+finptp+"' name='"+mdId+"_"+item.fmpropcfgid+"'>";$.map(item.propvList,function(value,key){if(value.isdef==1){html+="<option selected>"+value.propv+"</option>"}else{html+="<option>"+value.propv+"</option>"}});html+="</select>"+(item.isrq?'<i class="msgSubSign">*</i>':"")+itemDescHtml+"</li>"+"</ul>";break;case"date":html+='<ul class="list input">'+"<span>"+item.propn+tempSymbol+"</span>"+"<li>"+"<input onclick='laydate()' class='input-style saveinput "+fisrq+"' data-ftip='"+propn+"'  data-itype='"+finptp+"' id='"+mdId+"_"+item.fmpropcfgid+"' name='"+mdId+"_"+item.fmpropcfgid+"' type='text' placeholder='2016-12-27'/>"+(item.isrq?'<i class="msgSubSign">*</i>':"")+itemDescHtml+"</li>"+"</ul>";break;case"text":html+='<ul class="list input">'+"<span>"+item.propn+langUtil.Global_symbol+"</span>"+"<li>"+'<span class="showPropn">'+item.propn+langUtil.Global_symbol+"</span>"+"<div class='form-input-text inlineBlock'>"+item.propvList[0].propv+"</div>"+itemDescHtml+"</li>"+"</ul>";break;case"site":if(itemJsonData){if(itemJsonData.siteDefaultList.prov){defaultProv=defaultProvVal=itemJsonData.siteDefaultList.prov}else{defaultProv="请选择省"}if(itemJsonData.siteDefaultList.city){defaultCity=defaultCityVal=itemJsonData.siteDefaultList.city}else{defaultCity="请选择市"}if(itemJsonData.siteDefaultList.dist){defaultDist=defaultDistVal=itemJsonData.siteDefaultList.dist}else{defaultDist="请选择县区"}if(itemJsonData.showSiteDetail){siteDetailHtml="<textarea class='siteDetailCon regional-siteDetail' rows='4' placeholder='详细地址'></textarea>"}}html+="<ul  id='regional-"+mdId+"_"+item.fmpropcfgid+"'  data-ftip='"+propn+"'  data-itype='"+finptp+"'  class='provAndCity site list saveinput clearfix "+fisrq+"'>"+"<span>"+item.propn+langUtil.Global_symbol+"</span>"+"<li>"+'<span class="showPropn">'+item.propn+langUtil.Global_symbol+"</span>"+"<div  class='onlineSelect inlineBlock'>"+"<select  class='input-style regional-province'>"+"<option value='"+defaultProvVal+"'>"+defaultProv+"</option>"+"</select>"+"</div>"+"<div  class='onlineSelect inlineBlock'>"+"<select  class='input-style regional-city'>"+"<option value='"+defaultCityVal+"'>"+defaultCity+"</option>"+"</select>"+"</div>"+"<div  class='onlineSelect inlineBlock'>"+"<select  class='input-style regional-district'>"+"<option value='"+defaultDistVal+"'>"+defaultDist+"</option>"+"</select>"+"</div>"+siteDetailHtml+(item.isrq?'<i class="msgSubSign">*</i>':"")+itemDescHtml+"</li>"+"</ul>";break}}nums++});if(data.tp=="leaveMsg"){var initMsgObj={inptp:"textarea",isrq:1,propsts:1,propn:tempLangObj["content"],props:"",value:"",propv:"",isdef:"",isEdit:true,jsondata:{componentType:"留言内容",componentDesc:"",componentId:"msgTextarea",msgTextarea:true,hasToBeRequired:true}},formJsonData=data.jsondata?JSON.parse(data.jsondata):"",listOuterSpecCompArr=formJsonData.listOuterSpecCompArr,formIsrqStr="",tempPlaceholder="";if(listOuterSpecCompArr&&formJsonData.listOuterSpecCompArr.length>0){$.extend(true,initMsgObj,listOuterSpecCompArr[0])}if(initMsgObj.propv){tempPlaceholder=initMsgObj.propv}else{tempPlaceholder=initMsgObj.propn}var componentDescHtml="";if(initMsgObj.jsondata.componentDesc){componentDescHtml="<div class='itemDescText'>"+initMsgObj.jsondata.componentDesc+"</div>"}html+='<ul class="list textarea">'+"<span>"+tempPlaceholder+tempSymbol+"</span>"+"<li>"+'<textarea class="form_isrq saveinput msgTextarea" name="content" data-ftip="'+tempPlaceholder+'" data-itype="textarea" placeholder="'+tempPlaceholder+'" rows="4"></textarea>'+'<i class="msgSubSign">*</i>'+"<div class='clear'></div>"+componentDescHtml+"</li>"+"</ul>"}if(isNeedReCode){var codeHtml="/img/genImgCode.do?specialCode="+mdId+"&x="+Date.now();html+='<ul class="list input code"><span>'+tempCodeName+tempSymbol+'</span><li><input class="form_isrq langInput msgVerText"  type="text" name="'+mdId+'_code" maxlength="4" placeholder='+tempCodeName+'><div style="display: inline-block;width: 100px;"><img class="SetReCode" src="'+codeHtml+'" onclick="webUtil.SetReCode(this,\''+mdId+'\')"><i class="msgSubSign">*</i></div></li></ul>'}html+='<p class="submit-tips text-danger" style="color:red"></p>';html+='<div class="botton"><a  onclick="submitForm(\''+mdId+"', '"+fmid+'\')" id="submitMsg_'+mdId+'">'+tempSubName+"</a></div>";$container.html(html);if($("#"+mdId+" .provAndCity").length>0){require(["linkage/city.min","linkage/jquery.linkage"],function(city){var sitePanel=$("#"+mdId+" .provAndCity"),siteDefaultProv=sitePanel.find(".regional-province").val(),siteDefaultCity=sitePanel.find(".regional-city").val(),siteDefaultDist=sitePanel.find(".regional-district").val();sitePanel.citySelect({url:eval("("+city+")"),prov:siteDefaultProv,city:siteDefaultCity,dist:siteDefaultDist})})}if($("#"+mdId+" .file").length>0){require(["uploadfile"])}dataUtil.encodeSaveInput(mdId)})}})};webUtil.getFirstMsg=function(mdId){var langId=dataUtil.currentLangId(),typeList=["leaveMsg","msg"];typeList=JSON.stringify(typeList);dataUtil.listSpecificForms(typeList,function(res){if(res.data&&res.data.length>0){var firstMsgFmid=res.data[0].fmid;webUtil.renderMsgSubmit(mdId,firstMsgFmid)}else{dataUtil.createSpecificNewForm(langId,"msg",function(newFormID){webUtil.renderMsgSubmit(mdId,newFormID)})}})};webUtil.msgSubmit=function(mdId,fmid){if(!fmid){webUtil.getFmidByLangId(function(dataFmid){webUtil.renderMsgSubmit(mdId,dataFmid)},function(){webUtil.getFirstMsg(mdId)})}else{webUtil.renderMsgSubmit(mdId,fmid)}};webUtil.SetReCode=function(thiz,mdId){if(window.WebModel=="edit"){var imgurl=imgPath+"images/iyong/genImgCode.jpg"}else{var imgurl="/img/genImgCode.do?specialCode="+mdId+"&x="+Date.now()}$(thiz).attr("src",imgurl)};webUtil.resizeWidth=function(mdId,images){var boxWidth=$("#"+mdId).width();if($(".box_carousel").attr("data-dmodel")=="float"){$.each(images,function(i,item){var curImgWidth=$(this).find("img").width(),leftWidth=(boxWidth-curImgWidth)/2;$(this).find("img").css({position:"absolute",left:leftWidth});if($(this).find(".txt_hide").length>0){$(this).find(".txt_hide").css({"margin-left":0,left:leftWidth})}})}else{$(".box_carousel").find("ul").find("img").css({position:"",left:""})}};webUtil.textCenter=function(images){$.each(images,function(i,item){$(this).find("img").load(function(){var curImgWidth=this.width;if(curImgWidth>1200){curImgWidth=1200}console.log(curImgWidth);var halfImgWidth=-curImgWidth/2;$(this).parent("a").next().css({width:curImgWidth,"margin-left":halfImgWidth,left:"50%"})})})};webUtil.superSlideArg=function(mdId,status,time,speed,skin_s,imgList){if(imgList){status=window.WebModel=="edit"?false:status;require(["SuperSlide"],function(){var $sList=$(".slideBox_"+mdId).find(".tempWrap");if($sList.length>0){$sList.find("ul").removeAttr("style");$sList.find("li").removeAttr("style");$(".slideBox_"+mdId+" > .bd").html($sList.html())}var $parentBox=$("#carousel_"+mdId);$(".slideBox_"+mdId).find(".bd ul").attr("data-listw",$parentBox.attr("data-bwidth"));$(".slideBox_"+mdId).slide({mainCell:".bd ul",titCell:".hd ul",autoPage:true,prevCell:".hleft",nextCell:".hright",autoPlay:status,easing:"swing",effect:"left",interTime:time,delayTime:speed});$("#"+mdId).find(".carousel").find(".bd").find("ul").height("100%")})}};webUtil.carousel=function(mdId,itemChecked){require(["fancyJs"],function(){if(itemChecked=="0"){$(".fancybox_"+mdId).fancybox({helpers:{overlay:{closeClick:false}},afterLoad:function afterLoad(){this.title="Image "+(this.index+1)+" of "+this.group.length+(this.title?" - "+this.title:"")}})}if(itemChecked=="1"){require(["fancybox/jquery.fancybox-thumbs"],function(){$(".fancybox-thumbs_"+mdId).fancybox({prevEffect:"none",nextEffect:"none",closeBtn:true,arrows:true,nextClick:true,helpers:{thumbs:{width:50,height:50},overlay:{closeClick:false}}})})}})};webUtil.loadSlideVideo=function(argObj){var isTypeSensible=function isTypeSensible(target){var type=Object.prototype.toString.call(target);return type!=="[object Undefined]"&&type!=="[object Null]"};var curDom=argObj.curDom,callback=argObj.callback,videoSrc=curDom.attr("data-src"),type=curDom.attr("data-type"),poster=curDom.attr("data-poster")||"",getLoop=curDom.attr("data-loop"),loop=isTypeSensible(getLoop)?getLoop:true,loopBool=loop===true||loop==="true"?true:false,loopStr=loopBool?"loop":"",getEditShowFakeVideoCon=argObj.editShowFakeVideoCon,editShowFakeVideoCon=isTypeSensible(getEditShowFakeVideoCon)?getEditShowFakeVideoCon:false;if(WebModel==="edit"){if(editShowFakeVideoCon){if(curDom.find(".onlineVideoBox").length>0){return false}else{var fakeVideoHtml='<div class="onlineVideoBox" style="height:100%;">                        <div class="fakeVideoContainer" style="background-image:url('+poster+');background-size:100% 100%;">                            <div class="fakeVideoPlayBtn">                                <i class="icon iconfont kenfor-icons-play1"></i>                            </div>                        </div>                    </div>';curDom.after(fakeVideoHtml)}}}else{curDom.siblings().remove();if(type==="mp4"){var videoHtml='<video src="'+videoSrc+'" width="100%" '+loopStr+'>                        <source src="'+videoSrc+'" type="video/mp4"/>                        <source src="'+videoSrc+'" type="video/ogg"/>                        <source src="'+videoSrc+'" type="video/webm"/>                    </video>';curDom.after(videoHtml);if(callback){callback()}}else if(type==="torrent"){require(["./webtorrent.min"],function(WebTorrent){var curParentElem=curDom.parent()[0];var client=new WebTorrent;client.add(videoSrc,function(torrent){torrent.files.forEach(function(file){if(file.name.endsWith(".mp4")){file.appendTo(curParentElem)}});curDom.next("video").prop({width:"100%",poster:poster,loop:loopBool,controls:false}).attr({width:"100%",poster:poster,loop:loopBool,controls:false});if(callback){callback()}})})}}};webUtil.onlySlideVideo=function(mdId){if($("#"+mdId).find(".slideVideo").length===1){var onlySlideVideoDom=$("#"+mdId).find(".slideVideo");webUtil.loadSlideVideo({curDom:onlySlideVideoDom,callback:function callback(){var videoDom=onlySlideVideoDom.next("video");if(webUtil.checkBrowser()==="chrome"){videoDom.prop("muted",true).attr("muted",true)}videoDom[0].play()}})}};webUtil.bannerArg=function(mdId,status,time,speed,isVideoFirst){status=window.WebModel=="edit"?false:status;$(".slideBox_"+mdId).find(".bd").children().remove();var unseenLiDom=$("#banners_"+mdId).find("li");if(unseenLiDom.length<2){status=false}unseenLiDom.css({height:$("#"+mdId).height()});var banner_slide_width=$("#web_design_main").width();$("#banners_"+mdId).find("li").width(banner_slide_width);$(".slideBox_"+mdId).find(".tempWrap").width(banner_slide_width);$(".slideBox_"+mdId).find(".bd").html($("#banners_"+mdId).html());var slideLiDom=$("#slideBox_"+mdId).find(".bd ul li");var isStillFirst=true;if($(".slideBox_"+mdId).find(".playState").length===0){$(".slideBox_"+mdId).prepend('<button class="playState" style="display:none;" >改变自动切换</button>')}var playStateDom=$(".slideBox_"+mdId).find(".playState");if($(".slideBox_"+mdId).find(".hright").length===0){$(".slideBox_"+mdId).prepend('<button class="hright" style="display:none;" ></button>')}$(".slideBox_"+mdId).slide({mainCell:".bd ul",titCell:".hd ul",prevCell:".hleft",nextCell:".hright",autoPage:true,easing:"swing",autoPlay:status,effect:"leftLoop",interTime:time,delayTime:speed,startFun:function startFun(i,c){var curLiDom=slideLiDom.eq(i),siblingsLiDom=slideLiDom.siblings();siblingsLiDom.find("video").remove();if((isVideoFirst===true||isVideoFirst==="true")&&isStillFirst){var firstSlideVideoDom=slideLiDom.find(".slideVideo").eq(0),firstSlideVideoLiDom=firstSlideVideoDom.closest("li");webUtil.loadSlideVideo({curDom:firstSlideVideoLiDom.find(".slideVideo"),callback:function callback(){playStateDom.trigger("click");isStillFirst=false}})}else{if(curLiDom.find(".slideVideo").length>0){webUtil.loadSlideVideo({curDom:curLiDom.find(".slideVideo")})}}},endFun:function endFun(i,c){if(WebModel==="view"){var curLiDom=slideLiDom.eq(i);if(curLiDom.find("video").length>0){var videoDom=curLiDom.find("video");if(webUtil.checkBrowser()==="chrome"){videoDom.prop("muted",true).attr("muted",true)}videoDom[0].play();playStateDom.trigger("click");videoDom[0].addEventListener("ended",function(){playStateDom.trigger("click");$(".slideBox_"+mdId).find(".hright").trigger("click")})}}}});$("body").data("bodyw",$(window).width());$(window).resize(function(event){var body_w=$("body").data("bodyw");if(body_w!=$(window).width()){webUtil.bannerArg(mdId,status,time,speed)}});if(WebModel=="edit"){$("#"+mdId).on("resizestop",function(event,ui){webUtil.bannerArg(mdId,status,time,speed)})}};webUtil.imgTextFunc=function(mdId,tempStyle,padding){padding=padding.replace("px","");if(tempStyle=="left"||tempStyle=="right"){var c=$(".imageText_img_div_"+mdId).width();var cc=parseInt(c)+parseInt(padding)+"px";$(".imageText_text_"+mdId).css({width:"calc(100% - "+cc+")"})}};webUtil.imgTextFunc2=function(mdId){$("#"+mdId+" .imgText_hover").find(".hover_pic").removeAttr("style");$("#"+mdId+" .imgText_hover").hover(function(){$(this).find(".hover_pic").stop(true,true).fadeIn(500)},function(){$(this).find(".hover_pic").stop(true,true).fadeOut(500)})};webUtil.rollingFunc=function(mdId,speed,direction,time,r_tpl){var r_speed=null;if(speed=="auto"){r_speed=65}else if(speed=="slow"){r_speed=100}else{r_speed=30}$("#"+r_tpl+"_"+mdId).find(".list").kxbdSuperMarquee({isEqual:false,duration:r_speed,distance:30,time:time,direction:direction})};webUtil.picFunc2=function(mdId,p_tpl,isSrc1,src,iconClass,box_w,box_h,l_bd){if(WebModel=="edit"){webUtil.picFunc1(mdId,p_tpl,box_w,box_h,l_bd)}if(isSrc1!="0"){if(src!=""){$("#"+p_tpl+"_"+mdId).hover(function(){$(this).find(".hoverImg").stop().fadeIn(300)},function(){$(this).find(".hoverImg").stop().fadeOut(300)})}else if(iconClass!=""){$("#"+p_tpl+"_"+mdId).hover(function(){$(this).find(".hoverI").stop().prev().fadeOut(300);$(this).find(".hoverI").stop().fadeIn(300)},function(){$(this).find(".hoverI").stop().prev().fadeIn(300);$(this).find(".hoverI").stop().fadeOut(300)})}}if($("#"+mdId+" img.lazy").length>0){webUtil.lazyloadList("#"+mdId+" img.lazy")}};webUtil.onlineMapLoad=function(mdId,mapPointLng,mapPointLat,mapInfo,width,height){require(["jquery","async!BMap"],function($){var $mapDom=$("#baiduMap_"+mdId);if($mapDom.length>0){if(width){if(width.indexOf("%")<0){width=width+"px"}$mapDom.css({width:width,height:height})}var map=new BMap.Map("baiduMap_"+mdId);if(mapPointLng==""){var point=new BMap.Point(113.410312,22.507476)}else{var point=new BMap.Point(mapPointLng,mapPointLat)}map.centerAndZoom(point,17);var newMaker=new BMap.Marker(point);map.addOverlay(newMaker);var pointSize={width:280};if(mapInfo){var infoWindow=new BMap.InfoWindow(mapInfo,pointSize);newMaker.openInfoWindow(infoWindow)}newMaker.addEventListener("click",function(){var infoWindow=new BMap.InfoWindow(mapInfo,pointSize);newMaker.openInfoWindow(infoWindow)});var bMapNavigation=new BMap.NavigationControl;map.addControl(bMapNavigation);var bMapScale=new BMap.ScaleControl;map.addControl(bMapScale)}if(WebModel=="edit"&&width){webUtil.onlineMapDrag(mdId)}})};webUtil.setQrCode=function(mdId,qrCode_w){if(WebModel){require(["jquery"],function(){$("#"+mdId).css({width:qrCode_w});$("#qrcode_"+mdId).css({width:qrCode_w})})}};webUtil.showTip=function(tip,time){var t=time?time:1;var fileHtml='<div id="webupload_tip"><div class="webupload_body"><font class="wl_tip"></font><span class="tclose close_tip"></span></div></div>';if($("#webupload_tip").length==0){$("body").append(fileHtml);$("#webupload_tip").fadeIn(500)}var $dom=$("#webupload_tip");$dom.find(".wl_tip").html(tip);setTimeout(function(){$dom.fadeOut(500).remove()},t*1e3);$(".close_tip").click(function(){$dom.fadeOut(500).remove()})};webUtil.getBackPsw=function(dom,mdId){appUtil.checked_to_where("forgetpass")};webUtil.checkPswStrong=function(thiz,dom){var pswIpt=$(thiz).val(),spans=$("#"+dom).find("span");if(pswIpt.length>=6&&pswIpt.length<=20){var regArr=[/[a-z]/g,/[0-9]/g,/[A-Z]/g,/[`~!@#\$%\^\&\*\(\)_\+<>\?:"\{\},\.\\\/;'\[\]]/g],sec=0;for(var i=0;i<regArr.length;i++){if(pswIpt.match(regArr[i])){sec++}}$(spans).css({background:"#f3d1b8",color:"#555"});if(sec==1){$(spans).eq(0).css({background:"#c8252a",color:"#fff"})}else if(sec==2){$(spans).eq(1).css({background:"#c8252a",color:"#fff"})}else if(sec==3){$(spans).eq(2).css({background:"#c8252a",color:"#fff"})}else{}}};webUtil.lg_keyUp=function(event,thiz,dom){event=document.all?window.event:event;if((event.keyCode||event.which)==8&&$(thiz).val().trim()==""){$("#"+dom).find("span").css({background:"#f9cfb2",color:"#555"})}};webUtil.regCheck=function(mdId){require(["../kenfor/kenforJsUtil","public/langUtil"],function(checkUtil){if($("body").hasClass("edit")){webUtil.showTip(langUtil.showTip,2)}else{formItemList=$("#regForm_"+mdId).find(".regForm_item"),info={};var flag=true;$.each(formItemList,function(k,i){var itemType=$(i).attr("data-inptp"),itemName=$(i).attr("data-propn"),itemIsrq=$(i).attr("data-isrq"),isItemHasName=$(i).attr("name"),itemVal=$(i).val().trim();if(itemIsrq=="1"){if(!checkUtil.isEmpty(itemVal)){webUtil.showTip(itemName+langUtil.noEmpty,1.5);flag=false;return false}switch(itemType){case"phone":if(!checkUtil.isPhone(itemVal)){webUtil.showTip(itemName+langUtil.formatError,1.5);flag=false;return false}info["cstacc"]=itemVal;info["regTp"]="2";break;case"psw":if(!checkUtil.isLength(itemVal,6,20)){webUtil.showTip(itemName+langUtil.formatLenError,1.5);flag=false;return false}else if(checkUtil.isSpace(itemVal)){webUtil.showTip(itemName+langUtil.noSpace,1.5);flag=false;return false}info["cstpsw"]=itemVal;break;case"checkPsw":var Psw=$("#reg_setPsw_"+mdId).val();if(itemVal!=Psw){webUtil.showTip(langUtil.twoPsw,1.5);flag=false;return false}break;case"text":break;case"select":break;default:}}if(isItemHasName){info[isItemHasName]=itemVal}});if(flag){var info={};var mcParams={};info["sessionId"]=sessionStorage.getItem("newtime");info["phone"]=$("#reg_phoneNum_"+mdId).val().trim();info["password"]=$("#reg_setPsw_"+mdId).val().trim();info["vCode"]=$("#reg_smsCode_"+mdId).val().trim();info["syscode"]="hy";info["mid"]=memberId_center.mid;info["lid"]=memberId_center.lid;info["wsid"]=memberId_center.wsid;var params=info;mcParams.apicode="consumerRegister";mcParams.syscode="membership";mcParams.params=JSON.stringify(params);mcParams.mid=memberId_center.mid;$.ajax({url:"/w/thirdSys/commonThirdRpc.do",xhrFields:{withCredentials:true},crossDomain:true,type:"POST",data:mcParams,success:function success(data){console.log(data);if(data.result=="SUCCESS"){var successTips='<div class="reg_body_mask"><div class="reg_mask"></div><div class="reg_sTips"><p>'+langUtil.regSuccess+'</p><p><a href="javascript:void(0)" class="autoLg">'+langUtil.Global_btn+'</a><a href="index.html">'+langUtil.backToHome+"</a></p></div></div>";$("body").append(successTips);$(".reg_body_mask a").click(function(){if($(this).hasClass("autoLg")){webUtil.lg_submit("reg_phoneNum_"+mdId,"reg_comfirmPsw_"+mdId)}$("body").remove($(".reg_body_mask"))})}else{console.log(data.errorMsg.msg)}}})}}})};webUtil.getRegFormItem=function(mdId,AgreementContent){var AgreementContent={};require(["public/langUtil"],function(){var str="<ul>";str+="<li>"+'<label for="reg_phoneNum_'+mdId+'">'+langUtil.phoneNum+langUtil.Global_symbol+"</label>"+'<input type="text" id="reg_phoneNum_'+mdId+'" class="regForm_item" data-isrq="1" data-inptp="phone" data-propn="'+langUtil.phoneNum+'"/>'+"<span>*</span>"+"</li>"+"<li>"+'<label for="reg_smsCode_'+mdId+'">'+langUtil.Global_verification+langUtil.Global_symbol+"</label>"+'<input type="text" id="reg_smsCode_'+mdId+'" class="regForm_item" name="code" data-isrq="1" data-inptp="text" data-propn="'+langUtil.Global_verification+'" autocomplete="off" style="width: 131px;"/>'+'<span class="getFreeCode" id="getFreeCode_'+mdId+'" onclick="dataUtil.sendSmsCode(\'#reg_phoneNum_'+mdId+"','#getFreeCode_"+mdId+"')\">"+langUtil.getFreeCode+"</span>"+"<span>*</span>"+"</li>"+"<li>"+'<label for="reg_setPsw_'+mdId+'">'+langUtil.setPsw+langUtil.Global_symbol+"</label>"+'<input type="password" id="reg_setPsw_'+mdId+'" class="regForm_item" data-isrq="1" data-inptp="psw" data-propn="'+langUtil.setPsw+'" autocomplete="off"/>'+"<span>*</span>"+'<p id="reg_tips_'+mdId+'" class="reg_tips">'+langUtil.regTips+"</p>"+"</li>"+"<li>"+'<label for="reg_comfirmPsw_'+mdId+'">'+langUtil.Global_confirmPwd+langUtil.Global_symbol+"</label>"+'<input type="password" id="reg_comfirmPsw_'+mdId+'" class="regForm_item" data-isrq="1" data-inptp="checkPsw" data-propn="'+langUtil.Global_confirmPwd+'" autocomplete="off"/>'+"<span>*</span>"+"</li>";$.ajax({type:"GET",url:"/w/cst/infoRegister.do",dataType:"json",success:function success(data){var formItem=data.data.propcfList;$.each(formItem,function(k,i){var selectItem=i.propvList;if(i.rgsdp==1){str+="<li><label>";str+=i.propn;str+="：</label>";if(i.inptp=="text"){str+='<input type="text" class="regForm_item" name="'+i.cstpropcfgid+'" data-inptp="'+i.inptp+'" data-isrq="'+i.isrq+'" data-propn="'+i.propn+'">'}else if(i.inptp=="select"){str+='<select class="regForm_item" name="'+i.cstpropcfgid+'" data-inptp="'+i.inptp+'" data-isrq="'+i.isrq+'" data-propn="'+i.propn+'" >';$.each(selectItem,function(key,item){if(item.isdef==1){str+='<option selected value ="'+item.propv+'" name="'+item.cstpropcfgid+'" data-name="'+item.cstpropvid+'" data-isdef="'+item.isdef+'">'}else{str+='<option value ="'+item.propv+'" name="'+item.cstpropcfgid+'" data-name="'+item.cstpropvid+'" data-isdef="'+item.isdef+'">'}str+=item.propv;str+="</option>"});str+="</select>"}else{}if(i.isrq==1){str+="<span>*</span>"}str+="</li>"}});if(AgreementContent.status=="1"){str+='<li class="protocoli"> <p><input type="checkbox" id="protocol_'+mdId+'" class="protocol" checked/>';str+=langUtil.re_protocol;str+='<font id="linkText_'+mdId+'">';str+=langUtil.re_protocolItem;str+="</font></p></li>"}str+="<li>"+'<a href="javascript:void(0)" onclick="webUtil.regCheck(\''+mdId+'\');" id="register_'+mdId+'" class="reg_btnBg">'+langUtil.register+"</a>"+"</li>";str+="</ul>";$("#regForm_"+mdId).html(str);$("#reg_setPsw_"+mdId).focus(function(){$(this).parent().find("p").show()}).blur(function(){$(this).parent().find("p").hide()});if(!$("body").hasClass("edit")){if(AgreementContent.status=="1"){$("#protocol_"+mdId).change(function(){if($(this).prop("checked")==true){$("#register_"+mdId).removeClass("disabled")}else{$("#register_"+mdId).addClass("disabled")}})}}$("#linkText_"+mdId).click(function(){webUtil.showProtocol(mdId,"web_design_main",AgreementContent)})},error:function error(data){console.log(data.errorMsg.msg)}})})};webUtil.showProtocol=function(mdId,dom,AgreementContent){if($("body").hasClass("edit")){webUtil.showTip(langUtil.showTip,2)}else{var html="";html+='<div id="Protocol">'+'<div class="dialogBg" style="display:block;"></div>'+'<div class="dailog">'+'<div class="dailogTop">'+AgreementContent.rgamtt+'<span class="agreeClose_btn">×</span>'+"</div>"+'<div class="dialogContent">'+AgreementContent.rgamctt+"</div>"+'<div class="btnDiv">'+'<span id="agree_'+mdId+'">同意</span>'+'<span class="agreeClose_btn">取消</span>'+"</div>"+"</div>"+"</div>";$("#"+dom).append(html);$(".agreeClose_btn").click(function(){$("#Protocol").remove()});$("#agree_"+mdId).click(function(){$("#Protocol").remove();$("#protocol_"+mdId).prop("checked",true);if($("#register_"+mdId).hasClass("disabled")){$("#register_"+mdId).removeClass("disabled")}})}};webUtil.getMemberInfor=function(){var userPic="";var defer=$.Deferred();$.ajax({type:"GET",url:"/w/customer/infoDisplayCustomer.do",success:function success(data){userPic=data.data.csthi;defer.resolve(userPic)}});return defer.promise()};webUtil.lg_submit=function(user,psw,urlType){var memberUrl;var zhonduan=window.platform;if(zhonduan=="iyongcs"){memberUrl="http://webmember-cs.kenfor.com/"}else if(zhonduan=="iyongfb"){memberUrl="https://webmember-fb.kenfor.com/"}else if(zhonduan=="iyong"){memberUrl="https://webmember.iyong.com/"}var data={};var mcParams={};data["accountOrPhone"]=$("#"+user).val().trim();data["password"]=$("#"+psw).val().trim();data["mid"]=memberId_center.mid;data["lid"]=memberId_center.lid;data["wsid"]=memberId_center.mid.wsid;var params=data;mcParams.apicode="loginAccOrPhonePass";mcParams.syscode="membership";mcParams.params=JSON.stringify(params);require(["../kenfor/kenforJsUtil","public/langUtil","jquery.cookie"],function(checkUtil){if($("body").hasClass("edit")){webUtil.showTip(langUtil.showTip,2)}else{var username=$("#"+user).val().trim(),password=$("#"+psw).val().trim();if(!checkUtil.isEmpty(username)){webUtil.showTip(langUtil.enterAccount,1.5);return false}else if(!checkUtil.isEmpty(password)){webUtil.showTip(langUtil.enterPsw,1.5);return false}else{$.ajax({url:memberUrl+"/w/thirdSys/commonThirdRpc.do",xhrFields:{withCredentials:true},crossDomain:true,type:"POST",data:mcParams,success:function success(data){console.log(data);if(data.result=="SUCCESS"){sessionStorage.setItem("mtoken",data.data.token);webUtil.showTip(langUtil.loginSucc,1);location.reload();var checkCookie=$("input[name=lg_checkUsername]").is(":checked");var doMain=document.domain;var mInfo=JSON.stringify({name:username,status:checkCookie,domain:doMain});$.cookie("memberInfo",mInfo,{expires:7})}else{var errorTips="";if(data.result=="LOGINERROR"||data.result=="PWDERROR"){errorTips=langUtil.account_psw_error}else if(data.result=="ACCOUNTNOTEXIST"){errorTips=langUtil.noAccount}else if(data.result=="ACCOUNTFROZEN"){errorTips=langUtil.freezeAccount}else if(data.result=="NOTACTIVE"){errorTips=langUtil.noMail}else if(data.result=="ACCOUNTNOTPERMISSION"){errorTips=langUtil.accountPermision}else{errorTips=langUtil.loginError}webUtil.showTip(errorTips,1.5)}}})}}})};webUtil.lg_autoSubmit=function(urlType){require(["jquery.cookie"],function(){if($.cookie("autoLgInfo")&&$.cookie("autoLgInfo")!="null"){var autoLgInfo=JSON.parse($.cookie("autoLgInfo"));$.ajax({type:"POST",url:"/w/cst/loginCst.do",data:{autologon:1,azdgAccount:autoLgInfo.autoName,azdgPassword:autoLgInfo.autoPsw},success:function success(data){if(data.result=="SUCCESS"){if(urlType!="0"){window.location.href=urlType}else if(data.data.config.lnfwtp=="1"){window.location.href=data.data.config.lnfw}else{window.location.href="member/index.html"}}}})}})};webUtil.delAutoLgInfo=function(pageurl){require(["jquery.cookie"],function(){if($.cookie("autoLgInfo")!="null"){$.cookie("autoLgInfo",null,{path:"/"})}if(!pageurl){pageurl="login.html"}window.location.href="/w/cst/logout.do?uri="+realpath+pageurl})};webUtil.getMemberInfo=function(){require(["jquery.cookie"],function(){var memberInfo=$.cookie("memberInfo");if(memberInfo){var memberInfo=JSON.parse(memberInfo);var doMain=document.domain;if(doMain==memberInfo.domain){if(memberInfo.status==true){$("input[name=lg_checkUsername]").attr("checked",true);$(".lg_username").val(memberInfo.name)}else{$("input[name=lg_checkUsername]").attr("checked",false);$(".lg_username").val("")}}}})};webUtil.infoAgreement=function(){var AgreementContent={};var defer=$.Deferred();$.ajax({type:"GET",url:"/w/customer/infoCustomerAgreement.do",dataType:"json",success:function success(data){if(data.result=="SUCCESS"){var data=data.data[0];AgreementContent["status"]=data.isrgsagt;if(data.isrgsagt==1){AgreementContent["rgamtt"]=data.rgamtt;AgreementContent["rgamctt"]=data.rgamctt}defer.resolve(AgreementContent)}}});return defer.promise()};webUtil.memberRegister=function(mdId){var mdId=mdId||"";var html="";html="<ul>"+"<li>"+'<label for="reg_phoneNum_"'+mdId+">手机号码：</label>"+'<input type="text" id="reg_phoneNum_'+mdId+'" class="regForm_item" type = "number">'+"</li>"+'<li><a href="javascript:void(0)" id="register_'+mdId+'" class="reg_btnBg">注 册</a></li>'+"</ul>";$("#regForm_"+mdId).html(html);var phone=$("#regForm_"+mdId).find("#reg_phoneNum_"+mdId);phone.unbind().on("keyup afterpaste",function(){this.value=this.value.replace(/\D/g,"")});$("#regForm_"+mdId).find("#register_"+mdId).unbind().on("click",function(){appUtil.checked_to_where("register",phone.val().trim())})};webUtil.setShopCart=function(mdId,domlist,carSty){$(".shoppingAmount").hide();if(window.WebModel!="edit"&&$(".box_ordercart").length==0){$("#"+mdId+" .shoppingCart").hover(function(){$(this).find(".cartButton_hover").css({"z-index":"2",height:"auto"}).stop(true).slideDown(300);if(carSty=="styleBtn4"||carSty=="styleBtn5"){$(this).find(".cartPanel").css("border-radius","5px 5px 0 0")}},function(){$(this).find(".cartButton_hover").css({"z-index":"1",height:"auto"}).stop(true).slideUp(300);if(carSty=="styleBtn4"||carSty=="styleBtn5"){$(this).find(".cartPanel").css("border-radius","25px")}})}webUtil.UpdataCartNum();if(WebModel=="view"&&$(".box_ordercart").length==0){$("#"+mdId+" .shoppingCart_a").click(function(e){e.preventDefault();appUtil.checked_to_where("shopingcart")})}};webUtil.UpdataCartNum=function(){if(WebModel=="view"){var obj="shoppingAmount";var domlist=".cart_list_dom";var mid=window.memberId_center.mid;var isLogin="0";var noGoods=function noGoods(){var $dom=$(domlist);var cart_html2='<div class="NoGoods">'+"<span></span>"+'<div class="NoGoodsText">'+'<p class="langText" data-lang="shoppingCart_tip">'+langUtil.Shop_shoppingTip+"</p>"+"</div>"+"</div>";$dom.html(cart_html2);$("."+obj).hide()};$.when(iyongwebmember.checkLogin(JSON.stringify({mid:mid})),iyongwebmember.getLoginInfo(JSON.stringify({mid:mid})),iyongwebmember.listCart(JSON.stringify({mid:mid}))).done(function(checkMember,memberInfo,orderNum){isLogin=checkMember.status;if(isLogin=="1"){var orderNum_use=[];if(orderNum==undefined){orderNum=[]}else{orderNum_use=orderNum.data}var $dom=$(domlist);if(orderNum_use&&orderNum_use.length>0){if(domlist){var toalPrice=0;var totalnum=0;var cart_html='<div class="list_goods">';cart_html+='<div class="cart_top">'+langUtil.Shop_newProdoct+"</div>";cart_html+='<div class="cartContent">';cart_html+="<ul id ='cart_ul'>";$.each(orderNum_use,function(i,item){if(!item.reason){if(!item.middtbnurl){item.middtbnurl=imgPath+"/images/nopic.jpg"}cart_html+='<li class="cart-delete">';cart_html+='<div class="cart_img"><a href="displayproduct.html?id='+item.productId+'" target="_blank"><img src="'+item.middtbnurl+'"/></a></div>';cart_html+='<div class="cart_name"><a href="displayproduct.html?id='+item.productId+'" target="_blank">'+item.productName+"</a></div>";cart_html+='<div class="cart_info">';cart_html+='<div class="cart_price">'+langUtil.ordercart_Amount+item.salePrice+"x"+item.productCount+"</div>";cart_html+='<a href="javascript:;" data-count="'+item.productCount+'" data-wsctid="'+item.cartId+'" class="cart_del">'+langUtil.Shop_delete+"</a>";cart_html+="</div>";cart_html+="</li>";totalnum=totalnum+item.productCount;toalPrice=toalPrice+item.salePrice*item.productCount}});toalPrice=parseFloat(toalPrice).toFixed(2);$("."+obj).show();$("."+obj).text(totalnum);cart_html+="</ul>";cart_html+="</div>";cart_html+='<div class="cart_but">';cart_html+='<div class="cart_ft_info">'+langUtil.Shop_compropriedade+'<span class="cart_num">'+totalnum+"</span>"+langUtil.Shop_comprodoct+langUtil.Shop_ShoppingTotal+'<span class="cart_price">'+langUtil.Global_Amount+toalPrice+"</span></div>";cart_html+='<a class="cart_ft_lk" href=javascript:appUtil.checked_to_where("shopingcart")>'+langUtil.Shop_goshopping+"</a>";cart_html+="</div>";cart_html+="</div>";$dom.html(cart_html);$(".cart_del").click(function(){var wsctidel=$(this).data("wsctid");var count=$(this).data("count");var thiz=this;var jsonstr='{"mid":"'+window.memberId_center.mid+'","customerId":"'+memberInfo.accountId+'","cartIdList":"'+wsctidel+'"}';$.when(iyongwebmember.deleteCart(jsonstr)).done(function(res){if(res.status==1){webUtil.showTip("删除成功！",1.5);webUtil.UpdataCartNum()}else{webUtil.showTip(res.errorMsg,1.5)}})})}}else{$("."+obj).text("0");if(domlist){noGoods()}}}else{noGoods()}})}};webUtil.addCar=function(event){var src=$(this).data("src");var sid=$(this).data("id");var e=event;require(["csspath/member/js/shopUtil"],function(){$.when(shopUtil.setCart(sid)).done(function(flag){var flag=flag;if(flag){webUtil.UpdataCartNum("cart_num");webUtil.addCar_pop()}})})};webUtil.addCar_pop=function(){$.when(shopUtil.loadCartData()).done(function(CartData){var data=CartData;var price=0;var toalNum=0;$.each(data,function(i,item){if(item.pdsts==1){price=price+item.ct*item.slpic;toalNum++}});price=parseFloat(price).toFixed(2);var html="";var towhere="appUtil.checked_to_where('shopingcart')";html+='<div id="addCar_pop">';html+='<div class="addCar_pop_shadow" onclick="webUtil.closeCar()"></div>';html+='<div class="addCar_pop_main">';html+='<div class="addCar_pop_t"><span></span>'+langUtil.Shop_joinShopping+'<a href="javascript:void(0)" class="addCar_pop_close" onclick="webUtil.closeCar()"></a></div>';html+='<div class="addCar_pop_content">'+langUtil.Shop_ShoppingAll+"<b> "+toalNum+" </b>"+langUtil.Shop_comprodoct+langUtil.Shop_ShoppingTotal+"<b>"+langUtil.Global_Amount+price+"</b></div>";html+='<div class="addCar_pop_button"><a href="javascript:'+towhere+'" onclick="webUtil.closeCar()">'+langUtil.Shop_goShoppingClose+'</a><a href="javascript:void(0)" onclick="webUtil.closeCar()">'+langUtil.Shop_ShoppingContinue+"</a></div>";html+="</div>";html+="</div>";$("body #addCar_pop").remove();$("body").append(html)})};webUtil.closeCar=function(){$("#addCar_pop").remove()};webUtil.fly=function(endId,e,src){require(["jquery","jspath/jquery.fly"],function(){var offset=$("#"+endId+" .message").offset(),flyer=$('<img class="u-flyer" src="'+src+'"/>');var top=e.pageY-$(window).scrollTop();var left=e.pageX-$(window).scrollLeft();var top1=offset.top-$(window).scrollTop()+10;var left1=offset.left-$(window).scrollLeft()+10;flyer.fly({start:{left:left,top:top},end:{left:left1,top:top1,width:20,height:20},onEnd:function onEnd(){webUtil.UpdataCartNum("cart_num");webUtil.addCar_pop();this.destory()}})})};webUtil.fileDownPages=function(mdId,fileStyleMode,pageNum,fileSize){var ul=$("#fileItemBox_"+mdId).find(".fileList");require(["jquery.Mpagination"],function(){$("#Pagination_"+mdId).pagination(fileSize,{first_text:langUtil.Global_first,end_text:langUtil.Global_endPage,prev_text:langUtil.Global_prePage,next_text:langUtil.Global_nextPage,num_edge_entries:1,num_display_entries:6,callback:pageselectCallback,items_per_page:pageNum});function pageselectCallback(page_index,jq){ul.empty();var max_elem=Math.min((page_index+1)*pageNum,fileSize);for(var i=page_index*pageNum;i<max_elem;i++){var resultId=$("#allFileResults_"+mdId).children("span").eq(i),resultHtml=$("#oneFileTpl_"+mdId);var data_imgLink="",data_iconClass="",data_color="";if(resultId.attr("data-imgLink")!=""){data_imgLink=resultId.attr("data-imgLink")}else{if(resultId.attr("data-iconClass")){data_iconClass=resultId.attr("data-iconClass");data_color=resultId.attr("data-color")}else{data_imgLink=imgPath+"images/filetype/"+resultId.attr("data-imgType")+".png"}}var data_fileId=resultId.attr("data-fileId"),data_fileurl=resultId.attr("data-fileurl"),data_title=resultId.attr("data-title"),data_description=resultId.attr("data-description"),data_date=resultId.attr("data-date"),data_author=resultId.attr("data-author"),data_fsize=resultId.attr("data-fsize"),data_typeEndIndex=data_fileurl.lastIndexOf("."),data_type=data_fileurl.substring(data_typeEndIndex+1);if(fileStyleMode=="0"){if(data_imgLink){resultHtml.find("img").attr("src",data_imgLink).parent().show().end().end().find("i").removeClass().hide()}else{resultHtml.find("img").attr("src","").parent().hide().end().end().find("i").addClass(data_iconClass).css("color",data_color).show()}if(data_fileId&&data_fileId!="undefined"&&data_type!="torrent"){resultHtml.find(".title a").attr("href","/w/download.do?fileId="+data_fileId);resultHtml.find(".contect > a").attr("href","/w/download.do?fileId="+data_fileId)}else{resultHtml.find(".title a").attr("href",data_fileurl);resultHtml.find(".contect > a").attr("href",data_fileurl)}resultHtml.find(".title a").attr("title",data_title);resultHtml.find(".title a").text(data_title);resultHtml.find(".brief .defaultSet").text(data_description);resultHtml.find(".issinfo .timesSet").text(data_date);resultHtml.find(".issinfo .userSet").text(data_author)}else{resultHtml.find(".fileNameWrap").attr("title",data_title);resultHtml.find(".fileNameWrap").text(data_title);resultHtml.find(".fileSize").text(data_fsize);if(data_fileId&&data_fileId!="undefined"&&data_type!="torrent"){resultHtml.find(".fileOperate a").attr("href","/w/download.do?fileId="+data_fileId)}else{resultHtml.find(".fileOperate a").attr("href",data_fileurl)}}resultHtml.children("li").clone(true).appendTo(ul)}return false}})};webUtil.setFileDownload=function(mdId,showPageMode,fileDateLength,showCount){if(showPageMode=="0"){require(["jquery.Mpagination"],function(){var initPagination=function(){$("#fileItemBox_"+mdId+" .pagination").pagination(fileDateLength,{first_text:langUtil.Global_first,end_text:langUtil.Global_endPage,prev_text:langUtil.Global_prePage,next_text:langUtil.Global_nextPage,num_edge_entries:1,num_display_entries:6,callback:pageselectCallback,items_per_page:showCount})}();function pageselectCallback(page_index,jq){var max_elem=Math.min((page_index+1)*showCount,fileDateLength);var fileListDom=$("#fileItemBox_"+mdId+" .fileList");fileListDom.html("");for(var i=page_index*showCount;i<max_elem;i++){var new_content=$("#fileItemBox_"+mdId+" .Searchresult li:eq("+i+")").clone();fileListDom.append(new_content)}return false}if($("#fileItemBox_"+mdId+" .fileList").html()==""){$("#fileItemBox_"+mdId+" .pagination").hide()}})}if(window.WebModel=="edit"){$(".fileList").on("click",".downloadText, .download, .fileOperate a, .titleSet",function(e){e.preventDefault();dataUtil.iyongShowTips("设计后台不允许下载！",1)})}};webUtil.getCurrentTime=function(mdId,btnStyle){if(window.intTime){if(window.intTime[mdId]){window.clearInterval(window.intTime[mdId])}}else{window.intTime=[]}var intTime=1e3*30;function getTime(){var d=new Date;var year=d.getFullYear();var month=d.getMonth()+1;if(month>=0&&month<=9){month="0"+month}var day=d.getDate();if(day>=0&&day<=9){day="0"+day}var hours=d.getHours();if(hours>=0&&hours<=9){hours="0"+hours}var minutes=d.getMinutes();if(minutes>=0&&minutes<=9){minutes="0"+minutes}var seconds=d.getSeconds();if(seconds>=0&&seconds<=9){seconds="0"+seconds}var weekday=new Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday");var week=weekday[d.getDay()];var weekday1=new Array("星期天","星期一","星期二","星期三","星期四","星期五","星期六");var week1=weekday1[d.getDay()];if(btnStyle=="aa1"){$("#kenfor_time_"+mdId).html(year+"年"+month+"月"+day+"日"+" "+week1)}else if(btnStyle=="aa2"){$("#kenfor_time_"+mdId).html(year+"年"+month+"月"+day+"日"+" "+hours+":"+minutes)}else if(btnStyle=="aa3"){$("#kenfor_time_"+mdId).html(year+"年"+month+"月"+day+"日"+" "+week1+" "+hours+":"+minutes)}else if(btnStyle=="aa4"){$("#kenfor_time_"+mdId).html(year+"-"+month+"-"+day)}else if(btnStyle=="aa5"){$("#kenfor_time_"+mdId).html(year+"-"+month+"-"+day+" "+hours+":"+minutes)}else if(btnStyle=="aa6"){$("#kenfor_time_"+mdId).html(month+"/"+day+"/"+year+" "+week)}else if(btnStyle=="aa7"){$("#kenfor_time_"+mdId).html(month+"/"+day+"/"+year+" "+hours+":"+minutes)}else if(btnStyle=="aa8"){$("#kenfor_time_"+mdId).html(month+"/"+day+"/"+year+" "+week+" "+hours+":"+minutes)}}getTime();window.intTime[mdId]=self.setInterval(function(){getTime()},intTime)};webUtil.SetHomeSite=function(obj,url){try{obj.style.behavior="url(#default#homepage)";obj.setHomePage(url)}catch(e){if(window.netscape){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(e){alert(langUtil.IndexFavorite_HomeSite)}}else{alert(langUtil.IndexFavorite_Tip+"\n\n"+langUtil.IndexFavorite_Tipadd+"【"+url+"】"+langUtil.IndexFavorite_TipaddTwo)}}};webUtil.AddFavoriteSite=function(title,url){try{window.external.addFavorite(url,title)}catch(e){try{window.sidebar.addPanel(title,url,"")}catch(e){alert(langUtil.IndexFavorite_FavoriteSite)}}};webUtil.setOnlineVideo=function(mdId,isfloat,template,width,height,auto,title,picUrl,sourceUrl,loop,titleStatus){require(["jquery","jquery.jplayer.min"],function($){$("#"+mdId+",#"+template+"_"+mdId).css({width:width,height:height});$(".onlineVideoBox").css({width:width,height:height});var jplayer_id="#jplayer_video_"+mdId,jp_container="#jp_container_video_"+mdId;var sizeW,sizeH;if(isfloat==1){sizeW=100+"%";sizeH=100+"%"}else{sizeW=width+"px";sizeH=height+"px"}var hasFlash=false;try{hasFlash=Boolean(new ActiveXObject("ShockwaveFlash.ShockwaveFlash"))}catch(exception){hasFlash="undefined"!=typeof navigator.mimeTypes["application/x-shockwave-flash"]}var supplied="m4v";var solution="html";if(hasFlash){supplied="m4v,flv";solution="flash,html"}$(jplayer_id).jPlayer({ready:function ready(){$(this).jPlayer("setMedia",{title:title,poster:picUrl,m4v:sourceUrl,flv:sourceUrl})},cssSelectorAncestor:jp_container,size:{width:sizeW,height:sizeH},swfPath:jsPath+"js/lib/jquery.jplayer.swf",supplied:supplied,solution:solution,loop:loop,useStateClassSkin:true,autoBlur:false,smoothPlayBar:true,keyEnabled:true,remainingDuration:true,toggleDuration:true});webUtil.check_video(mdId,template,titleStatus,0);$(window).resize(function(){webUtil.check_video(mdId,template,titleStatus,0)})})};webUtil.setOnlineVideo1=function(mdId,width,height,auto,title,picUrl,sourceUrl,loop){var template="onlineVideo";var templateId=template+"_"+mdId,videoHeight=height;if($("#"+templateId).find(".skin_nav_view").length>0){videoHeight-=Number($("#"+templateId).find(".skin_nav_view").height())}require(["jquery","jquery.jplayer.min"],function($){var jplayer_id="#jplayer_video_"+mdId,jp_container="#jp_container_video_"+mdId;$(jplayer_id).jPlayer({ready:function ready(){$(this).jPlayer("setMedia",{title:title,poster:picUrl,m4v:sourceUrl,flv:sourceUrl})},cssSelectorAncestor:jp_container,size:{width:width,height:videoHeight},swfPath:jsPath+"js/lib/jquery.jplayer.swf",supplied:"m4v,flv",solution:"html",loop:loop,useStateClassSkin:true,autoBlur:false,smoothPlayBar:true,keyEnabled:true,remainingDuration:true,toggleDuration:true});if($("#"+templateId).find(".onlineVideoMask").length<1){$("#"+templateId+" .onlineVideoBox").prepend('<div class="onlineVideoMask"></div>')}$("#"+templateId+" .onlineVideoBox").off("click").on("click",".onlineVideoMask",function(e){if(window.WebModel=="view"){var videoSrc=$("#"+templateId).find("video").attr("src");var videoLoop=loop=="true"?"loop":"";webUtil.showVideoPlay("playMp4",videoSrc,videoLoop)}})})};webUtil.check_video=function(mdId,template,titleStatus,moduleType){var a=$("#"+template+"_"+mdId+" .onlineVideoBox");if(titleStatus==1){var h=$("#"+template+"_"+mdId+" .skin_title").parent().height();a.css({position:"absolute",left:0,top:h,bottom:0,right:0})}else{a.css({position:"absolute",left:0,top:0,bottom:0,right:0})}if(moduleType==0){a.children().css({height:"100%"});a.children().children(".jp-jplayer").css({height:"calc(100% - 34px)"});a.children().children(".jp-jplayer").children().css({height:"100%"})}else{a.children().css({width:"100%",height:"100%",background:"black"})}};webUtil.videoControl=function(auto,mdId,template,loop,playType,closeBtnColor,closeBtnType){var templateId=template+"_"+mdId;if($("#"+templateId).find(".onlineVideoMask").length<1){$("#"+templateId+" .onlineVideoBox").prepend('<div class="onlineVideoMask"></div>')}$("#"+template+"_"+mdId+" .onlineVideoBox").off("click").on("click",".onlineVideoMask",function(e){if(window.WebModel=="view"){var videoComponent=$(e.target).next();var videoSrc="";if(videoComponent[0].nodeName.toLowerCase()=="video"){if(videoComponent.attr("src")){videoSrc=videoComponent.attr("src")}else{videoSrc=videoComponent.find("source").attr("src")}}else{videoSrc=videoComponent.attr("data-src")}webUtil.showVideoPlay("playMp4",videoSrc,loop,playType,mdId,closeBtnColor,closeBtnType)}})};webUtil.showVideoPlay=function(idenStr,videoSrc,loop,playType,mdId,closeBtnColor,closeBtnType){if(videoSrc&&!/https:/gi.test(videoSrc)){videoSrc=videoSrc.replace(/http:/gi,"");videoSrc="https:"+videoSrc}function largeScreenPlay(playWinType){var isFullScreen=!playWinType||playWinType=="large"?true:false,videoPlayBlockDom="",closeBtnHtml="",isFullScreenStr=isFullScreen?"true":"false";if(closeBtnType=="0"||typeof closeBtnType==="undefined"){if(/(rgb|#)/g.test(closeBtnColor)){closeBtnHtml='<div id="videoPlayClose" onclick="webUtil.hideVideoPlay('+isFullScreenStr+')" style="background-color:'+closeBtnColor+'">                        <i class="videoCloseIcon icon iconfont kenfor-icons-off1 closeBtnWithoutLine"></i>                    </div>'}else{closeBtnHtml='<div id="videoPlayClose" onclick="webUtil.hideVideoPlay('+isFullScreenStr+')" class="videoCloseBox_type_'+closeBtnColor+'">                        <i class="videoCloseIcon icon iconfont kenfor-icons-off1 closeBtnWithoutLine"></i>                    </div>'}}else if(closeBtnType=="1"){if(/(rgb|#)/g.test(closeBtnColor)){closeBtnHtml='<div id="videoPlayClose" onclick="webUtil.hideVideoPlay('+isFullScreenStr+')" style="background-color:#fff">                        <span class="videoCloseIcon kenfor-icons-off2 closeBtnLineInside" style="border-color:'+closeBtnColor+';"></span>                    </div>'}else{closeBtnHtml='<div id="videoPlayClose" onclick="webUtil.hideVideoPlay('+isFullScreenStr+')" style="background-color:#fff">                        <span class="videoCloseIcon kenfor-icons-off2 closeBtnLineInside fakeCloseIcon_type_'+closeBtnColor+'"></span>                    </div>'}}if(isFullScreen){if($("body").find("#videoPlayBlock").length<1){videoPlayBlockDom='<div id="videoPlayBlock">                        <div id="videoPlay"></div>                        <div id="videoPlayMask"></div>                        '+closeBtnHtml+"                    </div>"}}else{if($("body").find("#videoPlayBlock_middle").length<1){videoPlayBlockDom='<div id="videoPlayBlock_middle">                        <div id="videoPlayPanel_middle">                            <div id="videoPlay_middle"></div>                            '+closeBtnHtml+"                        </div>                    </div>"}}$("body").append(videoPlayBlockDom);if(idenStr=="playMp4"){var loopStr=loop=="true"?"loop":"",widthStr=isFullScreen?$(window).width():1e3,heightStr=isFullScreen?$(window).height():562.5,videoStr='<video src="'+videoSrc+'" style="width:'+widthStr+"px;height:"+heightStr+'px" controls '+loopStr+'>                                <source src="'+videoSrc+'" type="video/mp4"/>                                <source src="'+videoSrc+'" type="video/ogg"/>                                <source src="'+videoSrc+'" type="video/webm"/>                            </video>';if(isFullScreen){$("#videoPlay").html(videoStr);$("#videoPlayBlock").css("display","block");$("#videoPlay video")[0].play()}else{$("#videoPlay_middle").html(videoStr);$("#videoPlayBlock_middle").css("display","block");$("#videoPlay_middle video")[0].play()}}else if(idenStr=="playTorrent"){require(["./webtorrent.min"],function(WebTorrent){if(isFullScreen){$("#videoPlayBlock").css("display","block").find("#videoPlay").html("")}else{$("#videoPlayBlock_middle").css("display","block").find("#videoPlay_middle").html("")}var client=new WebTorrent;client.add(videoSrc,function(torrent){torrent.files.forEach(function(file){if(file.name.endsWith(".mp4")){if(isFullScreen){file.appendTo("#videoPlay")}else{file.appendTo("#videoPlay_middle")}}});if(isFullScreen){$("#videoPlay video").css({width:$(window).width(),height:$(window).height()});if(loop=="loop"){$("#videoPlay video").prop("loop","true").attr("loop","true")}$("#videoPlay video")[0].play()}else{$("#videoPlay_middle video").css({width:1e3,height:562.5});if(loop=="loop"){$("#videoPlay_middle video").prop("loop","true").attr("loop","true")}$("#videoPlay_middle video")[0].play()}})})}if(isFullScreen){$(window).resize(function(){$("#videoPlay video").css({width:$(this).width(),height:$(this).height()})})}$(window).off("keyup").on("keyup",function(e){webUtil.escHideVideoPlay(isFullScreen,e)})}if(playType=="tiny"){var argObj={idenStr:idenStr,videoSrc:videoSrc,loop:loop,mdId:mdId};webUtil.tinyScreenPlay(argObj)}else{largeScreenPlay(playType)}};webUtil.hideVideoPlay=function(isFullScreen){if(isFullScreen){$("#videoPlayBlock").remove()}else{$("#videoPlayBlock_middle").remove()}};webUtil.escHideVideoPlay=function(isFullScreen,ev){var e=ev||window.event;if(e.keyCode===27){webUtil.hideVideoPlay(isFullScreen);$(window).off("keyup")}};webUtil.tinyScreenPlay=function(argObj){var idenStr=argObj.idenStr,videoSrc=argObj.videoSrc,loop=argObj.loop,mdId=argObj.mdId,videoBoxDom=$("#"+mdId+" .onlineVideoBox"),videoHeight=videoBoxDom.height(),videoWidth=videoBoxDom.width(),playEndListen=function playEndListen(){$("#"+mdId+" .onlineVideoBox video")[0].addEventListener("ended",playEndFn)},playEndFn=function playEndFn(){$("#"+mdId+" .onlineVideoBox video").css("display","none")};if(videoBoxDom.find("video.tinyScreenVideo").length>0){videoBoxDom.find("video.tinyScreenVideo").css("display","block").get(0).play()}else{if(idenStr=="playMp4"){var loopStr=loop=="true"?"loop":"",videoStr='<video src="'+videoSrc+'" class="tinyScreenVideo" style="height:'+videoHeight+"px;width:"+videoWidth+'px;" controls '+loopStr+">"+'<source src="'+videoSrc+'" type="video/mp4"/><source src="'+videoSrc+'" type="video/ogg"/>'+'<source src="'+videoSrc+'" type="video/webm"/></video>';$("#"+mdId+" .onlineVideoBox").append(videoStr);$("#"+mdId+" .onlineVideoBox video")[0].play();if(loop!="true"){playEndListen()}}else if(idenStr=="playTorrent"){require(["./webtorrent.min"],function(WebTorrent){var client=new WebTorrent;client.add(videoSrc,function(torrent){torrent.files.forEach(function(file){if(file.name.endsWith(".mp4")){file.appendTo("#"+mdId+" .onlineVideoBox")}});$("#"+mdId+" .onlineVideoBox video").css({height:videoHeight,width:videoWidth}).addClass("tinyScreenVideo");if(loop=="true"){$("#"+mdId+" .onlineVideoBox video").prop("loop","true").attr("loop","true")}$("#"+mdId+" .onlineVideoBox video")[0].play();if(loop!="true"){playEndListen()}})})}}};webUtil.fakeVideoControl=function(mdId,sourceUrl,loop,playType,closeBtnColor,closeBtnType){$("#onlineVideo_"+mdId+" .onlineVideoBox").off("click").on("click",".fakeVideoContainer",function(e){if(window.WebModel=="view"&&sourceUrl){webUtil.showVideoPlay("playTorrent",sourceUrl,loop,playType,mdId,closeBtnColor,closeBtnType)}})};webUtil.eduiVideoClickPlay=function(){var eduiVideoDom=$(".edui-upload-video");eduiVideoDom.each(function(i,item){var picUrl=$(this).attr("middtbnurl");if(picUrl){$(this).css("background-image","url("+picUrl+")")}});eduiVideoDom.off("click").on("click",function(){var videoSrc=$(this).attr("src"),videoType=videoSrc?videoSrc.split(".").pop():"",playType=videoType?videoType=="mp4"?"playMp4":"playTorrent":"";if(videoSrc&&$(this).hasClass("edui-upload-video")){webUtil.showVideoPlay(playType,videoSrc,"")}else{return false}})};$(document).ready(function(){webUtil.eduiVideoClickPlay();if(WebModel=="view"){$("body").on("click",".appLink_online_video",function(){var videoUrl=$(this).attr("data-video");if(videoUrl){var videoType=videoUrl.split(".").pop(),playType=videoType?videoType=="mp4"?"playMp4":"playTorrent":"";webUtil.showVideoPlay(playType,videoUrl)}})}$("body").on("click",".appLink_online_anchor",function(){var anchorVal=$(this).attr("data-anchor");var $dom=$("body,html");var scrollTop_h=$("#"+anchorVal).offset().top;if(WebModel=="edit"){$dom=$("#design");scrollTop_h=scrollTop_h-$("#head").height()+$dom.scrollTop()}$dom.animate({scrollTop:scrollTop_h},400)});var oldProductSearchDom=$("body .box_productSearch");if(oldProductSearchDom.length>0){oldProductSearchDom.each(function(i,item){var mdId=$(item).attr("id");if($(item).find("input[name=type]").length===0){$(item).append('<input type="hidden" name="type" value="0"/>')}$(item).find("form[name=searchForm]").attr("method","get").end().find("input[name=kw]").attr("name","keyword").unbind("input propertychange").on("input propertychange",function(){var searchInputVal=$(this).val();$(this).closest(".box_productSearch").find("input[name=keyword]").val(searchInputVal)}).end().find("input[name=wjs]").remove().end().find("#search"+mdId).off("click").on("click",function(){sessionStorage.setItem("searchReturnPage",window.location.href);$("#searchForm"+mdId).submit()});var keywordLinkDomList=$(item).find(".kenfor_keyword a");keywordLinkDomList.each(function(i,keywordLink){var keywordLinkHref=$(keywordLink).attr("href"),keywordStr=$(keywordLink).text(),typeStr=$(item).find("form[name=searchForm] [name=type]").val();if(keywordLinkHref.indexOf("kw=")>-1){$(keywordLink).attr("href",keywordLinkHref.replace("kw=","type="+typeStr+"&keyword="+keywordStr)).on("click",function(){sessionStorage.setItem("searchReturnPage",window.location.href)})}})})}});webUtil.setWeather=function(selectCityMode,weaCity,weaCounty,weaStyleMode){$.getScript("http://int.dpool.sina.com.cn/iplookup/iplookup.php?format=js'",function(script,textStatus,jqXHR){var citytq;var weatherCity;if(selectCityMode=="0"){citytq=remote_ip_info.city;weatherCity=remote_ip_info.city}else{citytq=weaCity;weatherCity=weaCounty}$.ajax({url:"http://php.weather.sina.com.cn/iframe/index/w_cl.php?code=js&city="+weatherCity+"&day=1&dpc=1",dataType:"script",scriptCharset:"gbk",success:function success(data){var today_weather=window.SWther.w[weatherCity][0];var tomorrow_weather=window.SWther.w[weatherCity][1];var today_weather_img=webUtil.dis_img(today_weather.s1,weaStyleMode);$("#wea_city1").html(weatherCity);$("#wea_cloud1").html(today_weather.s1);$("#wea_temp1").html(today_weather.t1+"&degC ~ "+today_weather.t2+" &degC");$("#wea_city3").html(weatherCity);$("#wea_cloud3").html("<img style='width:25px;' src='"+today_weather_img+"' title='"+today_weather.s1+"' alt='"+today_weather.s1+"' />");$("#wea_temp3").html(today_weather.t1+"&degC ~ "+today_weather.t2+" &degC");$("#wea_city4").html(weatherCity);$("#wea_cloud4").html("<img style='width:25px;' src='"+today_weather_img+"' title='"+today_weather.s1+"' alt='"+today_weather.s1+"' />");$("#wea_temp4").html(today_weather.t1+"&degC ~ "+today_weather.t2+" &degC");$("#wea_wind4").html(today_weather.d1);$("#wea_city5").html(weatherCity);$("#wea_image5").html("<img style='float:left;margin-top: 8px;width:65px;' src='"+today_weather_img+"' title='"+today_weather.s1+"' alt='"+today_weather.s1+"' />");$("#wea_date5").html(today_weather.t1+"&degC ~ "+today_weather.t2+" &degC");$("#wea_cloud5").html(today_weather.s1);var tomorrow_weather_img=webUtil.dis_img(tomorrow_weather.s1,weaStyleMode);$("#wea_image51").html("<img style='float:left;margin-top: 8px;width:65px;' src='"+tomorrow_weather_img+"' title='"+tomorrow_weather.s1+"' alt='"+tomorrow_weather.s1+"' />");$("#wea_date51").html(tomorrow_weather.t1+"&degC ~ "+tomorrow_weather.t2+" &degC");$("#wea_cloud51").html(tomorrow_weather.s1);$("#wea_city6").html(weatherCity);$("#wea_image6").html("<img style='border:0;margin: 8px;width:65px;' src='"+today_weather_img+"' title='"+today_weather.s1+"' alt='"+today_weather.s1+"' />");$("#wea_temp6").html(today_weather.t1+"&degC ~ "+today_weather.t2+" &degC");$("#wea_cloud61").html(today_weather.s1);$("#wea_wind6").html(today_weather.p1+"级");$("#wea_direction6").html(today_weather.d1);$("#wea_city7").html(weatherCity);$("#wea_image7").html("<img style='border:0;width:70px;' src='"+today_weather_img+"' title='"+today_weather.s1+"' alt='"+today_weather.s1+"' />");$("#wea_temp7").html(today_weather.t1+"&degC");$("#wea_cloud71").html(today_weather.s1);$("#wea_wind7").html(today_weather.d1);$("#wea_city8").html(weatherCity);$("#images8").html("<img style='border:0;width:70px;' src='"+today_weather_img+"' title='"+today_weather.s1+"' alt='"+today_weather.s1+"' />");$("#wea_temp8").html(today_weather.t1+"&degC");$("#wea_cloud81").html(today_weather.s1);$("#wea_wind8").html(today_weather.d1);$("#wea_city9").html(weatherCity);$("#images9").html("<img style='border:0;width:70px;' src='"+today_weather_img+"' title='"+today_weather.s1+"' alt='"+today_weather.s1+"' />");$("#wea_temp9").html(today_weather.t1+"&degC");$("#wea_cloud91").html(today_weather.s1);$("#wea_wind9").html(today_weather.p1+"级");$("#wea_direction9").html(today_weather.d1)}})})};webUtil.dis_img=function(weather,weaStyleMode){var forder;var route=imgPath+"images/weather/";if(weaStyleMode=="2"||weaStyleMode=="3"){forder="weatherPic1"}else if(weaStyleMode=="4"||weaStyleMode=="5"){forder="weatherPic2"}else if(weaStyleMode=="7"||weaStyleMode=="8"||weaStyleMode=="6"){forder="weatherPic3"}var style_img=route+forder+"/qing.png";if(weather.indexOf(langUtil.weather_Fine)!==-1){style_img=route+forder+"/qing.png"}else if(weather.indexOf(langUtil.weather_Cloudy)!==-1){style_img=route+forder+"/duoyun.png"}else if(weather.indexOf(langUtil.weather_Overcast)!==-1){style_img=route+forder+"/yin.png"}else if(weather.indexOf(langUtil.weather_Shower)!==-1){style_img=route+forder+"/zhenyu.png"}else if(weather.indexOf(langUtil.weather_ThunderShower)!==-1){style_img=route+forder+"/leizhenyu.png"}else if(weather.indexOf(langUtil.weather_ShowerHail)!==-1){style_img=route+forder+"/weather1.png"}else if(weather.indexOf(langUtil.weather_Sleet)!==-1){style_img=route+forder+"/weather2.png"}else if(weather.indexOf(langUtil.weather_Sprinkle)!==-1){style_img=route+forder+"/xiaoyu.png"}else if(weather.indexOf(langUtil.weather_Moderate)!==-1||weather.indexOf(langUtil.weather_SprinkleModerate)!==-1){style_img=route+forder+"/zhongyu.png"}else if(weather.indexOf(langUtil.weather_Heavy)!==-1||weather.indexOf(langUtil.weather_ModerateHeavy)!==-1){style_img=route+forder+"/dayu.png"}else if(weather.indexOf(langUtil.weather_Rainstorm)!==-1||weather.indexOf(langUtil.weather_HeavyRainstorm)!==-1){style_img=route+forder+"/baoyu.png"}else if(weather.indexOf(langUtil.weather_Downpour)!==-1){style_img=route+forder+"/dabaoyu.png"}else if(weather.indexOf(langUtil.weather_Downpour)!==-1||weather.indexOf(langUtil.weather_BigRainstorm)!==-1){style_img=route+forder+"/baoyu.png"}else if(weather.indexOf(langUtil.weather_Hail)!==-1){style_img=route+forder+"/dongyu.png"}else if(weather.indexOf(langUtil.weather_ShowerSnow)!==-1){style_img=route+forder+"/zhenxue.png"}else if(weather.indexOf(langUtil.weather_SmallSnow)!==-1){style_img=route+forder+"/xiaoxue.png"}else if(weather.indexOf(langUtil.weather_MiddleSnow)!==-1){style_img=route+forder+"/zhongxue.png"}else if(weather.indexOf(langUtil.weather_BigSnow)!==-1){style_img=route+forder+"/daxue.png"}else if(weather.indexOf(langUtil.weather_RanstormSnow)!==-1){style_img=route+forder+"/baoxue.png"}else if(weather.indexOf(langUtil.weather_Fog)!==-1){style_img=route+forder+"/wu.png"}else if(weather.indexOf(langUtil.weather_SandStorm)!==-1){style_img=route+forder+"/shachenbao.png"}else if(weather.indexOf(langUtil.weather_Dust)!==-1){style_img=route+forder+"/shachen.png"}else if(weather.indexOf(langUtil.weather_BlowingSand)!==-1){style_img=route+forder+"/yangsha.png"}else if(weather.indexOf(langUtil.weather_StrongSandstorm)!==-1){style_img=route+forder+"/weather4.png"}else if(weather.indexOf(langUtil.weather_Cloudy)!==-1||weather.indexOf(langUtil.weather_Fine)!==-1){style_img=route+forder+"/duoyun.png"}else if(weather.indexOf(langUtil.weather_Cloudy)!==-1&&weather.indexOf(langUtil.weather_Overcast)!==-1){style_img=route+forder+"/duoyun.png"}else if(weather.indexOf(langUtil.weather_Overcast)!==-1&&weather.indexOf(langUtil.weather_Rain)!==-1){style_img=route+forder+"/yin.png"}else if(weather.indexOf(langUtil.weather_Fine)!==-1&&weather.indexOf(langUtil.weather_Rain)!==-1){style_img=route+forder+"/wu.png"}else if(weather.indexOf(langUtil.weather_Fine)!==-1&&weather.indexOf(langUtil.weather_Fog)!==-1){style_img=route+forder+"/wu.png"}else{style_img=route+forder+"/duoyun.png"}return style_img};webUtil.backToSearchMap=function(mdId){$(".network_mask_tpl").css({display:"none"})};webUtil.setMapResList=function(mdId){if(!$("body").children().hasClass("network_mask_tpl")){var maskTpl='<div class="network_mask_tpl">'+'<div class="network_mask"></div>'+'<div class="lightBox">'+'<div class="map_header">'+'<div class="header_title"></div>'+'<a class="close_mask" onclick="webUtil.backToSearchMap()" href="javascript:;"></a>'+"</div>"+'<div class="map_content">'+'<div id="baiduMap_'+mdId+'" class="baidu_map"></div>'+"</div>"+'<div class="map_item_list">'+'<div class="store_head">'+'<i class="icon kenfor-icons-home"></i>'+'<span class="nearby_title">附近网点</span>'+'<i class="icon kenfor-icons-downward1 map_downward"></i>'+"</div>"+'<div class="store_info scrollbar"><ul class="res_item_list" id="res_item_list"></ul></div>'+"</div>"+"</div>"+"</div>";$("body").append(maskTpl)}var srH=window.screen.height*.61+"px";var srW=window.screen.width*.45+"px";$(".lightBox").css({width:srW,height:srH});$(".network_mask_tpl").css({display:"block"});$(".store_info .res_item_list").html($("#resData_"+mdId).html());require(["jqueryui"],function(){$(".lightBox").draggable({handle:".header_title"})})};webUtil.storeControl=function(){$(".store_head").off("click").on("click",function(){$(".store_head").toggleClass("hover");$(".store_head .map_downward").toggleClass("kenfor-icons-upward1");$(".store_info").toggleClass("store_hide")})};webUtil.getStoreMap=function(e,mdId,type){webUtil.setMapResList(mdId);webUtil.storeControl();var map_name,map_phone,map_addr,map_pro;if(type=="resStore"){var parentDom=$(e).parent(".res_content");map_name=$(parentDom).find(".res_store_title").text();map_phone=$(parentDom).find(".res_store_phone").data("phone");map_addr=$(parentDom).find(".res_store_address").data("addr");map_pro=$(parentDom).find("input[name='res_addrPro']").val();var resId=$(e).data("id")}else if(type=="resMap"){map_name=$(e).find(".res_store_title").text();map_phone=$(e).find(".res_store_phone").data("phone");map_addr=$(e).data("stoaddr");map_pro=$(e).data("stopro");var resId=$(e).data("id")}var itemDom=$(".network_mask_tpl .lightBox .map_item_list .res_item_list .res_info");$.each(itemDom,function(){var itemId=$(this).data("id");if(resId==itemId){$(this).addClass("item_selected").siblings().removeClass("item_selected")}});$(".network_mask_tpl .lightBox .header_title").html(map_name);require(["jquery","async!BMap"],function($){var map=new BMap.Map("baiduMap_"+mdId);var point=new BMap.Point(113.410312,22.507476);map.centerAndZoom(point,17);map.clearOverlays();var myGeo=new BMap.Geocoder;myGeo.getPoint(map_addr,function(point){if(point){map.centerAndZoom(point,17);var newMaker=new BMap.Marker(point);map.addOverlay(newMaker);var pointSize={width:200};var mapInfo=map_name+"<br>地址："+map_addr;if(map_phone){mapInfo=map_name+"<br>地址："+map_addr+"<br>电话："+map_phone}if(mapInfo){var infoWindow=new BMap.InfoWindow(mapInfo,pointSize);newMaker.openInfoWindow(infoWindow)}newMaker.addEventListener("click",function(){var infoWindow=new BMap.InfoWindow(mapInfo,pointSize);newMaker.openInfoWindow(infoWindow)})}else{alert("搜索不到结果")}},map_pro);var bMapNavigation=new BMap.NavigationControl;map.addControl(bMapNavigation);var bMapScale=new BMap.ScaleControl;map.addControl(bMapScale);map.enableScrollWheelZoom();map.enableContinuousZoom();map.enableInertialDragging();map.enableKeyboard()})};webUtil.setEchartsMap=function(mdId,Data,saleMode,pageNum,proVal){var proDom=$("#networkSale_"+mdId+" .search_area").find("select[name='area-province']");var cityDom=$("#networkSale_"+mdId+" .search_area").find("select[name='area-city']");var province;if(proVal){province=proVal}else{webUtil.searchRes(mdId,Data,"",3,saleMode,pageNum)}var mapCol="#cc365e";var mapColor=$("#searchMap_"+mdId).data("mapcolor");if(mapColor){mapCol=mapColor}var mapSelCol="#999999";var mapSelColor=$("#searchMap_"+mdId).data("mapselcolor");if(mapSelColor){mapSelCol=mapSelColor}var fontCol="#fff";var fontColor=$("#searchMap_"+mdId).data("fontcolor");if(fontColor){fontCol=fontColor}var fontSelCol="#fff";var fontSelColor=$("#searchMap_"+mdId).data("fontselcolor");if(fontSelColor){fontSelCol=fontSelColor}require(["echarts-all"],function(){var chartDom=document.getElementById("searchMap_"+mdId);var myChart=echarts.init(chartDom);var option={tooltip:{trigger:"item",formatter:"{b}"},series:[{name:"中国",type:"map",mapType:"china",selectedMode:"single",itemStyle:{normal:{color:mapCol,label:{show:true,textStyle:{color:fontCol}}},emphasis:{color:mapSelCol,label:{show:true,textStyle:{color:fontSelCol}}}},data:[{name:province,selected:true}]}]};myChart.on("click",function(params){var p=params.name;webUtil.setProVal(proDom,p,2,cityDom);webUtil.searchRes(mdId,Data,p,1,saleMode,pageNum)});myChart.setOption(option)})};webUtil.setProVal=function(proDom,proVal,ctype,cityDom){$(proDom).find("option").each(function(i,n){var that=$(this);var tmpThisVal=that.val();if(tmpThisVal==proVal){that.attr("selected",true).siblings().attr("selected",false);$(proDom).val(tmpThisVal)}});if(ctype==2){require(["linkage/allcity"],function(cityData){var tmpVal=$(proDom).val();$(cityDom).empty();var tmpArr2="<option value=''>请选择</option>";$.each(cityData,function(i,n){if(tmpVal==n.name){$.each(n.city,function(j,k){tmpArr2+='<option value="'+k.name+'">'+k.name+"</option>"})}});$(cityDom).html(tmpArr2)})}};webUtil.selectCity=function(proDom,cityDom,defProv,defCity){require(["linkage/allcity"],function(cityData){if($(proDom).children().length==0){$.each(cityData,function(i,n){var tmpArr1=['<option value="'+n.name+'">'+n.name+"</option>"];$(proDom).append(tmpArr1.join(""));if(i==0){var tmpArr2=['<option value="'+n.city[0].name+'">'+n.city[0].name+"</option>"];$(cityDom).append(tmpArr2.join(""))}})}$(proDom).bind("change",function(){var tmpVal=$(this).val();webUtil.setProVal(proDom,tmpVal);$(cityDom).empty();var tmpArr2="<option value=''>请选择</option>";$.each(cityData,function(i,n){if(tmpVal==n.name){$.each(n.city,function(j,k){tmpArr2+='<option value="'+k.name+'">'+k.name+"</option>"})}});$(cityDom).html(tmpArr2);if(defCity&&$(cityDom).find("option[value='"+defCity+"']").length>0){$(cityDom).val(defCity).trigger("change");defCity=""}});if(defProv){$(proDom).val(defProv).trigger("change");defProv=""}})};webUtil.changeSelPro=function(mdId,Data,e,selType,saleMode,pageNum){$(e).unbind("change").on("change",function(){var proVal=$(this).val();if(selType==1){webUtil.setEchartsMap(mdId,Data,saleMode,pageNum,proVal)}if(proVal!=""&&proVal!=null){webUtil.searchRes(mdId,Data,proVal,selType,saleMode,pageNum)}})};webUtil.searchByKeywork=function(mdId,Data,saleMode,pageNum){var sleWord=$("#networkSale_"+mdId+" .search_keyword").val();webUtil.searchRes(mdId,Data,sleWord,3,saleMode,pageNum)};webUtil.searchRes=function(mdId,Data,sleWord,type,saleMode,pageNum){var resFlag=false;var flag=false;var html="";var reshtml="";var num=0;if(Data&&Data!=""){$.each(Data,function(key,item){var resData=item.info.data;var resTitle;if(type==1){resTitle=item.addrPro}else if(type==2){resTitle=item.info.city}else if(type==3){resTitle=resData.title}if(resTitle.indexOf(sleWord)>-1){++num;flag=true;html+='<li class="res_info j_setResW">'+'<div class="res_content res_floatLeft">'+'<span class="res_title res_store_title">'+resData.title+"</span>"+'<div class="res_text res_store_address" data-addr="'+resData.addr+'"><span class="datail_txt">地址：</span><span class="detail_addr">'+resData.addr+"</span></div>";if(resData.phone){html+='<div class="res_text res_store_phone" data-phone="'+resData.phone+'"><span class="datail_txt">电话：</span><span class="detail_addr">'+resData.phone+"</span></div>"}html+='<div class="linkMap res_text" data-id="'+item.id+'" onclick="webUtil.getStoreMap(this,\''+mdId+"','resStore')\" >"+'<i class="fontIcon kenfor-icons-gps1"></i>查看地图'+'<input name="res_addrPro" type="hidden" value="'+item.addrPro+'" />'+"</div>"+"</div>"+"</li>";reshtml+='<li class="res_info" data-id="'+item.id+'" data-stoaddr="'+resData.addr+'" data-stopro="'+item.addrPro+'" onclick="webUtil.getStoreMap(this,\''+mdId+"','resMap')\">"+'<div class="res_content">'+'<span class="res_title res_store_title">'+resData.title+"</span>";if(resData.phone){reshtml+='<div class="res_text res_store_phone" data-phone="'+resData.phone+'">电话：'+resData.phone+"</div>"}reshtml+="</div></li>";if(num%3==0){html+='<div style="clear: both;"></div>'}}else{resFlag=true}})}else{resFlag=true}if(resFlag&&!flag){html+='<div class="noResult">暂无搜索结果</div>'}if(saleMode==0){$("#searchRes_"+mdId).find(".resList_box").html(html)}else if(saleMode==1){$("#Pagination_"+mdId+" .h_searchAllData").find(".resList_box").html(html)}$("#resData_"+mdId).find(".resList_box").html(reshtml);webUtil.setResListWidth(mdId,saleMode);webUtil.setNetworkResPage(mdId,saleMode,num,pageNum)};webUtil.setNetworkResPage=function(mdId,saleMode,num,pageNum){if(saleMode=="1"){require(["jquery.Mpagination"],function(){var initPagination=function(){$("#"+mdId+" .pagination").pagination(num,{first_text:langUtil.Global_first,end_text:langUtil.Global_endPage,prev_text:langUtil.Global_prePage,next_text:langUtil.Global_nextPage,num_edge_entries:1,num_display_entries:6,callback:pageselectCallback,items_per_page:pageNum})}();function pageselectCallback(page_index,jq){var max_elem=Math.min((page_index+1)*pageNum,num);var resDom=$("#searchRes_"+mdId).find(".resList_box");resDom.html("");if(num){for(var i=page_index*pageNum;i<max_elem;i++){var new_content=$("#Pagination_"+mdId+" .h_searchAllData .resList_box li:eq("+i+")").clone();resDom.append(new_content)}}else{var con=$("#Pagination_"+mdId+" .h_searchAllData .resList_box").html();resDom.append(con)}return false}if(num){$("#Pagination_"+mdId).show()}else{$("#Pagination_"+mdId).hide()}})}};webUtil.setResListWidth=function(mdId,saleMode){if(saleMode==1){var seaW=$("#networkSale_"+mdId+" .f_searchBox .searchRes").width();var itemW=(seaW-20)/3+"px";$("#networkSale_"+mdId+" .f_searchBox .j_setResW").css({width:itemW})}};webUtil.setNetworkFunc=function(mdId,saleMode,pageNum,netWord,dotListMode,province,city){$("#networkSale_"+mdId+" .search_keyword").val(netWord);var allData=$("#result_"+mdId).text();var Data=eval(allData);webUtil.setEchartsMap(mdId,Data,saleMode,pageNum,province);var proDom=$("#networkSale_"+mdId+" .search_area").find("select[name='area-province']");var cityDom=$("#networkSale_"+mdId+" .search_area").find("select[name='area-city']");webUtil.changeSelPro(mdId,Data,proDom,1,saleMode,pageNum);webUtil.changeSelPro(mdId,Data,cityDom,2,saleMode,pageNum);if(dotListMode==1){webUtil.selectCity(proDom,cityDom,province,city)}else{webUtil.selectCity(proDom,cityDom)}$("#networkSale_"+mdId+" .search_btn").click(function(){webUtil.searchByKeywork(mdId,Data,saleMode,pageNum);webUtil.setProVal(proDom,"请选择",2,cityDom)})};webUtil.searchSubmit=function(mdId,searchTip,searchBoxObj){var curSearchDom=$("#searchForm_"+mdId),isNewComp=searchBoxObj&&searchBoxObj.isNewComp===true?true:false,jumpSearchType="0_1",kwLiDom=$("#keywords_"+mdId+" .keywordJquery li");curSearchDom.attr("method","get");if(curSearchDom.find("[name=keyword]").length===0){curSearchDom.append('<input type="hidden" name="keyword"/>')}if(curSearchDom.find("[name=type]").length===0){curSearchDom.append('<input type="hidden" name="type"/>')}if(isNewComp){curSearchDom.find("[name=type]").val("0_1")}else if(searchBoxObj&&searchBoxObj.searchRange!==undefined){curSearchDom.find("[name=type]").val(searchBoxObj.searchRange);jumpSearchType=searchBoxObj.searchRange}else{curSearchDom.find("[name=type]").val("0");jumpSearchType="0"}var setReturnPage=function setReturnPage(){sessionStorage.setItem("searchReturnPage",window.location.href)};kwLiDom.children("a").each(function(i,item){var linkAHref=$(item).attr("href");if(linkAHref.indexOf("search.html")===-1){var linkAKW=$(item).attr("data-kw");$(item).attr("href","search.html?type="+jumpSearchType+"&keyword="+linkAKW)}$(item).on("click",function(){setReturnPage()})});$("#searchForm_"+mdId+" .leftInput").bind("input propertychange",function(){var thisVal=$(this).val();$("#searchForm_"+mdId+" input[name=wjs]").val('{sk:"'+thisVal+'"}');setReturnPage();$("#searchForm_"+mdId+" input[name='keyword']").val(thisVal)});$("#search_"+mdId).click(function(event){searchSubmit(event)});$("#searchForm_"+mdId).keydown(function(event){var theEvent=event||window.event;var code=theEvent.keyCode||theEvent.which||theEvent.charCode;if(code==13){searchSubmit(event)}});function searchSubmit(event){var leftInput=$("#searchForm_"+mdId+" .leftInput").val();if($("body").hasClass("edit")){webUtil.showTip("当前为编辑状态，不能进行操作");event.preventDefault();return false}else{if(leftInput!=""&&leftInput!=searchTip){sessionStorage.setItem("searchReturnPage",window.location.href);$("#searchForm_"+mdId+" input[name='keyword']").val(leftInput);$("#searchForm_"+mdId+" input[name=wjs]").remove();$("#searchForm_"+mdId).submit()}else{webUtil.showTip(langUtil.wPro_search+langUtil.noEmpty);event.preventDefault();return false}}}};webUtil.setPage=function(mdId,showPageMode,dataLength,showCount){if(showPageMode=="1"){require(["jquery.Mpagination"],function(){var initPagination=function(){$("#"+mdId+" .pagination").pagination(dataLength,{first_text:langUtil.Global_first,end_text:langUtil.Global_endPage,prev_text:langUtil.Global_prePage,next_text:langUtil.Global_nextPage,num_edge_entries:1,num_display_entries:6,callback:pageselectCallback,items_per_page:showCount})}();function pageselectCallback(page_index,jq){var max_elem=Math.min((page_index+1)*showCount,dataLength);var dataListDom=$("#"+mdId+" .eBookListContent");dataListDom.html("");for(var i=page_index*showCount;i<max_elem;i++){var new_content=$("#"+mdId+" .Searchresult li:eq("+i+")").clone();dataListDom.append(new_content)}return false}})}webUtil.setImageFit("#"+mdId+" .eBookImg")};require(["jquery","wow"],function($){if(!$("body").hasClass("edit")){var animatedWow=new WOW({boxClass:"has_wow",animateClass:"animated",offset:0,mobile:true,live:true,scrollContainer:window});animatedWow.init()}});if(typeof toastr=="undefined"){var toastr={}}toastr.clear=function(){var $dom=$("#webupload_tip");$dom.remove()};toastr.error=function(tip){webUtil.showTip(tip)};webUtil.getFwIsNeedPhone=function(){var isNeedPhone="";var defer=$.Deferred();$.ajax({url:"/w/product/getIsNeedPhoneCheck.do",type:"GET",async:false,success:function success(data){if(data.result=="SUCCESS"){isNeedPhone=data.data.isNeedPhone;defer.resolve(isNeedPhone)}else{data.data===null?"":webUtil.showTip(data.errorMsg.msg,1.5)}}});return defer.promise()};webUtil.getQueryCode=function(mdId,type){var originType=type||0;$("#"+mdId+" .queryCodeFrom").find(".fwPhone,.fwCheckCode,input[name=fw-pc-code]").bind("input propertychange",function(){$("#fwSubmit_"+mdId).removeClass("disabled")});require(["jquery.cookie"],function(){$.when(webUtil.getFwIsNeedPhone()).done(function(isNeedPhone){if(isNeedPhone=="1"){$("#"+mdId+" .queryCodeFrom").find(".fwPhone,.fwCheckCode").show();$("#"+mdId+" .queryCodeFrom input[name=fw-pc-code]").bind("input propertychange",function(){var qCode=$("#"+mdId+" .queryCodeFrom input[name=fw-pc-code]").val();var fwCookie=false;if($.cookie("fwCookie")){fwCookie=JSON.parse($.cookie("fwCookie"))}if(fwCookie&&fwCookie.codeShow==qCode&&fwCookie.fwType==originType){$("#"+mdId+" .queryCodeFrom").find(".fwPhone,.fwCheckCode").hide()}else{$("#"+mdId+" .queryCodeFrom").find(".fwPhone,.fwCheckCode").show()}})}else{$("#"+mdId+" .queryCodeFrom").find(".fwPhone,.fwCheckCode").hide()}$("#"+mdId+" #fwSubmit_"+mdId).on("click",function(e){if($("body").hasClass("edit")){webUtil.showTip("当前为编辑状态，不能进行操作");return false}else{var qCode=$("#"+mdId+" input[name=fw-pc-code]").val();if(!qCode){webUtil.showTip("请先输入防伪码");return false}else{if(isNeedPhone=="1"){var fwCookie=false;if($.cookie("fwCookie")){fwCookie=JSON.parse($.cookie("fwCookie"))}if(fwCookie&&fwCookie.codeShow==qCode&&fwCookie.fwType==originType){$("#"+mdId+" .queryCodeFrom").find(".fwPhone,.fwCheckCode").hide();var dataInfo={};dataInfo["phone"]=fwCookie.fwPhone;dataInfo["checkCode"]=fwCookie.fwCode;webUtil.getProductDetail(mdId,2,originType,dataInfo)}else{var fwPhone=$("#"+mdId+" input[name=fw-pc-phone]").val().trim(),fwCode=$("#"+mdId+" input[name=fw-pc-checkCode]").val().trim();var reg=/^((13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8})$/,reg1=new RegExp(/^\d{4}$/);if(fwPhone==""||reg.test(fwPhone)==false){webUtil.showTip("请输入正确的手机号码","2");return}if(fwCode==""||reg1.test(fwCode)==false){webUtil.showTip("请确保验证码输入正确","2");return}var cData={phone:fwPhone,checkCode:fwCode,codeShow:qCode};$.ajax({type:"POST",url:"/w/product/checkPhoneCode.do",data:cData,dataType:"json",success:function success(checkRes){if(checkRes.result=="SUCCESS"){webUtil.getProductDetail(mdId,1,originType)}else{webUtil.showTip("查询失败，请核对您的验证码","2")}}})}}else{webUtil.getProductDetail(mdId,0,originType)}}}})})})};webUtil.getProductDetail=function(mdId,type,originType,cookieData){var originType=originType||0;$("#"+mdId).find("input[name=fw-pc-code],input[name=fw-pc-phone],input[name=fw-pc-checkCode],.pc-checkCode,.submit").addClass("disabled");var Fwdata=cookieData||{};Fwdata["codeShow"]=$("#"+mdId+" input[name=fw-pc-code]").val();if(type=="1"){Fwdata["phone"]=$("#"+mdId+" input[name=fw-pc-phone]").val();Fwdata["checkCode"]=$("#"+mdId+" input[name=fw-pc-checkCode]").val()}require(["jquery","async!BMap"],function($){var geolocation=new BMap.Geolocation;geolocation.getCurrentPosition(function(r){if(this.getStatus()==BMAP_STATUS_SUCCESS){ProductOrigin(mdId,r.point.lng,r.point.lat,Fwdata)}else{webUtil.showTip("获取经纬度失败，"+this.getStatus(),"2");ProductOrigin(mdId,"","",Fwdata)}})});if(originType==1){var _ProductOrigin=function _ProductOrigin(mdId,lng,lat,dataInfo){$.when(webUtil.commonThird("getShop","fw",dataInfo)).done(function(res){if(res.result=="SUCCESS"){var fwProData=res.data;if(type=="1"){$.cookie("fwCookie","",{expires:-1});var fwCookie=JSON.stringify({fwPhone:Fwdata.phone,fwCode:Fwdata.checkCode,codeShow:Fwdata.codeShow,fwType:originType});$.cookie("fwCookie",fwCookie,{expires:1})}var html="";$("#"+mdId+" .queryCodeResult").remove();html+='<div class="queryCodeResult">';html+="<p><span>完成操作！</span></p>";html+="<ul>";html+='<li class="rTitle">门店信息</li>';html+="<li>门店编号：<span>"+fwProData.productNo+"</span></li>";html+="<li>门店防伪码：<span>"+fwProData.codeShow+"</span></li>";html+="<li>门店名称：<span>"+fwProData.productName+"</span></li>";if(fwProData.productDesc){html+="<li>门店地址：<span>"+fwProData.productDesc.split("||")[0]+"</span></li>";html+="<li>联系方式：<span>"+fwProData.productDesc.split("||")[1]+"</span></li>";html+="<li>门店介绍：<span>"+fwProData.productDesc.split("||")[2]+"</span></li>"}html+='</ul><div id="storeDistance">查询结果：<span></span></div><div id="fwBMapwrapperStore"></div><div class="rBack"><span class="icon iconfont kenfor-icons-upward1"></span></div></div>';var addrData=[{lng:fwProData.shopLng,lat:fwProData.shopLat,labelTxt:fwProData.productName},{lng:lng,lat:lat,labelTxt:"我的位置"}];dataUtil.renderBMapNew("fwBMapwrapperStore",addrData);$("#fwBMapwrapperStore label").css({"max-width":"auto!important"});$("#"+mdId+" .queryCodeFrom").append(html);$("#"+mdId+" .pc-checkCode").text("发送验证码");$("#"+mdId+" .pc-checkCode").addClass("lock");$("#"+mdId+" .queryCodeResult").fadeIn();$("#"+mdId+" .queryCodeResult .rBack").on("click",function(){$("#"+mdId+" .queryCodeResult").hide().remove();if(window.Timer){clearInterval(Timer)}$("#"+mdId+" .pc-checkCode").removeClass("lock");$("#"+mdId).find("input[name=fw-pc-code],input[name=fw-pc-phone],input[name=fw-pc-checkCode],.pc-checkCode,.submit").removeClass("disabled")})}else{$("#"+mdId).find("input[name=fw-pc-code],input[name=fw-pc-phone],input[name=fw-pc-checkCode],.pc-checkCode,.submit").removeClass("disabled");if(res.errorMsg.errmsg){webUtil.showTip("查询失败，"+res.errorMsg.errmsg,"2")}else{webUtil.showTip("查询失败，请核对您的防伪码","2")}}})}}else{var _ProductOrigin2=function _ProductOrigin2(mdId,lng,lat,dataInfo){dataInfo["lng"]=lng;dataInfo["lat"]=lat;$.ajax({type:"POST",url:"/w/product/infoProductOriginResult.do",data:dataInfo,dataType:"json",success:function success(res){console.log(res);if(res.result=="SUCCESS"&&res.data.codeShow){var fwProData=res.data;if(type=="1"){$.cookie("fwCookie","",{expires:-1});var fwCookie=JSON.stringify({fwPhone:Fwdata.phone,fwCode:Fwdata.checkCode,codeShow:Fwdata.codeShow,fwType:originType});$.cookie("fwCookie",fwCookie,{expires:1})}var html="";$("#"+mdId+" .queryCodeResult").remove();html+='<div class="queryCodeResult">';html+="<p><span>完成操作！</span></p>";html+="<ul>";html+='<li class="rTitle">电商信息</li>';html+="<li>电商编号：<span>"+fwProData.no+"</span></li>";html+="<li>电商名称：<span>"+fwProData.name+"</span></li>";html+="<li>电商防伪码：<span>"+fwProData.codeShow+"</span></li>";html+='<li class="rTitle">追踪溯源</li>';html+='<li class="rCount">查询次数：<span>'+fwProData.queryCount+"</span></li>";html+="<li>最后鉴定时间：<span>"+fwProData.lastQueryDate+"</span></li><li>最后查询地：</li>";html+='</ul><div id="fwBMapContainer"></div><div class="rBack"><span class="icon iconfont kenfor-icons-upward1"></span></div></div>';dataUtil.renderBMap("fwBMapContainer",fwProData.lng,fwProData.lat);$("#"+mdId+" .queryCodeFrom").append(html);$("#"+mdId+" .pc-checkCode").text("发送验证码");$("#"+mdId+" .pc-checkCode").addClass("lock");$("#"+mdId+" .queryCodeResult").fadeIn();$("#"+mdId+" .queryCodeResult .rBack").on("click",function(){$("#"+mdId+" .queryCodeResult").hide().remove();if(window.Timer){clearInterval(Timer)}$("#"+mdId+" .pc-checkCode").removeClass("lock");$("#"+mdId).find("input[name=fw-pc-code],input[name=fw-pc-phone],input[name=fw-pc-checkCode],.pc-checkCode,.submit").removeClass("disabled")})}else{$("#"+mdId).find("input[name=fw-pc-code],input[name=fw-pc-phone],input[name=fw-pc-checkCode],.pc-checkCode,.submit").removeClass("disabled");if(res.errorMsg.errmsg){webUtil.showTip("查询失败，"+res.errorMsg.errmsg,"2")}else{webUtil.showTip("查询失败，请核对您的防伪码","2")}}}})}}};webUtil.getFwCode=function(type,phoneID,codeID){if($("body").hasClass("edit")){webUtil.showTip("当前为编辑状态，不可操作")}else{var memberId=window.memberId_center.mid||"";if(type=="reser"){if(phoneID){var fwPhone=$("#"+phoneID).val().trim()}else{var fwPhone=$("input[name=reserPhone]").val().trim()}}else{var fwPhone=$("input[name=fw-pc-phone]").val().trim()}var reg=/^((13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8})$/;if(fwPhone==""||reg.test(fwPhone)==false){webUtil.showTip("请输入正确的手机号码","2");return}else{if(type=="reser"){webUtil.setInterval(0,type,codeID)}else{webUtil.setInterval(0)}$.when(dataUtil.commonThirdRpc("commitValidateCodeMsg","booking",{memberId:memberId,phone:fwPhone})).done(function(res){if(res.result=="SUCCESS"){if(type=="reser"){webUtil.setInterval(1,type,codeID)}else{webUtil.setInterval(1)}}else{var tips=res.errorMsg.reason||res.errorMsg.errorMsg;if(type=="reser"){webUtil.setInterval("",type,codeID)}else{webUtil.setInterval()}webUtil.showTip(tips,"2")}})}}};webUtil.setInterval=function(state,type,codeID){var _this=$(".fw-timer-button");if(type=="reser"){if(codeID){_this=$("#"+codeID)}else{_this=$(".sendCode-text")}}if(state==0){if(!_this.hasClass("fw-disable")){_this.addClass("fw-disable")}_this.text("正在发送...")}else if(state==1){webUtil.showTip("短信已发出，请注意查收","2");_this.text("90秒");var i=89;window.Timer=setInterval(function(){var tickText="";if(i>=10){tickText=i+"秒"}else{tickText="0"+i+"秒"}_this.text(tickText);i--;if(i<0){_this.text("发送验证码");_this.removeClass("fw-disable");clearInterval(Timer)}},1e3)}else if(state==2){_this.text("发送验证码");_this.removeClass("fw-disable");if(window.Timer){clearInterval(window.Timer)}}else{_this.text("发送验证码");_this.removeClass("fw-disable")}};webUtil.setListBooksPage=function(mdId,num_entries,showCount,pageNum,rowWidth,showDisMode){require(["jquery.Mpagination"],function(){$("#Pagination_"+mdId).pagination(num_entries,{first_text:langUtil.Global_first,end_text:langUtil.Global_endPage,prev_text:langUtil.Global_prePage,next_text:langUtil.Global_nextPage,num_edge_entries:1,num_display_entries:6,callback:pageselectCallback,items_per_page:showCount});function pageselectCallback(page_index,jq){var max_elem=Math.min((page_index+1)*showCount,num_entries);$("#bookList_"+mdId).html("");for(var i=page_index*showCount;i<max_elem;i++){var resultId=$("#result_"+mdId).children("li").eq(i);var resultHtml="";var data_img=resultId.data("img");var data_name=resultId.data("name");var data_bvrid=resultId.data("bvrid");var hrefValue="displaybook.html?from=fancybox&id="+data_bvrid;if(showDisMode==2){hrefValue="javascript:void(0);"}resultHtml+='<li class="books_li" data-bvrid="'+data_bvrid+'"  style="height:auto;width:'+rowWidth+';">'+'<a  target="_blank" href="'+hrefValue+'" class="books_link" title="'+data_name+'">'+'<div class="typeImg" ><img src="'+data_img+'"></div>'+'<div class="typeName">'+data_name+"</div>"+"</a>"+"</li>";$(resultHtml).appendTo($("#bookList_"+mdId))}webUtil.disBooks(mdId,showDisMode);webUtil.toBooks(mdId)}})};webUtil.setBooksEffect=function(mdId,pageNum,opp,delayTime,autoPlay,scroll,interTime,styleMode){autoPlay=window.WebModel=="edit"?false:autoPlay;require(["SuperSlide"],function(){var con_w=$("#books_"+mdId+" .photoListContainer").width();var list_w=$("#books_"+mdId+" .booksBox_view").width();if(list_w<=con_w){var box_w=($("#books_"+mdId+" .photoListContainer").width()-100)/pageNum;$("#bookList_"+mdId+" li.typeImg").css({width:box_w})}var $parentBox=$("#books_"+mdId+" .scroll_list");if($parentBox.children("div").hasClass("tempWrap")){var tempHtml=$parentBox.children("div.tempWrap").html();$parentBox.html(tempHtml)}if(styleMode==1){$("#books_"+mdId+" .listPhotoPanel2").slide({titCell:"listPhotoPanel2 ul",mainCell:".scroll_list ul",effect:"left",easing:"swing",opp:opp,delayTime:delayTime,autoPlay:autoPlay,vis:pageNum,pnLoop:false,scroll:scroll,autoPage:true})}else if(styleMode==2){var SM2AutoPlay=window.WebModel=="edit"?false:true;if(!$("body").hasClass("edit")){$("#books_"+mdId+" .bookList").find(".clone").remove()}$("#books_"+mdId+" .listPhotoPanel3").slide({mainCell:"ul",effect:"leftMarquee",opp:opp,vis:pageNum,autoPlay:SM2AutoPlay,interTime:interTime,switchLoad:"_src"})}webUtil.toBooks(mdId)})};webUtil.toBooks=function(mdId){webUtil.setImageFit("#books_"+mdId+" .typeImg",mdId);if(WebModel=="edit"){$("#books_"+mdId+" a.books_link").on("click",function(e){webUtil.showTip("编辑状态，无法操作");return false})}};webUtil.setBooksList=function(mdId){var $dom=$("#books_"+mdId+" .booksBox_view");var config=eval("("+$dom.data("config")+")");if(config.styleMode==0){if(config.showMode==0&&config.nums>0){webUtil.setListBooksPage(mdId,config.nums,config.showCount,config.pageNum,config.rowWidth,config.showDisMode)}}else{webUtil.setBooksEffect(mdId,config.pageNum,config.opp,config.delayTime,config.autoPlay,config.scroll,config.interTime,config.styleMode)}webUtil.toBooks(mdId)};webUtil.disBooks=function(mdId,showDisMode){if(showDisMode==1){require(["fancyJs"],function(){$("#bookList_"+mdId+" .books_link").fancybox({type:"iframe",width:"96%",height:"96%",helpers:{overlay:true,title:false},openEffect:"elastic",closeEffect:"elastic"})})}else{$("#bookList_"+mdId+" .books_li").on("click",function(){var id=$(this).data("bvrid");$("#object_"+mdId+" .object").html('<object type="text/html" data="displaybook.html?from=fancybox&id='+id+'" width="100%" height="600px"></object>');$(this).parents(".scroll_list").hide();$("#Pagination_"+mdId).hide();$("#object_"+mdId).find(".object").addClass("open");$("#object_"+mdId+" .close_books").fadeIn(2500);$("#object_"+mdId+" .close_books").on("click",function(){$(this).parents("#object_"+mdId).find(".object").removeClass("open");$("#bookList_"+mdId+" .books_li").parents(".scroll_list").show();$(this).hide();$("#Pagination_"+mdId).show()})})}};webUtil.commonThirdRpc=function(apicode,syscode,params){var apicode=apicode||"",syscode=syscode||"yy",params=params||"";var defer=$.Deferred();var yyParams={};apicode==""?"":yyParams.apicode=apicode;syscode==""?"":yyParams.syscode=syscode;params==""?"":yyParams.params=JSON.stringify(params);$.ajax({url:"/w/thirdSys/commonThirdRpc.do",xhrFields:{withCredentials:true},crossDomain:true,type:"POST",data:yyParams,success:function success(data){if(data.result=="SUCCESS"){defer.resolve(data)}else{if(apicode=="getShop"||apicode=="getShopById"){defer.resolve(data)}else{var tips=data.errorMsg&&data.errorMsg.errorMsg?data.errorMsg.errorMsg:"获取数据失败";webUtil.showTip(tips,1.5)}}}});return defer.promise()};webUtil.commonThird=function(apicode,syscode,params){var apicode=apicode||"",syscode=syscode||"yy",params=params||"";var defer=$.Deferred();var yyParams={};apicode==""?"":yyParams.apicode=apicode;syscode==""?"":yyParams.syscode=syscode;params==""?"":yyParams.params=JSON.stringify(params);$.ajax({url:"/w/thirdSys/commonThird.do",type:"POST",data:yyParams,success:function success(data){if(data.result=="SUCCESS"){defer.resolve(data)}else{if(apicode=="getShop"||apicode=="getShopById"){defer.resolve(data)}else{var tips=data.errorMsg&&data.errorMsg.errorMsg?data.errorMsg.errorMsg:"获取数据失败";webUtil.showTip(tips,1.5)}}}});return defer.promise()};var tempTime=[];webUtil.getProjectList=function(pID,mdId,flag,params){var bEvent2=function bEvent2(){$(mId+" .clickDetail,"+mId+" .clickDetail_only").on("click",function(e){if($("body").hasClass("edit")){webUtil.showTip("编辑状态不可点击","1")}else{var $el=$(e.currentTarget).hasClass("clickDetail_only")?$(e.currentTarget).parent():$(e.currentTarget);webUtil.getListBooking($el.data("code"),$el.data("class"),mdId)}})};var bEvent1=function bEvent1(){$(".reser_icon").on("click",function(e){if($("body").hasClass("edit")){webUtil.showTip("编辑状态不可点击","1")}else{if($("#yyBMapwrapper").length>0){$("#yyBMapwrapper").remove()}else{var el=$(e.currentTarget);var txt=el.find("input").val();var lng=el.data("lng");var lat=el.data("lat");$("#yyBMapwrapper").remove();el.parents(".reser_list_li").find("ul").append('<li id="yyBMapwrapper"><div id="yyMapWrap"></div><div id="mapIcon" class="icon iconfont kenfor-icons-upward1"></div></li>');$("#yyBMapwrapper").css("margin-top","10px");webUtil.renderBMap("yyMapWrap",lng,lat,txt);$("#mapIcon").on("click",function(){$("#yyBMapwrapper").remove()})}}e.stopPropagation()})};var html="";if(mdId){var mId="#"+mdId}else{var mId=""}var total=0,showPageMode=params.status,showCount=params.amount,showDesc=params.showDesc;$.when(webUtil.commonThird("listMemberProject","yy")).done(function(data){if(flag=="1"){$.each(data.data,function(i,item){if(item.projectId==pID){html+='<div data-class="'+item.projectClass+'" data-id="'+item.projectId+'" data-code="'+item.projectCode+'"><a class="clickDetail_only win_background_color"><span>预约服务</span></a></div>'}});$(mId+" .reser_list").html(html)}else{html="";$.each(data.data,function(i,item){if(pID&&pID.indexOf(String(item.projectId))!=-1){var timeType=item.eventDurationUnitType==1?"分钟":"小时";var lng=item.eventLongitude,lat=item.eventLatitude,labelTxt=item.eventLocation;var projectDescription=item.projectDescription?item.projectDescription:"";var mapHtml="",aClass="";if(lng&&lat){mapHtml='<li class="reser_icon icon iconfont kenfor-icons-sc-Other7" data-lng="'+lng+'" data-lat="'+lat+'"><input type="hidden" value="'+labelTxt+'"></li>'}else{aClass="all"}if(params.showRowNum!=1&&total!=0&&total%params.showRowNum==0){var clearHtml='<div class="clearfix"></div>',clearStyle='style="margin-left:0px;"'}else{var clearHtml=clearStyle=""}total==0?clearStyle='style="margin-left:0px;"':"";html+=clearHtml+'<div class="reser_list_li clickDetail" data-class="'+item.projectClass+'" data-id="'+item.projectId+'" data-code="'+item.projectCode+'" '+clearStyle+">";html+="<ul>";html+='<li class="reser_title">'+item.projectName+"</li>";html+="<li>"+item.resourcesNum+"个服务人员</li>";html+="<li>服务时长"+item.eventDurationValue+timeType+"</li>";if(showDesc==1){html+='<li class="reser_desc">'+item.projectDescription+"</li>"}html+=mapHtml+"</ul>";html+="</div>";total=total+1}});if(params.status=="1"){$(mId+" .reser_list").html(html)}else{$(mId+" .reser_list").html(html)}bEvent1()}bEvent2()})};webUtil.getListBooking=function(code,type,mdId){var proType=type||"01",portName=proType=="01"?"listProjectABooking":"listProjectABookingMany";var params={projectCode:code};if(proType=="01"){$.when(webUtil.commonThird(portName,"yy",params),webUtil.commonThird("queryMsgCheck","yy")).done(function(data,data1){var tempData=data.data;console.log(tempData);if(tempData.dateList.length>0){var minDay=tempData.dateList[0].date+" 00:00:00";var maxDay=tempData.dateList[tempData.dateList.length-1].date+" 23:59:59";var lng=tempData.eventLongitude,lat=tempData.eventLatitude,labelTxt=tempData.eventLocation;tempTime=tempData.dateList;var html="";html+='<div class="windowPop_true"><input id="msgCheck" type="hidden" value="'+data1.data.msgCheck+'"><input id="projectCode" type="hidden" value="'+code+'"><input id="selectResourcesWay" type="hidden" value="'+tempData.selectResourcesWay+'"><input id="eventDuration" type="hidden" value="'+tempData.eventDuration+'"><input id="projectName" type="hidden" value="'+tempData.projectName+'">';html+='<div class="windowPop_close"><span>在线预约服务</span><i class="icon iconfont kenfor-icons-off1"></i> </div><div class="windowPop_content win_scroll"><div class="setInfo_title">预约信息</div><ul class="windowPop_layout">';html+='<li class="setInfo_name"><span class="win_color">'+tempData.projectName+"</span>"+tempData.projectDescription+"</li>";html+='<li id="showLaydate" class="setInfo_list"><label>选择日期和时间</label><p class="re_select"><span id="bookingDay"></span><span id="bookingTime" data-endtime=""></span><i onclick="laydate({elem:\'#bookingDay\',start: \''+minDay+"',min: '"+minDay+"', max:'"+maxDay+'\'})" class="win_color">修改日期</i></p></li>';html+='<li class="setInfo_list" onclick="webUtil.layService(this)"><label>服务人员(可选)</label><p class="re_select"><span id="staffName" data-id="">未指定</span></p></li>';html+="</ul>";html+='<div class="setInfo_title">客户信息</div><ul class="windowPop_layout">';html+='<li class="setInfo_list"><label>姓名</label><input class="enterInput" type="text" placeholder="姓名" name="re_info"></li>';html+='<li class="setInfo_list"><label>手机号码</label><input class="enterInput" type="tel" placeholder="手机号码" name="re_phone" id="re_phone"></li>';if(data1.data.msgCheck==1){html+='<li class="setInfo_list"><label>验证码</label><input class="enterInput" type="tel" placeholder="验证码" name="re_code"><i class="v_code win_color win_border_color" id="v_code">发送验证码</i></li>'}html+="</ul>";html+='<div class="setInfo_title">预约留言</div>';html+='<textarea class="remark" id="re_remark" placeholder="有其他备注请留言"></textarea>';html+="</div>";html+='<div class="windowPop_bottom win_background_color" onclick="webUtil.saveData()"><span>提交预约</span></div>';html+="</div>";if($("#windowPop").length>0){$("#windowPop .windowPop_body").append(html)}else{$("body").append('<div id="windowPop"><div class="windowPop_body">'+html+"</div></div>")}$("#windowPop").show();$("body").addClass("only_"+mdId);if(lng&&lat){$("#windowPop .windowPop_content").append('<div id="yyBMapwrapper"><div id="yyMapWrap"></div></div>');webUtil.renderBMap("yyMapWrap",lng,lat,labelTxt)}$(".windowPop_body,#laydate_box_web").on("click",function(e){e.stopPropagation()});$(".windowPop_close i").on("click",function(){webUtil.hiddenPop();$("body").removeClass("only_"+mdId)});$("#windowPop .v_code").on("click",function(){webUtil.getFwCode("reser","re_phone","v_code")})}else{webUtil.showTip("预约已满","2")}})}else{webUtil.showTip("暂时不支持一对N服务","2")}};webUtil.hiddenPop=function(){$("#windowPop").hide();$("#windowPop .windowPop_true").remove()};webUtil.hiddenDesign=function(){$("#web_design_main").hide()};webUtil.layService=function(e){var $date=$("#bookingDay").html();var $time=$("#bookingTime").html();if($time&&!($date==""||$date=="未指定")){var html="",$staff=$("#staffName");html+='<div class="reservation_staff"><div class="staff_list"><div class="laytime_title">选择服务人员<span><i class="icon iconfont kenfor-icons-off1"></i></span></div><ul class="win_scroll">';var date1=new Date($date);$.each(tempTime,function(i,item){var date2=new Date(item.date);if(date1.getTime()==date2.getTime()){$.each(item.bookingList,function(j,time){var t1=$date+" "+time.s,t2=$date+$time;if(new Date(t1.replace(/-/g,"/")).getTime()==new Date(t2.replace(/-/g,"/")).getTime()){$.each(time.l,function(k,staff){var t3=$date+" "+time.s;if(new Date(t3.replace(/-/g,"/")).getTime()==new Date(t2.replace(/-/g,"/")).getTime()){var cName=$staff.html()==staff.n?"staff_click":"";html+='<li class="'+cName+'" data-id="'+staff.i+'"><span>'+staff.n+"</span></li>"}})}})}});html+='</ul><div class="staff_bottom win_background_color">确认</div></div></div></div>';$(e).append(html);$(".staff_list ul li").on("click",function(){$(".staff_list ul li").removeClass("staff_click");$(this).removeClass("staff_click").addClass("staff_click");$staff.html($(this).find("span").html());$staff.attr("data-id",$(this).attr("data-id"))});$(".staff_bottom,.staff_list ul li").on("click",function(e){var temp=$(e.currentTarget).parent().find(".staff_click");if(temp.length>0){$staff.html(temp.find("span").html());$staff.attr("data-id",temp.attr("data-id"))}else{$staff.html($(".staff_list .staff_click span").html());$staff.attr("data-id",$(".staff_list .staff_click").attr("data-id"))}$(".reservation_staff").remove();e.stopPropagation()});$(".laytime_title span").on("click",function(e){$(".reservation_staff").remove();e.stopPropagation()})}else{webUtil.showTip("请选择时间","1")}};webUtil.layTime=function(){var $dom=$("#laydate_table .laydate_click");var $obj=$("#laydate_time_define span");if($dom.length>0&&!$dom.hasClass("laydate_void")){var html="";html+='<div class="laytime"><div class="laytime_title">选择预定时间<span onclick="webUtil.hideLayTime()"><i class="icon iconfont kenfor-icons-off1"></i></span></div><ul class="">';console.log(tempTime);var m=$dom.attr("m")<10?"0"+$dom.attr("m"):$dom.attr("m"),d=$dom.attr("d")<10?"0"+$dom.attr("d"):$dom.attr("d");var date=$dom.attr("y")+"-"+m+"-"+d;var date1=new Date(date);$.each(tempTime,function(i,item){var date2=new Date(item.date);if(date1.getTime()==date2.getTime()){$.each(item.bookingList,function(j,time){var cName=$obj.html()==time.s?"laydate_time_click":"";html+='<li class="'+cName+'"><span data-people="'+time.l[0].i+'" data-name="'+time.l[0].n+'" data-endtime="'+time.e+'">'+time.s+"</span></li>"})}});html+='</ul><div class="laytime_bottom win_background_color">确认</div></div> </div>';$(".laydate_body #laydate_box_web").append(html);$(".laytime ul li").on("click",function(){$(".laytime ul li").removeClass("laydate_time_click");$(this).removeClass("laydate_time_click").addClass("laydate_time_click");$obj.html($(this).find("span").html());$obj.attr("data-endtime",$(this).find("span").attr("data-endtime"));$obj.attr("data-people",$(this).find("span").attr("data-people"));$obj.attr("data-name",$(this).find("span").attr("data-name"))});$(".laytime_bottom,.laytime ul li").on("click",function(e){var temp=$(e.currentTarget).find(".laydate_time_click");if(temp.length>0){$obj.html(temp.find("span").html());$obj.attr("data-endtime",temp.find("span").attr("data-endtime"));$obj.attr("data-people",temp.find("span").attr("data-people"));$obj.attr("data-name",temp.find("span").attr("data-name"))}else{var $el=$("#laydate_table .laydate_time_click");$obj.html($dom.find("span").html());$obj.attr("data-endtime",$el.find("span").attr("data-endtime"));$obj.attr("data-people",$el.find("span").attr("data-people"));$obj.attr("data-name",$el.find("span").attr("data-name"))}webUtil.hideLayTime()});$(".laytime").siblings().hide()}};webUtil.hideLayTime=function(){webUtil.clickOk();$(".laytime").siblings().show();$(".laytime").remove()};webUtil.clickOk=function(){var $el=$("#laydate_time_define span");if($el.html()==""||$el.html()=="未指定"){$("#laydate_ok").addClass("disable");$("#staffName").html("未指定");$("#staffName").attr("data-id","");$("#bookingTime").html("");$("#bookingTime").attr("data-endtime","");return false}else{$("#laydate_ok").removeClass("disable");$("#staffName").html($el.attr("data-name"));$("#staffName").attr("data-id",$el.attr("data-people"))}};webUtil.saveData=function(){$(".windowPop_bottom").removeClass("yy-disable").addClass("yy-disable");var $day=$("#bookingDay"),$time=$("#bookingTime");var $projectCode=$("#projectCode").val(),$projectName=$("#projectName").val(),$bookingName=$("input[name=re_info]").length>0?$("input[name=re_info]").val().trim():'$("input[name=re_info]").val()',$bookingComment=$("#re_remark").val(),$resouresId=$("#staffName").attr("data-id"),$msgCheck=$("#msgCheck").val(),$bookingMobile=$("input[name=re_phone]").length>0?$("input[name=re_phone]").val().trim():'$("input[name=re_phone]").val()',$phoneCode=$("input[name=re_code]").length>0?$("input[name=re_code]").val().trim():"",$bookingStartTime=$day.html()+$time.html(),$bookingEndTime=$day.html()+" "+$time.attr("data-endtime");var reg=/^((13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8})$/,reg1=new RegExp(/^\d{4}$/);$.when(webUtil.commonThird("queryMsgCheck","yy")).done(function(data){if($msgCheck==1){$phoneCode=$("input[name=re_code]").val()}var errorTip=function errorTip(tips){webUtil.showTip(tips,"1","",1);$(".windowPop_bottom").removeClass("yy-disable");return false};if($day.html()==""||$day.html()=="未指定"||$time.html()==""){errorTip("请选择日期和时间")}else if($resouresId==""||$resouresId=="未指定"){errorTip("请选择服务人员")}else if($bookingName==""){errorTip("请输入姓名")}else if($bookingMobile==""||reg.test($bookingMobile)==false){errorTip("请输入正确的手机号码")}else if($msgCheck==1&&($phoneCode==""||reg1.test($phoneCode)==false)){errorTip("请确保验证码输入正确")}else{var $dom=$(".windowPop_body");$dom.css({padding:"0px"});$(".windowPop_true").hide();var html="";html+='<div class="windowPop_repeat"><ul>';$projectName;html+="<li><span>项目名称</span>"+$projectName+"</li>";html+="<li><span>预约时间</span>"+$bookingStartTime+" - "+$time.attr("data-endtime")+"</li>";html+="<li><span>姓名</span>"+$bookingName+"</li>";html+="<li><span>手机号码</span>"+$bookingMobile+"</li>";html+="<li><span>留言</span>"+$bookingComment+"</li>";html+='</ul><div  class="windowPop_repeat_bottom"><a class="submit win_background_color">确认</a><a class="reset win_background_color">取消</a></div></div>';$(".windowPop_body").append(html);$(".windowPop_repeat_bottom a").on("click",function(e){if($(e.currentTarget).hasClass("submit")){$(e.currentTarget).removeClass("yy-disable").addClass("yy-disable");if(!savePort()){$(".windowPop_repeat_bottom").removeClass("yy-disable")}}else{$(".windowPop_body .windowPop_repeat").remove();$dom.css({padding:"20px"});$(".windowPop_true").show();$(".windowPop_bottom").removeClass("yy-disable");return false}})}});var savePort=function savePort(){var flag=false;var params={projectCode:$projectCode,phoneCode:$phoneCode,bookingName:$bookingName,bookingComment:$bookingComment,resouresId:$resouresId,bookingMobile:$bookingMobile,phoneNum:$bookingMobile,bookingStartTime:$bookingStartTime,bookingEndTime:$bookingEndTime};$.when(webUtil.commonThird("addBooking","yy",params)).done(function(data){$(".windowPop_repeat_bottom").removeClass("yy-disable");var rHtml="";rHtml+='<div class="windowPop_repeat"><ul>';var tips=data.data.bookingStatus==0?"提交成功（等待确认）":"预约成功！";rHtml+='<div class="windowPop_sucess_title" >'+tips+'</div><div class="windowPop_sucess_code win_color">本次预约码 <span>'+data.data.bookingCode+"</span></div>";rHtml+='</ul><div  class="windowPop_repeat_bottom"><a class="win_background_color goback">完成</a></div>';var $dom=$(".windowPop_body");$(".windowPop_repeat").remove();$dom.append(rHtml);$(".windowPop_repeat_bottom a").on("click",function(e){webUtil.hiddenPop();$(".windowPop_body .windowPop_repeat").remove();$dom.css({padding:"20px"})});flag=true});return flag}};webUtil.getYyCode=function(){var rPhone=$("input[name=reserPhone]").val().trim();var phoneReg=/^((13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8})$/;if(rPhone==""||phoneReg.test(rPhone)==false){webUtil.showTip("请先输入手机号码");return false}var d={bookingMobile:rPhone};$.when(webUtil.commonThird("queryBookingNum","yy",d)).done(function(res){if(res.data[0].bookingNum==0){webUtil.showTip("此手机号未预约过服务");return false}else{webUtil.getFwCode("reser")}})};webUtil.isSearchByPhone=function(mCheck){var hidePhone=function hidePhone(){$("input[name=reserCheckType]").val("0");$(".search-phone-box").hide();$(".search-botton").hide()};if(mCheck==0){hidePhone()}else{$(".search-botton span").on("click",function(e){$(e.currentTarget).siblings().removeClass("on");$(e.currentTarget).addClass("on");$("input[name=reserCheckType]").val($(e.currentTarget).data("id"));if($("input[name=reserCheckType]").val()==0){$(".search-code-box").show();$(".search-phone-box").hide()}else{$(".search-code-box").hide();$(".search-phone-box").show()}})}$.when(webUtil.commonThird("queryMsgCheck","yy")).done(function(res){if(res.data.msgCheck==0){hidePhone()}})};function changeMode(dom,type){if(type==1){var $resDom=$(".search-phone-box")}else if(type==2){var $resDom=$(".search-code-box")}dom.on("input propertychange",function(){if($(this).val().length>0){$resDom.addClass("phone-box-disabled");$resDom.find("input").attr({disabled:true});if(type==1){$resDom.find(".sendCode-text").addClass("fw-disable")}}if($(this).val().length<1){$resDom.removeClass("phone-box-disabled");$resDom.find("input").attr({disabled:false});if(type==1){$resDom.find(".sendCode-text").removeClass("fw-disable")}}})}webUtil.searchReservation=function(mdId){if($("body").hasClass("edit")){webUtil.showTip("当前为编辑状态，不可操作")}else{var rPhone=$("input[name=reserPhone]").val().trim(),rCode=$("input[name=reserCode]").val().trim(),verfiyCode=$("input[name=verfiyCode]").val().trim(),reserCheckType=$("input[name=reserCheckType]").val();var phoneReg=/^((13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8})$/;if(reserCheckType==0){if(rCode==""){webUtil.showTip("请先输入预约码");return false}}else{if(rPhone==""||phoneReg.test(rPhone)==false){webUtil.showTip("请先输入手机号码");return false}if(verfiyCode==""){webUtil.showTip("请确保验证码输入正确","2");return}}var data={};if(reserCheckType==0){data["bookingCode"]=rCode}else{data["bookingMobile"]=rPhone;data["phoneNum"]=rPhone;data["phoneCode"]=verfiyCode}console.log(reserCheckType);var bookingRecord=function bookingRecord(){function zeroFill(nowtime){if(nowtime<10){return"0"+nowtime}return nowtime}function changeTimeFormat(time,type){var year=time.getFullYear(),month=time.getMonth()+1,day=time.getDate(),hours=time.getHours(),minutes=time.getMinutes();var newM=zeroFill(month),newD=zeroFill(day),newH=zeroFill(hours),newMin=zeroFill(minutes);if(type==1){return year+"-"+newM+"-"+newD+" "+newH+":"+newMin}else if(type==2){return newH+":"+newMin}}var params=data;$.when(webUtil.commonThird("queryBookingRecord","yy",params)).done(function(res){console.log(res);$(".reser-title").html(res.data[0].bookingMobile);var listStr="",len=res.data.length,lng="",lat="",rlabelTxt="";listStr+='<div id="windowPop" class="only_'+mdId+'"><div class="windowPop_body"><div class="windowPop_close"><span>查询结果</span><i class="icon iconfont kenfor-icons-off1"></i></div><div class="windowPop_content win_scroll">';$.each(res.data,function(i,item){var endTime=changeTimeFormat(new Date(item.bookingEndTime.replace(/-/g,"/")),2);var startTime=changeTimeFormat(new Date(item.bookingStartTime.replace(/-/g,"/")),1);if(i==0){lng=item.eventLongitude;lat=item.eventLatitude;rlabelTxt=item.eventLocation}var timeSta="",staClass="",reserClass="";if(item.dataExpired==1){timeSta="已过期";staClass="reser-expired-state"}else{if(item.bookingStatus==0){timeSta="有效（等待确认）"}else if(item.bookingStatus==2){timeSta="已拒绝"}else{timeSta="有效（预约成功）"}reserClass="reser-code-remind"}listStr+='<div class="res-item search-borderBtm '+staClass+'">'+'<ul class="clearfix">'+"<li>"+item.projectName+"</li>"+"<li>"+'<span class="item-label">服务人员：</span>'+'<span class="item-value">'+item.resourcesName+"</span>"+"</li>"+"<li>"+'<span class="item-label">预约人：</span>'+'<span class="item-value">'+item.bookingName+"</span>"+"</li>"+"<li>"+'<span class="item-label">预约服务时间：</span>'+'<span class="item-value">'+startTime+"-"+endTime+"</span>"+"</li>"+'<li class="'+reserClass+'">'+'<span class="item-label win_color">预约码：</span>'+'<span class="item-value win_color">'+item.bookingCode+"</span>"+"</li>"+"<li>"+'<span class="item-label">时间状态：</span>'+'<span class="item-value">'+timeSta+"</span>"+"</li>"+"<li>"+'<span class="item-label">服务地点：</span>';if(item.eventLongitude&&item.eventLongitude){var addrTip=len>1?"查看":"",addrClass="changeMap"}else{var addrTip="暂无",addrClass=""}if(len>1){listStr+='<span class="item-value '+addrClass+'" data-g="'+item.eventLongitude+'" data-t="'+item.eventLatitude+'" data-n="'+item.eventLocation+'">'+addrTip+"</span>"}else{listStr+='<span class="item-value '+addrClass+'" data-g="" data-t="" data-n="">'+addrTip+"</span>"}listStr+="</li>"+"</ul>"+"</div>"});listStr+='</div><div class="windowPop_bottom win_background_color"><span>返回查询</span></div></div></div>';$("body").append(listStr);var renMaps=function renMaps(el,rlng,rlat,rlabelTxt){$("#yyBMapwrapper").remove();if(rlng&&rlat){el?el.parents(".res-item").append('<div id="yyBMapwrapper"><div id="yyMapWrap"></div><div id="mapIcon" class="icon iconfont kenfor-icons-upward1"></div></div>'):$("#windowPop .windowPop_content>.res-item").append('<div id="yyBMapwrapper"><div id="yyMapWrap"></div></div>');webUtil.renderBMap("yyMapWrap",rlng,rlat,rlabelTxt);$("#mapIcon").on("click",function(){$("#yyBMapwrapper").remove()})}};if(len>1){$(".changeMap").on("click",function(e){renMaps($(e.currentTarget),$(e.currentTarget).data("g"),$(e.currentTarget).data("t"),$(e.currentTarget).data("n"))})}else{renMaps("",lng,lat,rlabelTxt)}$(".windowPop_close i,.windowPop_bottom").on("click",function(e){$("#windowPop.only_"+mdId).remove()})})};if(reserCheckType==0){bookingRecord()}else{var d={bookingMobile:rPhone};$.when(webUtil.commonThird("queryBookingNum","yy",d)).done(function(res){if(res.data[0].bookingNum==0){webUtil.showTip("此手机号未预约过服务");return false}else{bookingRecord()}})}}};webUtil.backToSearch=function(){webUtil.hiddenPop()};webUtil.editReserTip=function(){$(".search-item input").click(function(){if($("body").hasClass("edit")){$(this).attr("disabled",true);webUtil.showTip("当前为编辑状态，不可操作")}});if(!$("body").hasClass("edit")){$(".search-item input").attr("disabled",false)}};webUtil.renderBMap=function(el,lng,lat,labelTxt){require(["jquery","async!BMap"],function($){var map=new BMap.Map(el);var point=new BMap.Point(lng,lat);var marker=new BMap.Marker(point);if(labelTxt){var label=new BMap.Label(labelTxt,{offset:new BMap.Size(15,-25)});label.setStyle({width:"auto",background:"#fff",border:"1px solid #ddd",borderRadius:"5px",textAlign:"center",height:"26px",lineHeight:"26px",padding:"0 8px"});marker.setLabel(label)}map.addOverlay(marker);var ctrl_nav=new BMap.NavigationControl({anchor:BMAP_ANCHOR_TOP_LEFT,type:BMAP_NAVIGATION_CONTROL_LARGE});map.addControl(ctrl_nav);var ctrl_sca=new BMap.ScaleControl({anchor:BMAP_ANCHOR_BOTTOM_LEFT});map.addControl(ctrl_sca);map.centerAndZoom(point,15);map.enableScrollWheelZoom()})};webUtil.makeQRUrl=function(mdId,selType,iosurl,fidOrAndroidurl){var domainName=window.WebModel=="edit"?dataUtil.getDomain():window.location.hostname;var path=domainName+"/query.html",fileServerName="192.168.4.43";var cutIosUrlIndex=iosurl.indexOf("itunes.apple.com/");var cutIosUrl=cutIosUrlIndex>-1?iosurl.slice(cutIosUrlIndex+17):iosurl;var isFid=!!fidOrAndroidurl&&!/\D/g.test(fidOrAndroidurl);var appDLUrl=isFid?"http://"+path+"?ios="+cutIosUrl+"&fId="+fidOrAndroidurl+"&type=app":"http://"+path+"?ios="+cutIosUrl+"&android="+fidOrAndroidurl+"&type=app";console.log("appDLUrl:"+appDLUrl);require(["jquery.qrcode.min"],function(){$("#"+mdId+" .bigQRCode").html("").qrcode({render:"canvas",width:120,height:120,text:appDLUrl});if(selType=="02"){$("#"+mdId+" .smallQRCode").html("").qrcode({render:"canvas",width:30,height:30,text:appDLUrl})}})};webUtil.spinnerEdit=function(mdId){if(WebModel=="edit"){$("#spinner_"+mdId+" a").on("click",function(e){webUtil.showTip("编辑状态，无法操作");return false})}$(".spinner_header").on("click",function(){$(".spinner_wrap").toggleClass("open");$(".spinner_wrap>ul").slideToggle()})};webUtil.articleSharePreview=function(mdId,type){var $view=$("#articleDetail_"+mdId+" .skin_model_view");var $share=$("#"+mdId+" #article_share");var $shareColumnContent=$("#"+mdId+" #shareColumn_content");var $articleContent=$("#"+mdId+" #article_content");var $LeftOrRightDom=$view.children().not("#shareColumn_content");var $left=$("#"+mdId+" #shareColumn_content_left");var $Right=$("#"+mdId+" #shareColumn_content_right");var $title=$("#news_title");var shareText="分享";if(type=="default2"){$articleContent.after($share)}else if(type=="default3"){$("#"+mdId+" .articleShareColumn span[data-lang=article_share]").html(shareText);$Right.append($LeftOrRightDom);$left.append($share);$share.css({"margin-top":$title.position().top+$title.outerHeight()+"px"})}else if(type=="default4"){$("#"+mdId+" .articleShareColumn span[data-lang=article_share]").html(shareText);$left.append($LeftOrRightDom);$Right.append($share);$share.css({"margin-top":$title.position().top+$title.outerHeight()+"px"})}};webUtil.articleComment=function(json){var isLogin="",memberInfo="";var props=$.extend({articleId:"0",readPermission:0,customerImg:"",customerName:"",isComment:"0",picUrl:jsPath+"/images/lg_userPic.png",loginUrl:"javascript:appUtil.checked_to_where('mycart')",mdId:"",guestReview:1,memberReview:1,isDelegate:1,isPreview:0,isBlog:false},json);var numRandom=function numRandom(){var d=new Date;var n=d.getTime().toString();return n.substr(n.length-5,n.length)};var formatDate=function formatDate(date){var date=new Date;var y=date.getFullYear();var m=date.getMonth()+1;m=m<10?"0"+m:m;var d=date.getDate();d=d<10?"0"+d:d;return y+"-"+m+"-"+d};if(props.isPreview==1){var mid=window.memberId_center.mid;$.when(iyongwebmember.checkLogin(JSON.stringify({mid:mid})),iyongwebmember.getLoginInfo(JSON.stringify({mid:mid}))).done(function(checkMember,memberInfo){isLogin=checkMember.status;if(isLogin=="1"){memberInfo=memberInfo;props.customerName=memberInfo.cstacc;props.customerImg=memberInfo.csthi}var isAnonymity=sessionStorage.getItem("isAnonymity")?sessionStorage.getItem("isAnonymity"):"0";var mdId=props.mdId==""?"":"#"+props.mdId+" ";var showName=function showName(){var result={};var visitorName=langUtil.Global_visitor1?langUtil.Global_visitor1:langUtil.Global_visitor;if(props.guestReview=="1"){if(props.memberReview=="1"){if(isLogin=="1"){result.name=props.customerName;result.type="v1"}else{result.name=visitorName+sessionStorage.getItem("visitorNO");result.type="v2"}}else{result.name=visitorName+sessionStorage.getItem("visitorNO");result.type="v3"}}else{if(isLogin=="1"){result.name=props.customerName;result.type="m1"}else{result.name=langUtil.welcomLg;result.type="m2"}}return result};var htmlEncode=function htmlEncode(txt){var Ntxt=txt.toString();Ntxt=Ntxt.indexOf(" ")>-1?Ntxt.replace(" ","&nbsp;"):Ntxt;Ntxt=Ntxt.indexOf("<")>-1?Ntxt.replace(/</g,"&lt;"):Ntxt;Ntxt=Ntxt.indexOf(">")>-1?Ntxt.replace(/>/g,"&gt;"):Ntxt;Ntxt=Ntxt.indexOf('"')>-1?Ntxt.replace(/\"/g,"&quot;"):Ntxt;Ntxt=Ntxt.indexOf("'")>-1?Ntxt.replace(/'/g,"&#39;"):Ntxt;Ntxt=Ntxt.indexOf("\n")>-1?Ntxt.replace(/\n/g,"<br>"):Ntxt;return Ntxt};var saveArticleComment=function saveArticleComment(commentId){if(showName().type=="m2"){webUtil.showTip("请先登录会员！");appUtil.checked_to_where("member")}else{var jsonData={},text="";jsonData.memberId=mid;jsonData.articleId=props.articleId;jsonData.customerAccount=showName().name||"";if(commentId){text=$("#commentText_reply").val().trim();jsonData.commentId=commentId;var $buttonDom=$("#commentText_submit")}else{text=$("#commentText").val().trim();var $buttonDom=$(".article_comment_submit")}jsonData.commentContent=text;if(text){$buttonDom.removeClass("yy-disable").addClass("yy-disable");if(showName().type=="v1"||showName().type=="m1"){jsonData.customerId=memberInfo.accountId||"";jsonData.customerHeadImg=memberInfo.csthi||""}$.when(dataUtil.commonThirdRpc("saveArticleComment","blog",jsonData)).done(function(res){if(res.result=="SUCCESS"){$("#commentText").val("");webUtil.showTip("留言提交成功！");getArticleCommentList();$buttonDom.removeClass("yy-disable");var newCommentId=res.data.commentId;var oldCommentId=sessionStorage.getItem("commentId");if(oldCommentId){oldCommentId=newCommentId+","+oldCommentId}else{oldCommentId=newCommentId}sessionStorage.setItem("commentId",oldCommentId);getUnreivewComment()}})}else{webUtil.showTip(langUtil.article_placeholder)}}};var getUnreivewComment=function getUnreivewComment(){var jsonstr=sessionStorage.getItem("commentId");if(jsonstr){$("#unReviewCommentList").html("");var jsonData=jsonstr.split(",");$.when(dataUtil.commonThirdRpc("infoArticleComment","blog",{commentIdList:jsonData,memberId:mid})).done(function(res){if(res.result=="SUCCESS"){$.each(jsonData,function(i,item){var data=res.data[item];if(data&&data[data.length-1].reviewStatus==0&&data[data.length-1].articleId==props.articleId){var replyList="",replyTxt="";if(data.length>0){$.each(data,function(j,comment){var cImg=!comment.customerHeadImg||comment.customerHeadImg==""?props.picUrl:comment.customerHeadImg;var time=comment.commentDatetime?dataUtil.setDatetimeStyle(comment.commentDatetime):"";if(j<data.length-1){replyList+='<div class="article_comment_reply_list"><div class="article_comment_user"><span><img src="'+cImg+'" /></span>'+comment.customerAccount+"<date>"+time+"</date></div>";replyList+="<div>"+comment.commentContent+"</div>";replyList+="</div>"}if(j==data.length-1){replyTxt+='<div class="article_comment_li">';replyTxt+='<div class="article_comment_user"><span><img src="'+cImg+'" /></span>'+comment.customerAccount+"<date>"+time+"</date></div>";if(data.length>1){replyTxt+='<div class="article_comment_reply">'+replyList+"</div>"}replyTxt+='<div class="article_comment_commentContent">'+comment.commentContent+"</div>";replyTxt+="</div>"}})}$("#"+props.mdId+" #unReviewCommentList").append(replyTxt);$(mdId+" .no_comment").remove()}})}})}};var getArticleCommentList=function getArticleCommentList(pageIndex){var pageIndex=pageIndex||1,pageMax=10;var params={pageMax:pageMax,pageIndex:pageIndex,needCustomer:false,articleIdList:[props.articleId]};$.when(dataUtil.commonThirdRpc("listArticleComment","blog",params)).done(function(res){if(res.result=="SUCCESS"){var data=res.data.rows,$el=$("#"+props.mdId+" #reviewCommentList"),html="";var comments=res.data.comments;$.each(data,function(i,item){var cImg=!item.customerHeadImg||item.customerHeadImg==""?props.picUrl:item.customerHeadImg;var time=item.commentDatetime?dataUtil.setDatetimeStyle(item.commentDatetime):"";html+='<div class="article_comment_li">';html+='<div class="article_comment_user"><span><img src="'+cImg+'" onerror="this.src=\''+props.picUrl+"';this.onerror='null'\"/></span>"+item.customerAccount+"<date>"+time+"</date></div>";if(item.commentIdList.length>0){html+='<div class="article_comment_reply">';$.each(item.commentIdList,function(i,reply){var comment=comments[reply];if(comment){var time=comment.commentDatetime?dataUtil.setDatetimeStyle(comment.commentDatetime):"";html+='<div class="article_comment_reply_list"><div class="article_comment_user"><span><img src="'+cImg+'" onerror="this.src=\''+props.picUrl+"';this.onerror='null'\"/></span>"+comment.customerAccount+"<date>"+time+"</date></div>";html+="<div>"+comment.commentContent+"</div>";if(!(props.guestReview=="0"&&props.memberReview=="0"||props.isComment==0)){html+='<a data-id="'+comment.commentId+'" class="article_commentReply article_comment_submit1">'+langUtil.msgSubmit_reply+"</a>"}html+="</div>"}});html+="</div>"}html+='<div class="article_comment_reply_list"><div class="article_comment_commentContent">'+item.commentContent+"</div>";if(!(props.guestReview=="0"&&props.memberReview=="0"||props.isComment==0)){html+='<a data-id="'+item.commentId+'" class="article_commentReply article_comment_submit1">'+langUtil.msgSubmit_reply+"</a>"}html+="</div></div>"});$el.html(html);if(data.length==0){$("#unReviewCommentList").html()==""?$el.html('<div class="no_comment"><img src="'+imgPath+'images/iyong/img_phone.png"></div>'):""}if(!(props.guestReview=="0"&&props.memberReview=="0"||props.isComment==0)){$(".article_commentReply").bind("click",function(e){if(showName().type=="m2"){webUtil.showTip("请先登录会员！");appUtil.checked_to_where("member")}else{$(".article_reply_reply").remove();var $dom=$(e.currentTarget);if($dom.hasClass("on")){$(".article_commentReply").removeClass("on");$(".article_reply_reply").remove()}else{var id=$(e.currentTarget).data("id");$(".article_commentReply").removeClass("on");$dom.addClass("on");$dom.after('<div class="article_reply_reply"><textarea id="commentText_reply" placeholder="'+langUtil.article_placeholder+'" maxlength="200"></textarea><a id="commentText_submit">'+langUtil.Global_submit+"</a></div>");$("#"+props.mdId+" #commentText_submit").unbind().on("click",function(){saveArticleComment(id)})}}})}if(res.data.totalRecord>pageMax){dataUtil.page($(".article_comment_page .pagination"),res.data.pageIndex,res.data.totalRecord,res.data.pageMax,res.data.pageNum);$(".article_comment_page").undelegate("a","click");$(".article_comment_page").delegate("a","click",function(e){e.stopPropagation();e.preventDefault();loadPageInfo("",$(this),$(this).data("page"),".article_comment_page .pagination");function loadPageInfo(id,event,page,className){if(page){$(className+id).data("page",page)}else{var type=event.data("type");var currPage=$(className+id).data("page")||1;if(type==0){$(className+id).data("page",parseInt(currPage)-1)}else{$(className+id).data("page",parseInt(currPage)+1)}}getArticleCommentList($(className+id).data("page"))}});$(".article_comment_page").show()}else{$(".article_comment_page").hide()}}})};var initDOM=function initDOM(){if(props.guestReview=="1"&&isAnonymity=="0"){sessionStorage.setItem("isAnonymity",props.guestReview);sessionStorage.setItem("visitorNO",numRandom())}if(props.guestReview=="0"){sessionStorage.removeItem("isAnonymity");sessionStorage.removeItem("visitorNO")}var $el=$(".article_comment_login"),customerPic=props.customerImg==""?props.picUrl:props.customerImg;var nameTxt="";$el.find(".article_comment_user span").html('<img src="'+customerPic+'" onerror="this.src=\''+props.picUrl+"';this.onerror='null'\"/>");$el.find(".article_comment_user date").html(formatDate);if(showName().type=="m2"){$el.find(".article_comment_content").html('<p><a href="'+props.loginUrl+'">'+langUtil.shopUtil_log+"</a> "+langUtil.Global_comment+"</p>")}else{$el.find(".article_comment_content").html('<textarea id="commentText" placeholder="'+langUtil.article_placeholder+'"  maxlength="200"></textarea>')}if(showName().type=="v2"){nameTxt=showName().name+'<a class="login">'+langUtil.welcomLg+"</a>"}else if(showName().type=="v3"||showName().type=="m2"){nameTxt=showName().name}else{nameTxt=showName().name+'<a class="logout">'+langUtil.index_outLogin+"</a>"}$el.find(".article_comment_user b").html(nameTxt);$(mdId+".login").unbind().bind("click",function(){appUtil.checked_to_where("member")});$(mdId+".logout").unbind().bind("click",function(){iyongwebmember.logout(JSON.stringify({mid:mid}))});$(mdId+".article_comment_submit").unbind().on("click",function(event){saveArticleComment()});if(props.isBlog==true&&props.isComment=="0"){$("#allowArticleComment").hide()}else{$("#allowArticleComment").show()}};initDOM();getArticleCommentList();getUnreivewComment()})}else{var tempTips=function tempTips(){dataUtil.iyongShowTips("设计后台不允许操作！",1)};if(props.isBlog==true&&props.isComment=="0"){$("#allowArticleComment").hide()}else{$("#allowArticleComment").show()}var $el=$(".article_comment_login");$el.find(".article_comment_user span").html('<img src="'+props.picUrl+'"/>');$el.find(".article_comment_user b").html(langUtil.Global_visitor1?langUtil.Global_visitor1:langUtil.Global_visitor);if(props.guestReview==0&&props.memberReview==1){$el.find(".article_comment_user b").html(langUtil.welcomLg)}else{$el.find(".article_comment_user b").html(langUtil.Global_visitor1?langUtil.Global_visitor1:langUtil.Global_visitor)}if(props.guestReview==1&&props.memberReview==1){$el.find(".article_comment_user b").append('<a class="login tempTips">'+langUtil.welcomLg+"</a>")}$el.find(".article_comment_user date").html(formatDate);if(props.guestReview==0&&props.memberReview==1){$el.find(".article_comment_content").html('<p><a class="tempTips">'+langUtil.shopUtil_log+"</a> "+langUtil.Global_comment+"</p>")}else{$el.find(".article_comment_content").html('<textarea id="commentText" placeholder="'+langUtil.article_placeholder+'"  maxlength="200"></textarea>')}$("#reviewCommentList").html('<div class="no_comment"><img src="'+imgPath+'images/iyong/img_phone.png"></div>');$el.find(".tempTips").unbind().on("click",tempTips)}};webUtil.articleCollection=function(mdId,articleId){var mid=window.memberId_center.mid;var jsonstr=JSON.stringify({mid:mid,articleId:articleId});var isLogin="0";var $node=$("#"+mdId+" #news_collection");$.when(iyongwebmember.checkLogin(JSON.stringify({mid:mid})),iyongwebmember.checkArticleCollection(jsonstr)).done(function(checkMember,articleCollection){isLogin=checkMember.status;var isCollection=articleCollection.status||"";if(isLogin=="1"){if(isCollection=="1"){$node.removeClass("kenfor-icons-star2").addClass("kenfor-icons-star1");$node.attr("data-id","1")}else{$node.removeClass("kenfor-icons-star1").addClass("kenfor-icons-star2");$node.attr("data-id","")}}else{$node.removeClass("kenfor-icons-star1").addClass("kenfor-icons-star2");$node.attr("data-id","")}var setCollection=function setCollection(articleId){var $nodeChild=$node.parent("li").find("span#blogCollect");$node.removeClass("noClick").addClass("noClick");if(isCollection==1){$.when(iyongwebmember.deleteArticleCollection(jsonstr)).done(function(collection){var isCancel=collection.status||"";if(isCancel=="1"){isCollection=0;webUtil.showTip("取消成功！")}$node.removeClass("noClick");$node.removeClass("kenfor-icons-star1").addClass("kenfor-icons-star2")})}else{$.when(iyongwebmember.saveArticleCollection(jsonstr)).done(function(collection){var isAdd=collection.status||"";if(isAdd=="1"){isCollection=1;webUtil.showTip("收藏成功！")}$node.removeClass("noClick");$node.removeClass("kenfor-icons-star2").addClass("kenfor-icons-star1")})}};$("#"+mdId+" #news_collection").unbind().on("click",function(event){if(!$(event.currentTarget).hasClass("noClick")){if(isLogin=="1"){setCollection(articleId)}else{webUtil.showTip("请先登录会员！");appUtil.checked_to_where("member")}}})})};webUtil.loadBlog=function(json){var props=$.extend({mdId:"",fatherId:0,blogId:"0",admin:"",readPermission:0,customerImg:"",customerName:"",isComment:"1",guestReview:1,memberReview:1,isPreview:0,picUrl:jsPath+"/images/lg_userPic.png",loginUrl:"javascript:appUtil.checked_to_where('mycart')"},json);var bolgID,$detail=$("#"+props.mdId+" .blog_detail"),isPreview=$("body").hasClass("edit")?0:1;var loadDefaultData=props.fatherId=="-1"?true:false;if(loadDefaultData){dataUtil.getBlogMockData(props.mdId);return}var getBlogType=function getBlogType(mdId,fatherId){$.ajax({url:"/w/article/listArticleType.do",type:"POST",data:{pageMax:100,pageIndex:1,typeStatus:1},success:function success(res){if(res.result=="SUCCESS"){var data=res.data.rows,html="",second=0,third=0,four=0;$.each(data,function(i,item){if(item.fatherId==fatherId){html+='<li><a href="#" data-id="'+item.articleTypeId+'"><b class="type_icon"></b><span>'+item.typeName+"</span></a>";second=0;$.each(data,function(j,child){if(item.articleTypeId==child.fatherId){++second;html+=second==1?'<ul class="secondLevel">':"";html+='<li><a href="#"  data-id="'+child.articleTypeId+'"><b class="type_icon"></b><span>'+child.typeName+"</span></a>";third=0;$.each(data,function(k,gchild){if(child.articleTypeId==gchild.fatherId){++third;html+=third==1?'<ul class="thirdLevel">':"";html+='<li><a href="#" data-id="'+gchild.articleTypeId+'"><b class="type_icon"></b><span>'+gchild.typeName+"</span></a>";four=0;$.each(data,function(n,ggchild){if(gchild.articleTypeId==ggchild.fatherId){++four;html+=four==1?'<ul class="fourLevel">':"";html+='<li><a href="#" data-id="'+ggchild.articleTypeId+'"><b class="type_icon"></b><span>'+ggchild.typeName+"</span></a></li>"}});html+=four!=0?"</ul>":"";html+="</li>"}});html+=third!=0?"</ul>":"";html+="</li>"}});html+=second!=0?"</ul>":"";html+="</li>"}});$("#"+mdId+" #blogTypeList").html(html);if(fatherId!="0"){var jstr={pageMax:"100",articleTypeId:fatherId,pageIndex:"1",admin:props.admin};$.when(getBlogList(jstr)).done(function(res){var data=res.rows,ghtml="";$.each(data,function(i,item){ghtml+='<li class="blog_info"><a data-id="'+item.articleId+'"><b class="type_icon"></b><span>'+item.articleTitle+"</span></a></li>"});$("#"+mdId+" #blogTypeList").append(ghtml)})}}}})};var getBlogInfo=function getBlogInfo(json){var jsonStr=$.extend({articleId:"",dom:"",admin:""},json);var $dom=jsonStr.dom;if(jsonStr.articleId==""||jsonStr.articleId=="0"){$dom.find("#blogTitle").html(langUtil.Global_nothing);$dom.find(".blog_list,.blog_content,.blog_comment").hide()}else{$.ajax({url:"/w/article/infoArticle.do?id="+jsonStr.articleId,data:{admin:jsonStr.admin},type:"GET",async:false,success:function success(res){var _commentJson;var data=res.data||{};if(data.noAuthority&&data.noAuthority!=undefined&&data.noAuthority==true){$dom.find("#blogTitle").html(langUtil.Global_noPermission);$dom.find(".blog_list,.blog_content,.blog_comment").hide()}else{if(res.result=="SUCCESS"){$dom.find("#blogTitle").html(data.articleTitle);$dom.find("#blogType").html(data.typeName);$dom.find("#blogCollect").html(data.collectionTimes);$dom.find("#blogTime").html(data.publishDatetime);$dom.find("#blogSummary").html(data.articleDescription);$dom.find("#blogContent").html(data.textList[0].textContent);$dom.find(".blog_list,.blog_content,.blog_comment").show();if(data.isComment==0){$dom.find("#allowArticleComment").hide()}else{$dom.find("#allowArticleComment").show()}if($dom.find("#blogContent .edui-upload-video").length>0){webUtil.eduiVideoClickPlay()}}else{console.log(res.errorMsg.msg,1.5)}}if(isPreview==1){webUtil.articleCollection(props.mdId,data.articleId)}var commentJson=(_commentJson={articleId:data.articleId,readPermission:data.readPermission,customerImg:props.customerImg,customerName:props.customerName,isComment:data.isComment,picUrl:props.picUrl,loginUrl:props.loginUrl,mdId:props.mdId},_defineProperty(_commentJson,"isComment",data.isComment),_defineProperty(_commentJson,"guestReview",props.guestReview),_defineProperty(_commentJson,"memberReview",props.memberReview),_defineProperty(_commentJson,"isPreview",props.isPreview),_defineProperty(_commentJson,"isBlog",true),_commentJson);webUtil.articleComment(commentJson)}});$.ajax({url:"/w/article/infoArticleClick.do?id="+jsonStr.articleId,type:"GET",success:function success(res){if(res.result=="SUCCESS"){$dom.find("#blogClick").html(res.data.clickTimes)}else{webUtil.showTip(res.errorMsg.msg,1.5)}}})}};var getBlogList=function getBlogList(json){var defer=$.Deferred();var props=$.extend({pageMax:"1",articleTypeId:"",pageIndex:"1",admin:""},json);$.ajax({url:"/w/article/listArticle.do",type:"POST",data:props,success:function success(data){if(data.result=="SUCCESS"){defer.resolve(data.data)}else{webUtil.showTip(data.errorMsg.msg,1.5)}}});return defer.promise()};getBlogType(props.mdId,props.fatherId);if(props.blogId!="0"){bolgID=props.blogId;getBlogInfo({articleId:bolgID,dom:$detail,admin:props.admin})}else{var articleTypeId=props.fatherId!=0?props.fatherId:"";$.when(getBlogList({articleTypeId:articleTypeId,pageMax:"1",pageIndex:"1",admin:props.admin})).done(function(res){bolgID=res.rows.length>0?res.rows[0].articleId:"0";getBlogInfo({articleId:bolgID,dom:$detail,admin:props.admin})})}$("#"+props.mdId+" #blogTypeList").undelegate().delegate("a","click",function(e){e.preventDefault();var $dom=$(e.currentTarget),dataID=$dom.data("id"),$domLI=$dom.parent("li"),oldID=$detail.data("id")||"";$detail.data("id",dataID);if(!$domLI.hasClass("blog_info")){if($domLI.hasClass("selected")){$domLI.removeClass("selected");$domLI.children("ul").find(".blog_info").remove()}else{var jstr={pageMax:"100",articleTypeId:dataID,pageIndex:"1",admin:props.admin};$.when(getBlogList(jstr)).done(function(res){var data=res.rows,html="";$.each(data,function(i,item){html+='<li class="blog_info"><a data-id="'+item.articleId+'"><b class="type_icon"></b><span>'+item.articleTitle+"</span></a></li>"});if(!(data.length==0&&$domLI.children("ul").length==0)){$domLI.addClass("selected");if($domLI.children("ul").length>0){$domLI.children("ul").append(html)}else{$domLI.append("<ul>"+html+"</ul>")}}else{webUtil.showTip("暂时无内容",1.5)}})}}else if($detail.data("id")!=oldID){$("#"+props.mdId+" #blogTypeList .blog_info").removeClass("on");$domLI.addClass("on");getBlogInfo({articleId:dataID,dom:$detail,admin:props.admin})}})};webUtil.paramSkuList=function(paramSkuList){var $dom=$("#paramSkuList .paramSku");$dom.find("a").unbind().on("click",function(e){var type=$(this).parent(".paramSku").attr("data-type")+$(this).attr("data-num");if($(this).hasClass("on")){$(this).removeClass("on");$(this).parent(".paramSku").removeAttr("data-total")}else{$(this).parent(".paramSku").find("a").removeClass("on");$(this).addClass("on");$(this).parent(".paramSku").attr("data-total",type)}webUtil.totalSkuPrice();webUtil.checkSkuPrice(paramSkuList)})};webUtil.totalSkuPrice=function(){var $dom=$("#paramSkuList .paramSku");var totalType="";$.each($dom,function(i,item){var singleType=$(item).attr("data-total");if(singleType){totalType+=singleType}});$dom=$("#paramSkuList").data("skuprice",totalType)};webUtil.checkSkuPrice=function(paramSkuList){var productSkuDetailList=paramSkuList,skuDetailNumList=[];var checkSkuNum=$("#paramSkuList").data("skuprice");var skuSalePrice=$("#skuSalePrice").attr("data-price"),skuOriginalPrice=$("#skuOriginalPrice").attr("data-price"),isSku=false;$.each(productSkuDetailList,function(i,item){skuDetailNumList.push(item.skuDetailNum);if(checkSkuNum==item.skuDetailNum){if($("#newPriceShow").attr("data-stocktype")=="1"){$("#skuStock").html(item.skuDetailStock)}$("#skuSalePrice").html(item.skuDetailSalePrice);$("#skuOriginalPrice").html(item.skuDetailOriginalPrice);$("#shopSaleButtonList").data("skuDetailId",item.skuDetailId);$("#shopSaleButtonList").data("skuDetailStock",item.skuDetailStock);isSku=true;return}});if(!isSku){if($("#newPriceShow").attr("data-stocktype")=="1"){$("#skuStock").html($("#newPriceShow").attr("data-stock"))}$("#skuSalePrice").html(skuSalePrice);$("#skuOriginalPrice").html(skuOriginalPrice);$("#shopSaleButtonList").data("skuDetailId","");$("#shopSaleButtonList").data("skuDetailStock")}};webUtil.addSkuCar=function(productId,isNew,proThemeImg){if($("body").hasClass("edit")){webUtil.showTip("设计后台，不允许操作！",1.5)}else{var stock=Number($("#skuStock").html());var isSku=$("#shopSaleButtonList").attr("data-sku");var mid=window.memberId_center.mid;var stocktype=$("#newPriceShow").attr("data-stocktype");var proThemeImg=proThemeImg||imgPath+"images/cart/cart1.png";$.when(iyongwebmember.checkLogin(JSON.stringify({mid:mid}))).done(function(checkMember){var isLogin=checkMember.status||0;var params={};params.mid=mid;params.productCount=1;params.productId=productId;params.skuDetailId=$("#shopSaleButtonList").data("skuDetailId");if(isLogin){if(isSku=="1"&&!params.skuDetailId){webUtil.showTip(langUtil.shopUtil_check+langUtil.Global_specification,1.5);return}if(stocktype=="1"&&stock==0){webUtil.showTip(langUtil.shopUtil_chose,1.5);return}$.when(iyongwebmember.addCart(JSON.stringify(params))).done(function(data){if(data.status==1){var txt1=langUtil.Global_goCart||"Go Shopingcart",txt2=langUtil.Global_lookfor||"Continue to buy",tipTxt=$("#shopSaleButtonList").data("tip")||"";var html='<div id="addCarSuccess"><div class="addCarSuccess_bg"></div><div class="addCarSuccess_content"><span class="close icon iconfont kenfor-icons-off1"></span><p style="background-image:url('+proThemeImg+')"></p><font>'+tipTxt+'</font><div><a class="goBuy">'+txt1+'</a><a class="lookfor hasbg">'+txt2+"</a></div></div></div>";$("body").append(html);$("#addCarSuccess").find(".goBuy,.lookfor,.close").unbind().bind("click",function(event){var type=event.currentTarget.className.toLowerCase();if(type=="gobuy"){appUtil.checked_to_where("shopingcart")}else{$("#addCarSuccess").remove()}event.preventDefault()});$("#addCarSuccess").find(".addCarSuccess_bg").unbind().bind("dblclick",function(event){$("#addCarSuccess").remove();event.preventDefault()});webUtil.UpdataCartNum()}else{webUtil.showTip(data.errorMsg,1.5)}})}else{webUtil.showTip(langUtil.shopUtil_login,1.5);setTimeout(function(){appUtil.checked_to_where("shopingcart")},1500)}})}};webUtil.shopSaleButtonList=function(tipTxt){var $dom=$("#shopSaleButtonList"),$node=$dom.find("ul"),$p=$dom.find(".shopSaleButton p");$dom.data("tip",tipTxt||"已成功加入购物车");$p.on("mouseenter",function(e){$node.show();$p.removeClass("on").addClass("on")});$node.bind("mouseenter",function(e){$node.show();$p.removeClass("on").addClass("on")});$dom.find("ul,.shopSaleButton p").on("mouseleave",function(e){$node.hide();$p.removeClass("on")})};webUtil.amountCut=function(){var isSku=$("#shopSaleButtonList").attr("data-sku");var skuDetailId=$("#shopSaleButtonList").data("skuDetailId");if(isSku=="1"&&!skuDetailId){webUtil.showTip(langUtil.shopUtil_check+langUtil.Global_specification,1.5);return}var quantity=Number($(".amount").val())-1;if(quantity==0){quantity=1;webUtil.showTip("该商品1件起售",1)}$(".amount").val(quantity)};webUtil.amountAdd=function(){var isSku=$("#shopSaleButtonList").attr("data-sku");var skuDetailId=$("#shopSaleButtonList").data("skuDetailId");if(isSku=="1"&&!skuDetailId){webUtil.showTip(langUtil.shopUtil_check+langUtil.Global_specification,1.5);return}var quantity=Number($(".amount").val())+1;if(quantity>Number($("#skuStock").html())){webUtil.showTip("库存不足",1);$(".amount").val(quantity-1)}else{$(".amount").val(quantity)}};webUtil.showProComment=function(json){var props=$.extend({mdId:"",proID:"",picUrl:jsPath+"/images/lg_userPic.png",loginUrl:"javascript:appUtil.checked_to_where('mycart')",isShow:1,pageMax:10,pageIndex:1},json);var mid=window.memberId_center.mid;$("#"+props.mdId+" .descShow").find(".hd ul").append("<li>"+langUtil.Global_comment+"</li>");$("#"+props.mdId+" .descShow").find(".bd").append('<div class="lh"><div id="proCommentBox" ></div><div class="pro_comment_page page_style_dh"><ul class="pagination"></ul></div></div>');var params={mid:mid,productIdList:[props.proID],pageMax:props.pageMax,pageIndex:props.pageIndex,needCustomer:false};var getProCommentList=function getProCommentList(pageIndex){if(pageIndex){params.pageIndex=pageIndex}$.when(dataUtil.commonThirdRpc("listComment","ecommerce",params)).done(function(res){if(res.result=="SUCCESS"){var data=res.data.rows,$el=$("#reviewCommentList"),html="";var comments=res.data.comments;$.each(data,function(i,item){var cImg=!item.headImg||item.headImg==""?props.picUrl:item.headImg;html+='<div class="article_comment_li">';html+='<div class="article_comment_user"><span><img src="'+cImg+'" onerror="this.src=\''+props.picUrl+"';this.onerror='null'\"/></span>"+item.nickName+"<date>"+item.commentDatetime+"</date></div>";if(item.commentIdList.length>0){html+='<div class="article_comment_reply">';$.each(item.commentIdList,function(i,reply){var comment=comments[reply];if(comment){html+='<div class="article_comment_reply_list"><div class="article_comment_user"><span><img src="'+cImg+'" onerror="this.src=\''+props.picUrl+"';this.onerror='null'\"/></span>"+comment.nickName+"<date>"+comment.commentDatetime+"</date></div>";html+="<div>"+comment.commentContent+"</div>";html+="</div>"}});html+="</div>"}html+='<div class="article_comment_commentContent">'+item.commentContent+"</div>";html+="</div>"});$("#proCommentBox").html(html);if(data.length==0){$("#proCommentBox").html('<div class="no_comment"><img src="'+imgPath+'images/iyong/img_phone.png"></div>')}if(res.data.totalRecord>props.pageMax){dataUtil.page($(".pro_comment_page .pagination"),res.data.pageIndex,res.data.totalRecord,res.data.pageMax,res.data.pageNum);$(".pro_comment_page").undelegate("a","click");$(".pro_comment_page").delegate("a","click",function(e){e.stopPropagation();e.preventDefault();loadPageInfo("",$(this),$(this).data("page"),".pro_comment_page .pagination");function loadPageInfo(id,event,page,classMame){if(page){$(classMame+id).data("page",page)}else{var type=event.data("type");var currPage=$(classMame+id).data("page")||1;if(type==0){$(classMame+id).data("page",parseInt(currPage)-1)}else{$(classMame+id).data("page",parseInt(currPage)+1)}}getProCommentList($(classMame+id).data("page"))}});$(".pro_comment_page").show()}else{$(".pro_comment_page").hide()}}})};getProCommentList()};webUtil.productCollection=function(mdId,productId){var mid=window.memberId_center.mid;var jsonstr=JSON.stringify({mid:mid,productId:productId||""});var isLogin="0";var $node=$("#"+mdId+" #productCollection i");$.when(iyongwebmember.checkLogin(JSON.stringify({mid:mid})),iyongwebmember.checkCollection(jsonstr)).done(function(checkMember,productCollection){isLogin=checkMember.status;var isCollection=productCollection.status||"";if(isLogin=="1"){if(isCollection=="1"){$node.removeClass("kenfor-icons-shape3").addClass("kenfor-icons-shape4");$node.attr("data-id","1")}else{$node.removeClass("kenfor-icons-shape4").addClass("kenfor-icons-shape3");$node.attr("data-id","")}}else{$node.removeClass("kenfor-icons-shape4").addClass("kenfor-icons-shape3");$node.attr("data-id","")}var setCollection=function setCollection(productId){$node.removeClass("noClick").addClass("noClick");if(isCollection==1){$.when(iyongwebmember.delCollection(jsonstr)).done(function(collection){var isCancel=collection.status||"";if(isCancel=="1"){isCollection=0;webUtil.showTip("取消成功！")}$node.removeClass("noClick");$node.removeClass("kenfor-icons-shape4").addClass("kenfor-icons-shape3")})}else{$.when(iyongwebmember.saveCollection(jsonstr)).done(function(collection){var isAdd=collection.status||"";if(isAdd=="1"){isCollection=1;webUtil.showTip("收藏成功！")}$node.removeClass("noClick");$node.removeClass("kenfor-icons-shape3").addClass("kenfor-icons-shape4")})}};$node.unbind().on("click",function(event){if(!$(event.currentTarget).hasClass("noClick")){if(isLogin=="1"){setCollection(productId)}else{webUtil.showTip("请先登录会员！");appUtil.checked_to_where("member")}}})})};webUtil.productShare=function(json){var props=$.extend({mdId:"",shareList:"",el:"productShareContentLi"},json);var checkSahre=props.shareList?eval("("+props.shareList+")"):props.shareList;var $dom=props.mdId?$("#"+props.mdId+" #"+props.el):$("#"+props.el);var shareTable=dataUtil.shareTable();var html="",shareEvent="";$.each(shareTable,function(i,item){if(checkSahre.indexOf(item.name)>-1){if(item.name=="weixin"){shareEvent=item.event+"()"}else if(item.name=="copy"){shareEvent=item.event+"(url)"}else{shareEvent=item.event+"(event)"}html+='<a class="langText" data-lang="'+item.lang+'" hidefocus="true" title="'+item.sharetitle+'" href="javascript:;" onclick="'+shareEvent+'"><div class="shareIcon" id="'+item.name+'"></div></a>'}});$dom.html(html)};webUtil.searchAllSite=function(mdId,searchArgObj){var searchRangeStr=searchArgObj.searchRange,articleSearchName=searchArgObj.articleSearchName,productSearchName=searchArgObj.productSearchName,isKeywordShown=searchArgObj.isKeywordShown=="true"?true:false,isSearchboxShown=searchArgObj.isSearchboxShown=="true"?true:false;function searchExecFn(isSearchInputExec,searchInputVal){var searchVal="",mid="",kw=webUtil.decodeGueryString("keyword");if(WebModel==="edit"){searchVal="";var glo=require("kenfor/global");mid=glo.getMemberId()}else{if(kw){searchVal=kw}if(isSearchInputExec){searchVal=searchInputVal}mid=memberId_center.mid}var searchViewDom=$("#searchAllSite_"+mdId),langID=dataUtil.currentLangId(),langObj=dataUtil.getLangObj(langID),reArticles=langObj.reArticles,reProducts=langObj.reProducts,backward=langObj.backward,noDataLangStr=langObj.noData,readLangStr=langObj.read,sessionReturnPageUrl=sessionStorage.getItem("searchReturnPage")||"/index.html",returnPageUrl=sessionReturnPageUrl?sessionReturnPageUrl:window.location.href,prodRpcParamObj={mid:mid,langIdList:[langID],pageIndex:1,pageMax:8,productName:searchVal},articleRpcParamObj={memberId:mid,pageIndex:1,pageMax:8,articleTitle:searchVal};var searchBoxInResHtml=isSearchboxShown===true?'<div class="searchBoxInRes searchContainer">'+'<div class="searchCoverInRes"></div>'+'<span class="searchInputPanelInRes">'+'<input type="text" class="searchInput getSearchVal" value="'+searchVal+'"/>'+"</span>"+'<span class="searchIconInRes searchExec kenfor-icons-search"></span>'+"</div>":"",prodSearchResHtml=searchRangeStr.indexOf("product")>-1?'<div id="prodSearchRes" class="searchResPanel prodSearchRes">'+'<div class="resMainTitle">'+'<span class="resMainTitleIcon kenfor-icons-briefcase2"></span>'+'<span class="resMainTitleText">'+productSearchName+"</span>"+"</div>"+'<div class="resMainContent"></div>'+"</div>":"",articleSearchResHtml=searchRangeStr.indexOf("article")>-1?'<div id="articleSearchRes" class="searchResPanel articleSearchRes">'+'<div class="resMainTitle">'+'<span class="resMainTitleIcon kenfor-icons-article2"></span>'+'<span class="resMainTitleText">'+articleSearchName+"</span>"+"</div>"+'<div class="resMainContent"></div>'+"</div>":"",keywordPanelHtml=isKeywordShown&&searchVal?'<div class="keywordPanel">'+searchVal+"</div>":"",searchResHtml='<div class="searchRes">'+searchBoxInResHtml+'<div class="searchResHead">'+'<div class="searchReturn" onclick="window.location.href=\''+returnPageUrl+"'\">"+'<span class="searchReturnIcon icon iconfont kenfor-icons-back2"></span>'+'<span class="searchReturnText">'+backward+"</span>"+"</div>"+keywordPanelHtml+"</div>"+'<div class="searchResPage">'+prodSearchResHtml+articleSearchResHtml+"</div>"+"</div>",noDataHtml='<div class="noInfo"></div><div class="noInfoText">'+noDataLangStr+"</div>";searchViewDom.html(searchResHtml);searchViewDom.find(".searchRes .resMainContent").html("");if(searchRangeStr.indexOf("product")>-1){viewByPage("prod",1,8,function(data){listView("prod",data)})}if(searchRangeStr.indexOf("article")>-1){viewByPage("article",1,8,function(data){listView("article",data)})}function viewByPage(viewType,pageIndex,pageMax,callback){var rpcObj={},apiCode="",systemCode="";if(viewType=="prod"){rpcObj=JSON.parse(JSON.stringify(prodRpcParamObj));apiCode="listProductByPage";systemCode="ecommerce"}else if(viewType=="article"){rpcObj=JSON.parse(JSON.stringify(articleRpcParamObj));apiCode="listArticle";systemCode="blog"}else{return false}rpcObj.pageMax=pageMax;rpcObj.pageIndex=pageIndex;$.when(dataUtil.commonThirdRpc(apiCode,systemCode,rpcObj)).done(function(res){if(res&&(res.result=="1000"||res.result=="SUCCESS")){callback(res.data)}else{searchViewDom.find("."+viewType+"SearchRes .resMainContent").html(noDataHtml)}}).fail(function(err){searchViewDom.find("."+viewType+"SearchRes .resMainContent").html(noDataHtml)})}function listView(viewType,data){if(data&&data.totalRecord>0){var i=0,item,rows=data.rows,rowsLen=rows.length,resHtml="",prodObj={},pageDivideHtml='<div class="pageDivide"><div class="'+viewType+'PageDivide pagination"></div></div>';if(viewType=="prod"){for(i;i<rowsLen;i++){item=rows[i];resHtml+=getProdPanelHtml(item)}resHtml+='<div class="clearfix"></div>'}else if(viewType=="article"){for(i;i<rowsLen;i++){item=rows[i];resHtml+=getArticlePanelHtml(item)}}searchViewDom.find("."+viewType+"SearchRes").find(".resMainContent").html(resHtml);if(searchViewDom.find("."+viewType+"SearchRes").find("."+viewType+"PageDivide").length==0){searchViewDom.find("."+viewType+"SearchRes").find(".resMainContent").append(pageDivideHtml)}dataUtil.page(searchViewDom.find("."+viewType+"PageDivide"),data.pageIndex,data.totalRecord,data.pageMax,data.pageNum);searchViewDom.find("."+viewType+"PageDivide").undelegate("a","click").delegate("a","click",function(e){e.stopPropagation();e.preventDefault();var curPage=Number($(this).closest(".pageDivide").find(".Act").data("page")),dataType=$(this).data("type"),targetPage=1;if(isNaN(dataType)){targetPage=Number($(this).data("page"))}else{if(dataType===1){targetPage=curPage+1}else if(dataType===0){targetPage=curPage-1}}dataUtil.loadPageInfo("",$(this),targetPage,"#searchAllSite_"+mdId+" ."+viewType+"SearchRes");viewByPage(viewType,targetPage,data.pageMax,function(resData){listView(viewType,resData)})})}else{searchViewDom.find("."+viewType+"SearchRes .resMainContent").html(noDataHtml)}}function getProdPanelHtml(itemData){var tempHtml="",prodObj={},tempPricePanelHtml="";prodObj["prodPicUrl"]=itemData.middtbnurl?itemData.middtbnurl:imgPath+"images/nopic.jpg";prodObj["prodPrice"]=itemData.salePrice;prodObj["prodPriceUnit"]=itemData.currencySymbol?itemData.currencySymbol:"￥";tempPricePanelHtml=!itemData.salePrice?'<div class="prodPricePanel textEllipsis"></div>':'<div class="prodPricePanel textEllipsis">'+'<span class="prodPriceUnit">'+prodObj["prodPriceUnit"]+"</span>"+'<span class="prodPriceNum">'+prodObj["prodPrice"]+"</span>"+"</div>";tempHtml='<div class="prodResPanel prodResLink">'+'<a href="displayproduct.html?id='+itemData.productId+'" target="_blank">'+'<div class="prodPic" style="background-image:url('+prodObj.prodPicUrl+')"></div>'+"</a>"+'<div class="prodDetail">'+'<a href="displayproduct.html?id='+itemData.productId+'" target="_blank">'+'<div class="prodTitlePanel">'+'<div class="prodTitle textEllipsis">'+itemData.productName+"</div>"+"</div>"+"</a>"+tempPricePanelHtml+"</div>"+"</div>";return tempHtml}function getArticlePanelHtml(itemData){var articlePicUrl=itemData.fileUrl,articlePubDate=itemData.publishDatetime.split(" ")[0],articleTypeHtml=itemData.typeName?'<span class="articleType articleIntroItem">'+langUtil.article_category+langUtil.Global_symbol+itemData.typeName+"</span>":"",authorHtml=itemData.author?'<span class="articleAuthor articleIntroItem">'+langUtil.article_author+langUtil.Global_symbol+itemData.author+"</span>":"",tempHtml="";if(!/((\/\/)+|(\.)+)/gi.test(articlePicUrl)){articlePicUrl=imgPath+"images/iyong/article-pic.jpg"}tempHtml='<div class="articleResPanel articleResLink">'+'<a href="displaynews.html?id='+itemData.articleId+'" target="_blank">'+'<div class="articlePic inline" style="background-image:url('+articlePicUrl+')"></div>'+"</a>"+'<div class="articleDetail inline">'+'<div class="articleTitlePanel">'+'<a href="displaynews.html?id='+itemData.articleId+'" target="_blank">'+'<div class="articleTitle">'+itemData.articleTitle+"</div>"+"</a>"+'<div class="articleIntro">'+articleTypeHtml+authorHtml+'<span class="articlePubDate articleIntroItem">'+langUtil.Global_data+langUtil.Global_symbol+articlePubDate+"</span>"+'<span class="articleRead">'+readLangStr+" "+itemData.clickTimes+"</span>"+"</div>"+"</div>"+'<div class="articleDesc">'+itemData.articleDescription+"</div>"+"</div>"+"</div>";return tempHtml}}searchExecFn();$("#searchAllSite_"+mdId).on("click",".searchExec",function(){var searchInputVal=$(this).closest(".searchContainer").find(".searchInput").val();searchExecFn(true,searchInputVal)}).on("focus",".searchInput",function(){$(this).on("keyup",function(e){if(e.keyCode===13){var searchInputVal=$(this).val();searchExecFn(true,searchInputVal)}})})};webUtil.searchContentArt=function(mdId,template){var kw=webUtil.decodeGueryString("keyword"),searchVal=kw?kw:"";var searchContentViewDom=$("."+template+"_"+mdId+"_view"),langID=dataUtil.currentLangId(),langObj=dataUtil.getLangObj(langID),reArticles=langObj.reArticles,noDataLangStr=langObj.noData,readLangStr=langObj.read,articleRpcParamObj={memberId:memberId_center.mid,pageIndex:1,pageMax:8,articleTitle:searchVal},searchResHtml='<div class="searchRes">'+'<div class="searchResPage">'+'<div id="articleSearchRes" class="searchResPanel articleSearchRes">'+'<div class="resMainTitle">'+'<span class="resMainTitleIcon kenfor-icons-article2"></span>'+'<span class="resMainTitleText">'+reArticles+"</span>"+"</div>"+'<div class="resMainContent"></div>'+"</div>"+"</div>"+"</div>",noDataHtml='<div class="noInfo"></div><div class="noInfoText">'+noDataLangStr+"</div>";if(searchContentViewDom.find(".searchContentArtView").length===0){searchContentViewDom.append('<div class="searchContentArtView"></div>')}var searchViewDom=searchContentViewDom.find(".searchContentArtView");if(searchViewDom.find(".searchRes").length==0){searchViewDom.append(searchResHtml)}searchViewDom.find(".searchRes .resMainContent").html("");viewByPage(1,8,function(data){listView(data)});function viewByPage(pageIndex,pageMax,callback){var rpcObj={},apiCode="",systemCode="";rpcObj=JSON.parse(JSON.stringify(articleRpcParamObj));apiCode="listArticle";systemCode="blog";rpcObj.pageMax=pageMax;rpcObj.pageIndex=pageIndex;$.when(dataUtil.commonThirdRpc(apiCode,systemCode,rpcObj)).done(function(res){if(res&&(res.result=="1000"||res.result=="SUCCESS")){callback(res.data)}else{searchViewDom.find(".articleSearchRes .resMainContent").html(noDataHtml)}}).fail(function(err){searchViewDom.find(".articleSearchRes .resMainContent").html(noDataHtml)})}function listView(data){if(data&&data.totalRecord>0){var i=0,item,rows=data.rows,rowsLen=rows.length,resHtml="",prodObj={},pageDivideHtml='<div class="pageDivide"><div class="articlePageDivide pagination"></div></div>';for(i;i<rowsLen;i++){item=rows[i];resHtml+=getArticlePanelHtml(item)}searchViewDom.find(".articleSearchRes").find(".resMainContent").html(resHtml);if(searchViewDom.find(".articleSearchRes").find(".articlePageDivide").length==0){searchViewDom.find(".articleSearchRes").find(".resMainContent").append(pageDivideHtml)}dataUtil.page(searchViewDom.find(".articlePageDivide"),data.pageIndex,data.totalRecord,data.pageMax,data.pageNum);searchViewDom.find(".articlePageDivide").undelegate("a","click").delegate("a","click",function(e){e.stopPropagation();e.preventDefault();var curPage=Number($(this).closest(".pageDivide").find(".Act").data("page")),dataType=$(this).data("type"),targetPage=1;if(isNaN(dataType)){targetPage=Number($(this).data("page"))}else{if(dataType===1){targetPage=curPage+1}else if(dataType===0){targetPage=curPage-1}}dataUtil.loadPageInfo("",$(this),targetPage,"#searchContent_"+mdId+"_view .articleSearchRes");viewByPage(targetPage,data.pageMax,function(resData){listView(resData)})})}else{searchViewDom.find(".articleSearchRes .resMainContent").html(noDataHtml)}}function getArticlePanelHtml(itemData){var articlePicUrl=itemData.fileUrl,articlePubDate=itemData.publishDatetime.split(" ")[0],articleTypeHtml=itemData.typeName?'<span class="articleType articleIntroItem">'+langUtil.article_category+langUtil.Global_symbol+itemData.typeName+"</span>":"",authorHtml=itemData.author?'<span class="articleAuthor articleIntroItem">'+langUtil.article_author+langUtil.Global_symbol+itemData.author+"</span>":"",tempHtml="";if(!/((\/\/)+|(\.)+)/gi.test(articlePicUrl)){articlePicUrl=imgPath+"images/iyong/article-pic.jpg"}tempHtml='<div class="articleResPanel articleResLink">'+'<a href="displaynews.html?id='+itemData.articleId+'" target="_blank">'+'<div class="articlePic inline" style="background-image:url('+articlePicUrl+')"></div>'+"</a>"+'<div class="articleDetail inline">'+'<div class="articleTitlePanel">'+'<a href="displaynews.html?id='+itemData.articleId+'" target="_blank">'+'<div class="articleTitle">'+itemData.articleTitle+"</div>"+"</a>"+'<div class="articleIntro">'+articleTypeHtml+authorHtml+'<span class="articlePubDate articleIntroItem">'+langUtil.Global_data+langUtil.Global_symbol+articlePubDate+"</span>"+'<span class="articleRead">'+readLangStr+" "+itemData.clickTimes+"</span>"+"</div>"+"</div>"+'<div class="articleDesc">'+itemData.articleDescription+"</div>"+"</div>"+"</div>";return tempHtml}};webUtil.searchContentProd=function(mdId,template,prodArgObj){var proSrc=prodArgObj.proSrc,lazyclass=prodArgObj.lazyclass,frontRow=prodArgObj.frontRow,isShowPage=prodArgObj.isShowPage,showPage=prodArgObj.showPage,productPropKey=prodArgObj.productPropKey,productPropKeyName=[],isNew=prodArgObj.isNew,imageEffects=prodArgObj.imageEffects,color=prodArgObj.color,opacity=prodArgObj.opacity,modelstyle=prodArgObj.modelstyle,column=prodArgObj.column,productParameter=prodArgObj.productParameter,detailOpen=prodArgObj.detailOpen,pro_w=prodArgObj.pro_w,pro_w_num=pro_w.replace("px",""),pro_h=prodArgObj.pro_h,pro_h_num=pro_h.replace("px",""),parameterName=prodArgObj.parameterName,shopButton=prodArgObj.shopButton,name101=prodArgObj.name101,name102=prodArgObj.name102,langID=dataUtil.currentLangId(),kw=webUtil.decodeGueryString("keyword"),searchVal=kw?kw:"",prodRpcParamObj={mid:memberId_center.mid,langIdList:[langID],pageIndex:1,pageMax:frontRow,productName:searchVal},prodApiCode="listProductByPage",prodSystemCode="ecommerce";if(productPropKey.indexOf("marketPrice")>-1){var marketPriceIndex=productPropKey.indexOf("marketPrice");productPropKey.splice(marketPriceIndex,1,"originalPrice")}productPropKeyName=productPropKey.slice();productPropKeyName.forEach(function(keyItem,keyInd){switch(keyItem){case"salePrice":productPropKeyName[keyInd]="现价";break;case"originalPrice":productPropKeyName[keyInd]="市场价";break;case"productBrand":productPropKeyName[keyInd]="品牌";break;default:return}});prodViewByPage(1,frontRow,function(data){prodListView(data)});function prodViewByPage(pageIndex,pageMax,callback){var rpcObj=JSON.parse(JSON.stringify(prodRpcParamObj));rpcObj.pageMax=pageMax;rpcObj.pageIndex=pageIndex;$.when(dataUtil.commonThirdRpc(prodApiCode,prodSystemCode,rpcObj)).done(function(res){if(res&&(res.result=="1000"||res.result=="SUCCESS")){callback(res.data)}else{console.log(res.data)}}).fail(function(err){console.log(err)})}function prodListView(data){if(data&&data.totalRecord>0){var i=0,item="",rows=data.rows,rowsLen=rows.length,resHtml="",prodPageDivideHtml='<div class="prodPageDivideContainer"><div class="prodPageDivide pagination"></div></div>';for(i;i<rowsLen;i++){item=rows[i];var prodImgUrl=item.fileUrl?item.fileUrl:imgPath+"images/nopic.jpg",propHtml="",propHtmlBelow="",prodImgUrlWithoutProtocol=item.fileUrl?item.fileUrl.replace("http://","//"):imgPath+"images/nopic.jpg";productPropKey.forEach(function(keyItem,keyInd){var keyName=productPropKeyName[keyInd];if(productParameter!=="parameter1"){if(!isNew&&keyItem!=="salePrice"&&keyItem!=="originalPrice"){propHtml+='<p><span class="proParam'+parameterName+'">'+keyName+langUtil.Global_symbol+"</span>"+keyItem+"</p>"}}else{if(!isNew&&keyItem!=="salePrice"&&keyItem!=="originalPrice"){propHtml+='<p><span class="proParam'+parameterName+'">'+keyName+langUtil.Global_symbol+"</span>"+keyItem+"</p>"}else{if(keyItem==="originalPrice"){var targetOriginalPrice=item.originalPrice?item.originalPrice:"";propHtml+='<p class="productPrice productMarketPrice">                                        <span class="proParam'+parameterName+' langText" data-lang="disProducts_marketPrice">'+langUtil.Global_marketPrice+langUtil.Global_symbol+'</span>                                        <s>                                            <span class="langText" data-lang="disProducts_symbol" style="display:none;">'+langUtil.Global_Amount+"</span>                                            "+targetOriginalPrice+"                                        </s>                                    </p>"}else if(keyItem==="salePrice"){var targetSalePrice=item.salePrice?item.salePrice:"";propHtml+='<p class="productPrice productSalePrice">                                        <span class="proParam'+parameterName+' langText" data-lang="disProducts_currentPrice">'+langUtil.Global_currentPrice+langUtil.Global_symbol+'</span>                                        <b>                                            <span class="langText" data-lang="disProducts_symbol" style="display:none;">'+langUtil.Global_Amount+"</span>                                            "+targetSalePrice+"                                        </b>                                    </p>"}else if(keyItem==="productBrand"&&item.productBrand){propHtml+='<p class="productPrice productBrand">                                        <span class="proParam'+parameterName+' langText" data-lang="disProducts_productBrand">'+langUtil.Global_productBrand+langUtil.Global_symbol+"</span>                                        "+item.productBrand+"                                    </p>"}}}});if(productParameter!=="parameter1"){if(item.salePrice){propHtmlBelow+='<p class="productPrice productSalePrice">                                <span class="proParam'+parameterName+' langText" data-lang="disProducts_currentPrice">'+langUtil.Global_currentPrice+langUtil.Global_symbol+'</span>                                <b>                                    <span class="langText" data-lang="disProducts_symbol" style="display:none;">'+langUtil.Global_Amount+"</span>                                    "+item.salePrice+"                                </b>                            </p>"}if(item.originalPrice){propHtmlBelow+='<p class="productPrice productMarketPrice">                                <span class="proParam'+parameterName+' langText" data-lang="disProducts_marketPrice">'+langUtil.Global_marketPrice+langUtil.Global_symbol+'</span>                                <s>                                    <span class="langText" data-lang="disProducts_symbol" style="display:none;">'+langUtil.Global_Amount+"</span>                                    "+item.originalPrice+"                                </s>                            </p>"}if(item.productBrand){propHtmlBelow+='<p class="productBrand">                                <span class="proParam'+parameterName+' langText" data-lang="disProducts_productBrand">'+langUtil.Global_productBrand+langUtil.Global_symbol+'</span>                                <s>                                    <font class="langText" data-lang="disProducts_symbol" style="display:none;">'+langUtil.Global_Amount+"</font>                                    "+item.productBrand+"                                </s>                            </p>"}}resHtml+='<li class="imgDiv imgDiv'+column+'">                        <div class="productImgForm_c">                            <a href="displayproduct.html?id='+item.productId+'" class="productEffects" target="'+detailOpen+'">                                <span></span>                            </a>                            <a href="displayproduct.html?id='+item.productId+'" class="productImgForm" data-pwidth="'+pro_w_num+'" data-pheight="'+pro_h_num+'" style="width:'+pro_w+"; height:"+pro_h+';" target="'+detailOpen+'">                                <img class="'+lazyclass+'" '+proSrc+'="'+prodImgUrl+'">                            </a>                        </div>                        <div class="productDetailForm1" data-href="displayproduct.html?id='+item.productId+'" data-target="'+detailOpen+'">                            <div class="productDetailForm2">                                <div class="productDetailForm">                                    <a href="displayproduct.html?id='+item.productId+'" target="'+detailOpen+'" class="productTitleForm">'+item.productName+'</a>                                    <div class="productDetail">                                        '+propHtml+"                                        "+propHtmlBelow+'                                    </div>                                </div>                                <div class="productShopCart productShopCartDisplay'+shopButton+'">                                    <b></b>                                    <a href="javascript:void(0)" class="langText" data-lang="products_buy" data-src="'+prodImgUrlWithoutProtocol+'" data-id="'+item.productId+'">'+langUtil.products_buy+"</a>                                </div>                            </div>                        </div>                    </li>                "}$("#"+mdId+" #proList_"+mdId).html(resHtml);$("#"+mdId+" .productShopCart a").off("click").on("click",webUtil.addCar);if(imageEffects=="effects2"||imageEffects=="effects4"||imageEffects=="effects5"){webUtil.setProductEffects(mdId,template,imageEffects,color,opacity)}var switching=!name101||name101==""?1:name101;var rolling=!name102||name102==""?50:name102;webUtil.setProductModel(mdId,template,modelstyle,column,productParameter,switching,rolling);webUtil.lazyloadList("#"+template+"_"+mdId+" img.lazy",".productImgForm");if(isShowPage=="1"&&showPage=="1"){if($("#"+mdId+" .view .page_style_dh").length>0){$("#"+mdId+" .view .page_style_dh").remove()}if($("#"+mdId+" .view").find(".prodPageDivideContainer").length==0){$("#"+mdId+" .view .pro_form_mainDiv").after(prodPageDivideHtml)}dataUtil.page($("#"+mdId+" .prodPageDivide"),data.pageIndex,data.totalRecord,data.pageMax,data.pageNum);$("#"+mdId+" .prodPageDivide").undelegate("a","click").delegate("a","click",function(e){e.stopPropagation();e.preventDefault();var curPage=Number($(this).closest(".prodPageDivideContainer").find(".Act").data("page")),dataType=$(this).data("type"),targetPage=1;if(isNaN(dataType)){targetPage=Number($(this).data("page"))}else{if(dataType===1){targetPage=curPage+1}else if(dataType===0){targetPage=curPage-1}}dataUtil.loadPageInfo("",$(this),targetPage,"#"+mdId+" #proList_"+mdId);prodViewByPage(targetPage,data.pageMax,function(resData){prodListView(resData)})})}}}};webUtil.searchContentMain_bak=function(mdId,template,searchArgObj){var langID=dataUtil.currentLangId(),langObj=dataUtil.getLangObj(langID),backward=langObj.backward,noDataLangStr=langObj.noData,readLangStr=langObj.read,searchRangeStr=searchArgObj.searchRange,articleSearchName=searchArgObj.articleSearchName?searchArgObj.articleSearchName:langObj.reArticles,productSearchName=searchArgObj.productSearchName?searchArgObj.productSearchName:langObj.reProducts,isKeywordShown=searchArgObj.isKeywordShown=="true"?true:false,isSearchboxShown=searchArgObj.isSearchboxShown=="true"?true:false,prodArgObj=searchArgObj.prodArgObj,proSrc=prodArgObj.proSrc,lazyclass=prodArgObj.lazyclass,frontRow=prodArgObj.frontRow,isShowPage=prodArgObj.isShowPage,showPage=prodArgObj.showPage,productPropKey=prodArgObj.productPropKey,productPropKeyName=[],isNew=prodArgObj.isNew,imageEffects=prodArgObj.imageEffects,color=prodArgObj.color,opacity=prodArgObj.opacity,modelstyle=prodArgObj.modelstyle,column=prodArgObj.column,productParameter=prodArgObj.productParameter,detailOpen=prodArgObj.detailOpen,pro_w=prodArgObj.pro_w,pro_w_num=pro_w.replace("px",""),pro_h=prodArgObj.pro_h,pro_h_num=pro_h.replace("px",""),parameterName=prodArgObj.parameterName,shopButton=prodArgObj.shopButton,name101=prodArgObj.name101,name102=prodArgObj.name102,langID=dataUtil.currentLangId(),prodApiCode="listProductByPage",prodSystemCode="ecommerce",mid=memberId_center.mid,searchViewDom=$("."+template+"_"+mdId+"_view"),sessionReturnPageUrl=sessionStorage.getItem("searchReturnPage")||"/index.html",returnPageUrl=sessionReturnPageUrl?sessionReturnPageUrl:window.location.href;if(productPropKey.indexOf("marketPrice")>-1){var marketPriceIndex=productPropKey.indexOf("marketPrice");productPropKey.splice(marketPriceIndex,1,"originalPrice")}productPropKeyName=productPropKey.slice();productPropKeyName.forEach(function(keyItem,keyInd){switch(keyItem){case"salePrice":productPropKeyName[keyInd]="现价";break;case"originalPrice":productPropKeyName[keyInd]="市场价";break;case"productBrand":productPropKeyName[keyInd]="品牌";break;default:return}});function searchExecFn(isSearchInputExec,searchInputVal){var searchVal=isSearchInputExec?searchInputVal:webUtil.decodeGueryString("keyword")||"",prodRpcParamObj={mid:memberId_center.mid,langIdList:[langID],pageIndex:1,pageMax:frontRow,productName:searchVal},articleRpcParamObj={memberId:mid,pageIndex:1,pageMax:8,articleTitle:searchVal},oldProdHtml='<div class="pro_form_mainDiv '+modelstyle+'">                    <div class="hd">                        <a class="prev public_prev" href="javascript:void(0);"></a>                        <a class="next public_next" href="javascript:void(0);"></a>                    </div>                    <div class="bd pro_form_div">                        <ul id="proList_'+mdId+'" class="picList '+imageEffects+" "+productParameter+'">                        </ul>                    </div>                </div>',searchBoxInResHtml=isSearchboxShown===true?'<div class="searchBoxInRes searchContainer">'+'<div class="searchCoverInRes"></div>'+'<span class="searchInputPanelInRes">'+'<input type="text" class="searchInput getSearchVal" value="'+searchVal+'"/>'+"</span>"+'<span class="searchIconInRes searchExec kenfor-icons-search"></span>'+"</div>":"",prodSearchResHtml=searchRangeStr.indexOf("product")>-1?'<div class="searchResPanel prodSearchRes">'+'<div class="resMainTitle">'+'<span class="resMainTitleIcon kenfor-icons-briefcase2"></span>'+'<span class="resMainTitleText">'+productSearchName+"</span>"+"</div>"+'<div class="resMainContent">'+oldProdHtml+"</div>"+"</div>":"",articleSearchResHtml=searchRangeStr.indexOf("article")>-1?'<div class="searchResPanel articleSearchRes">'+'<div class="resMainTitle">'+'<span class="resMainTitleIcon kenfor-icons-article2"></span>'+'<span class="resMainTitleText">'+articleSearchName+"</span>"+"</div>"+'<div class="resMainContent"></div>'+"</div>":"",keywordPanelHtml=isKeywordShown&&searchVal?'<div class="keywordPanel">'+searchVal+"</div>":"",searchResHtml='<div class="searchRes oldSearchContent">'+searchBoxInResHtml+'<div class="searchResHead">'+'<div class="searchReturn" onclick="window.location.href=\''+returnPageUrl+"'\">"+'<span class="searchReturnIcon icon iconfont kenfor-icons-back2"></span>'+'<span class="searchReturnText">'+backward+"</span>"+"</div>"+keywordPanelHtml+"</div>"+'<div class="searchResPage">'+prodSearchResHtml+articleSearchResHtml+"</div>"+"</div>",noDataHtml='<div class="noInfo"></div><div class="noInfoText">'+noDataLangStr+"</div>";searchViewDom.html(searchResHtml);searchViewDom.find(".articleSearchRes .resMainContent").html("").end().find("#proList_"+mdId).html("");if(searchRangeStr.indexOf("product")>-1){viewByPage("prod",1,frontRow,function(data){prodListView(data)})}if(searchRangeStr.indexOf("article")>-1){viewByPage("article",1,8,function(data){articleListView(data)})}function viewByPage(viewType,pageIndex,pageMax,callback){var rpcObj={},apiCode="",systemCode="";if(viewType=="prod"){rpcObj=JSON.parse(JSON.stringify(prodRpcParamObj));apiCode="listProductByPage";systemCode="ecommerce"}else if(viewType=="article"){rpcObj=JSON.parse(JSON.stringify(articleRpcParamObj));apiCode="listArticle";systemCode="blog"}else{return false}rpcObj.pageMax=pageMax;rpcObj.pageIndex=pageIndex;$.when(dataUtil.commonThirdRpc(apiCode,systemCode,rpcObj)).done(function(res){if(res&&(res.result=="1000"||res.result=="SUCCESS")){callback(res.data)}else{searchViewDom.find("."+viewType+"SearchRes .resMainContent").html(noDataHtml)}}).fail(function(err){searchViewDom.find("."+viewType+"SearchRes .resMainContent").html(noDataHtml)})}function prodListView(data){if(data&&data.totalRecord>0){var i=0,item="",rows=data.rows,rowsLen=rows.length,resHtml="",prodPageDivideHtml='<div class="prodPageDivideContainer"><div class="prodPageDivide pagination"></div></div>';for(i;i<rowsLen;i++){item=rows[i];var prodImgUrl=item.fileUrl?item.fileUrl:imgPath+"images/nopic.jpg",propHtml="",propHtmlBelow="",prodImgUrlWithoutProtocol=item.fileUrl?item.fileUrl.replace("http://","//"):imgPath+"images/nopic.jpg";productPropKey.forEach(function(keyItem,keyInd){var keyName=productPropKeyName[keyInd];if(productParameter!=="parameter1"){if(!isNew&&keyItem!=="salePrice"&&keyItem!=="originalPrice"){propHtml+='<p><span class="proParam'+parameterName+'">'+keyName+langUtil.Global_symbol+"</span>"+keyItem+"</p>"}}else{if(!isNew&&keyItem!=="salePrice"&&keyItem!=="originalPrice"){propHtml+='<p><span class="proParam'+parameterName+'">'+keyName+langUtil.Global_symbol+"</span>"+keyItem+"</p>"}else{if(keyItem==="originalPrice"){var targetOriginalPrice=item.originalPrice?item.originalPrice:"";propHtml+='<p class="productPrice productMarketPrice">                                            <span class="proParam'+parameterName+' langText" data-lang="disProducts_marketPrice">'+langUtil.Global_marketPrice+langUtil.Global_symbol+'</span>                                            <s>                                                <span class="langText" data-lang="disProducts_symbol" style="display:none;">'+langUtil.Global_Amount+"</span>                                                "+targetOriginalPrice+"                                            </s>                                        </p>"}else if(keyItem==="salePrice"){var targetSalePrice=item.salePrice?item.salePrice:"";propHtml+='<p class="productPrice productSalePrice">                                            <span class="proParam'+parameterName+' langText" data-lang="disProducts_currentPrice">'+langUtil.Global_currentPrice+langUtil.Global_symbol+'</span>                                            <b>                                                <span class="langText" data-lang="disProducts_symbol" style="display:none;">'+langUtil.Global_Amount+"</span>                                                "+targetSalePrice+"                                            </b>                                        </p>"}else if(keyItem==="productBrand"&&item.productBrand){propHtml+='<p class="productPrice productBrand">                                            <span class="proParam'+parameterName+' langText" data-lang="disProducts_productBrand">'+langUtil.Global_productBrand+langUtil.Global_symbol+"</span>                                            "+item.productBrand+"                                        </p>"}}}});if(productParameter!=="parameter1"){if(item.salePrice){propHtmlBelow+='<p class="productPrice productSalePrice">                                    <span class="proParam'+parameterName+' langText" data-lang="disProducts_currentPrice">'+langUtil.Global_currentPrice+langUtil.Global_symbol+'</span>                                    <b>                                        <span class="langText" data-lang="disProducts_symbol" style="display:none;">'+langUtil.Global_Amount+"</span>                                        "+item.salePrice+"                                    </b>                                </p>"}if(item.originalPrice){propHtmlBelow+='<p class="productPrice productMarketPrice">                                    <span class="proParam'+parameterName+' langText" data-lang="disProducts_marketPrice">'+langUtil.Global_marketPrice+langUtil.Global_symbol+'</span>                                    <s>                                        <span class="langText" data-lang="disProducts_symbol" style="display:none;">'+langUtil.Global_Amount+"</span>                                        "+item.originalPrice+"                                    </s>                                </p>"}if(item.productBrand){propHtmlBelow+='<p class="productBrand">                                    <span class="proParam'+parameterName+' langText" data-lang="disProducts_productBrand">'+langUtil.Global_productBrand+langUtil.Global_symbol+'</span>                                    <s>                                        <font class="langText" data-lang="disProducts_symbol" style="display:none;">'+langUtil.Global_Amount+"</font>                                        "+item.productBrand+"                                    </s>                                </p>"}}resHtml+='<li class="imgDiv imgDiv'+column+'">                            <div class="productImgForm_c">                                <a href="displayproduct.html?id='+item.productId+'" class="productEffects" target="'+detailOpen+'">                                    <span></span>                                </a>                                <a href="displayproduct.html?id='+item.productId+'" class="productImgForm" data-pwidth="'+pro_w_num+'" data-pheight="'+pro_h_num+'" style="width:'+pro_w+"; height:"+pro_h+';" target="'+detailOpen+'">                                    <img class="'+lazyclass+'" '+proSrc+'="'+prodImgUrl+'">                                </a>                            </div>                            <div class="productDetailForm1" data-href="displayproduct.html?id='+item.productId+'" data-target="'+detailOpen+'">                                <div class="productDetailForm2">                                    <div class="productDetailForm">                                        <a href="displayproduct.html?id='+item.productId+'" target="'+detailOpen+'" class="productTitleForm">'+item.productName+'</a>                                        <div class="productDetail">                                            '+propHtml+"                                            "+propHtmlBelow+'                                        </div>                                    </div>                                    <div class="productShopCart productShopCartDisplay'+shopButton+'">                                        <b></b>                                        <a href="javascript:void(0)" class="langText" data-lang="products_buy" data-src="'+prodImgUrlWithoutProtocol+'" data-id="'+item.productId+'">'+langUtil.products_buy+"</a>                                    </div>                                </div>                            </div>                        </li>                    "}$("#"+mdId+" #proList_"+mdId).html(resHtml);$("#"+mdId+" .productShopCart a").off("click").on("click",webUtil.addCar);if(imageEffects=="effects2"||imageEffects=="effects4"||imageEffects=="effects5"){webUtil.setProductEffects(mdId,template,imageEffects,color,opacity)}var switching=!name101||name101==""?1:name101;var rolling=!name102||name102==""?50:name102;webUtil.setProductModel(mdId,template,modelstyle,column,productParameter,switching,rolling);webUtil.lazyloadList("#"+template+"_"+mdId+" img.lazy",".productImgForm");if(isShowPage=="1"&&showPage=="1"){if($("#"+mdId+" .view .page_style_dh").length>0){$("#"+mdId+" .view .page_style_dh").remove()}if($("#"+mdId+" .view").find(".prodPageDivideContainer").length==0){$("#"+mdId+" .view .pro_form_mainDiv").after(prodPageDivideHtml)}dataUtil.page($("#"+mdId+" .prodPageDivide"),data.pageIndex,data.totalRecord,data.pageMax,data.pageNum);$("#"+mdId+" .prodPageDivide").undelegate("a","click").delegate("a","click",function(e){e.stopPropagation();e.preventDefault();var curPage=Number($(this).closest(".prodPageDivideContainer").find(".Act").data("page")),dataType=$(this).data("type"),targetPage=1;if(isNaN(dataType)){targetPage=Number($(this).data("page"))}else{if(dataType===1){targetPage=curPage+1}else if(dataType===0){targetPage=curPage-1}}dataUtil.loadPageInfo("",$(this),targetPage,"#"+mdId+" #proList_"+mdId);viewByPage("prod",targetPage,data.pageMax,function(resData){prodListView(resData)})})}}else{searchViewDom.find(".prodSearchRes .resMainContent").html(noDataHtml)}}function articleListView(data){if(data&&data.totalRecord>0){var i=0,item,rows=data.rows,rowsLen=rows.length,resHtml="",pageDivideHtml='<div class="pageDivide"><div class="articlePageDivide pagination"></div></div>';for(i;i<rowsLen;i++){item=rows[i];resHtml+=getArticlePanelHtml(item)}searchViewDom.find(".articleSearchRes .resMainContent").html(resHtml);if(searchViewDom.find(".articleSearchRes .articlePageDivide").length==0){searchViewDom.find(".articleSearchRes .resMainContent").append(pageDivideHtml)}dataUtil.page(searchViewDom.find(".articlePageDivide"),data.pageIndex,data.totalRecord,data.pageMax,data.pageNum);searchViewDom.find(".articlePageDivide").undelegate("a","click").delegate("a","click",function(e){e.stopPropagation();e.preventDefault();var curPage=Number($(this).closest(".pageDivide").find(".Act").data("page")),dataType=$(this).data("type"),targetPage=1;if(isNaN(dataType)){targetPage=Number($(this).data("page"))}else{if(dataType===1){targetPage=curPage+1}else if(dataType===0){targetPage=curPage-1}}dataUtil.loadPageInfo("",$(this),targetPage,"#searchContent_"+mdId+"_view .articleSearchRes");viewByPage("article",targetPage,data.pageMax,function(resData){articleListView(resData)})})}else{searchViewDom.find(".articleSearchRes .resMainContent").html(noDataHtml)}}function getArticlePanelHtml(itemData){var articlePicUrl=itemData.fileUrl,articlePubDate=itemData.publishDatetime.split(" ")[0],articleTypeHtml=itemData.typeName?'<span class="articleType articleIntroItem">'+langUtil.article_category+langUtil.Global_symbol+itemData.typeName+"</span>":"",authorHtml=itemData.author?'<span class="articleAuthor articleIntroItem">'+langUtil.article_author+langUtil.Global_symbol+itemData.author+"</span>":"",tempHtml="";if(!/((\/\/)+|(\.)+)/gi.test(articlePicUrl)){articlePicUrl=imgPath+"images/iyong/article-pic.jpg"}tempHtml='<div class="articleResPanel articleResLink">'+'<a href="displaynews.html?id='+itemData.articleId+'" target="_blank">'+'<div class="articlePic inline" style="background-image:url('+articlePicUrl+')"></div>'+"</a>"+'<div class="articleDetail inline">'+'<div class="articleTitlePanel">'+'<a href="displaynews.html?id='+itemData.articleId+'" target="_blank">'+'<div class="articleTitle">'+itemData.articleTitle+"</div>"+"</a>"+'<div class="articleIntro">'+articleTypeHtml+authorHtml+'<span class="articlePubDate articleIntroItem">'+langUtil.Global_data+langUtil.Global_symbol+articlePubDate+"</span>"+'<span class="articleRead">'+readLangStr+" "+itemData.clickTimes+"</span>"+"</div>"+"</div>"+'<div class="articleDesc">'+itemData.articleDescription+"</div>"+"</div>"+"</div>";return tempHtml}}searchExecFn();searchViewDom.on("click",".searchExec",function(){var searchInputVal=$(this).closest(".searchContainer").find(".searchInput").val();searchExecFn(true,searchInputVal)}).on("focus",".searchInput",function(){$(this).on("keyup",function(e){if(e.keyCode===13){var searchInputVal=$(this).val();searchExecFn(true,searchInputVal)}})})};webUtil.searchContentMain=function(mdId,template,searchArgObj){var langID=dataUtil.currentLangId(),langObj=dataUtil.getLangObj(langID),backward=langObj.backward,noDataLangStr=langObj.noData,readLangStr=langObj.read,articleSearchName=searchArgObj.articleSearchName?searchArgObj.articleSearchName:langObj.blog,productSearchName=searchArgObj.productSearchName?searchArgObj.productSearchName:langUtil.orderlist_goods,isKeywordShown=searchArgObj.isKeywordShown=="true"?true:false,isSearchboxShown=searchArgObj.isSearchboxShown=="true"?true:false,searchKeyWord=searchArgObj.searchKeyWord?searchArgObj.searchKeyWord:"",compVersion=searchArgObj.compVersion,prodArgObj=searchArgObj.prodArgObj,prodApiCode="listProductByPage",prodSystemCode="ecommerce",mid=memberId_center.mid,searchViewDom=$("."+template+"_"+mdId+"_view"),typeHashObj={0:"product",1:"article"},getGueryType=webUtil.decodeGueryString("type"),searchRangeStr=getGueryType?getGueryType.replace(/(\d)/g,function(match,p1){return typeHashObj[p1]}):"product_article",sessionReturnPageUrl=sessionStorage.getItem("searchReturnPage")||"/index.html",returnPageUrl=sessionReturnPageUrl?sessionReturnPageUrl:window.location.href;if(typeof prodArgObj!=="undefined"){var proSrc=prodArgObj.proSrc,lazyclass=prodArgObj.lazyclass,frontRow=prodArgObj.frontRow,isShowPage=prodArgObj.isShowPage,showPage=prodArgObj.showPage,productPropKey=prodArgObj.productPropKey,productPropKeyName=[],isNew=prodArgObj.isNew,imageEffects=prodArgObj.imageEffects,color=prodArgObj.color,opacity=prodArgObj.opacity,modelstyle=prodArgObj.modelstyle,column=prodArgObj.column,productParameter=prodArgObj.productParameter,detailOpen=prodArgObj.detailOpen,pro_w=prodArgObj.pro_w,pro_w_num=pro_w.replace("px",""),pro_h=prodArgObj.pro_h,pro_h_num=pro_h.replace("px",""),parameterName=prodArgObj.parameterName,shopButton=prodArgObj.shopButton,name101=prodArgObj.name101,name102=prodArgObj.name102;if(productPropKey.indexOf("marketPrice")>-1){var marketPriceIndex=productPropKey.indexOf("marketPrice");productPropKey.splice(marketPriceIndex,1,"originalPrice")}productPropKeyName=productPropKey.slice();productPropKeyName.forEach(function(keyItem,keyInd){switch(keyItem){case"salePrice":productPropKeyName[keyInd]="现价";break;case"originalPrice":productPropKeyName[keyInd]="市场价";break;case"productBrand":productPropKeyName[keyInd]="品牌";break;default:return}})}function searchExecFn(isSearchInputExec,searchInputVal){var searchVal=isSearchInputExec?searchInputVal:searchKeyWord||"",prodRpcParamObj={mid:memberId_center.mid,langIdList:[langID],pageIndex:1,pageMax:frontRow,productName:searchVal},articleRpcParamObj={memberId:mid,pageIndex:1,pageMax:8,articleTitle:searchVal},oldProdHtml='<div class="pro_form_mainDiv '+modelstyle+'">                    <div class="hd">                        <a class="prev public_prev" href="javascript:void(0);"></a>                        <a class="next public_next" href="javascript:void(0);"></a>                    </div>                    <div class="bd pro_form_div">                        <ul id="proList_'+mdId+'" class="picList '+imageEffects+" "+productParameter+'">                        </ul>                    </div>                </div>',prodHtml=compVersion==="0"?oldProdHtml:"",searchBoxInResHtml=isSearchboxShown===true?'<div class="searchBoxInRes searchContainer">'+'<div class="searchCoverInRes"></div>'+'<span class="searchInputPanelInRes">'+'<input type="text" class="searchInput getSearchVal" value="'+searchVal+'"/>'+"</span>"+'<span class="searchIconInRes searchExec kenfor-icons-search"></span>'+"</div>":"",prodSearchResHtml=searchRangeStr.indexOf("product")>-1?'<div class="searchResPanel prodSearchRes">'+'<div class="resMainTitle">'+'<span class="resMainTitleIcon kenfor-icons-briefcase2"></span>'+'<span class="resMainTitleText">'+productSearchName+"</span>"+"</div>"+'<div class="resMainContent">'+prodHtml+"</div>"+"</div>":"",articleSearchResHtml=searchRangeStr.indexOf("article")>-1?'<div class="searchResPanel articleSearchRes">'+'<div class="resMainTitle">'+'<span class="resMainTitleIcon kenfor-icons-article2"></span>'+'<span class="resMainTitleText">'+articleSearchName+"</span>"+"</div>"+'<div class="resMainContent"></div>'+"</div>":"",keywordPanelHtml=isKeywordShown&&searchVal?'<div class="keywordPanel">'+searchVal+"</div>":"",searchResHtml='<div class="searchRes oldSearchContent">'+searchBoxInResHtml+'<div class="searchResHead">'+'<div class="searchReturn" onclick="window.location.href=\''+returnPageUrl+"'\">"+'<span class="searchReturnIcon icon iconfont kenfor-icons-back2"></span>'+'<span class="searchReturnText">'+backward+"</span>"+"</div>"+keywordPanelHtml+"</div>"+'<div class="searchResPage">'+prodSearchResHtml+articleSearchResHtml+"</div>"+"</div>",noDataHtml='<div class="noInfo"></div><div class="noInfoText">'+noDataLangStr+"</div>";searchViewDom.html(searchResHtml);searchViewDom.find(".articleSearchRes .resMainContent").html("");if(compVersion==="0"){searchViewDom.find("#proList_"+mdId).html("")}else{searchViewDom.find(".prodSearchRes .resMainContent").html("")}if(searchRangeStr.indexOf("product")>-1){if(compVersion==="0"){viewByPage("prod",1,frontRow,function(data){prodListView_old(data)})}else{viewByPage("prod",1,8,function(data){prodListView_new(data)})}}if(searchRangeStr.indexOf("article")>-1){viewByPage("article",1,8,function(data){articleListView(data)})}function viewByPage(viewType,pageIndex,pageMax,callback){var rpcObj={},apiCode="",systemCode="";if(viewType=="prod"){rpcObj=JSON.parse(JSON.stringify(prodRpcParamObj));apiCode="listProductByPage";systemCode="ecommerce"}else if(viewType=="article"){rpcObj=JSON.parse(JSON.stringify(articleRpcParamObj));apiCode="listArticle";systemCode="blog"}else{return false}rpcObj.pageMax=pageMax;rpcObj.pageIndex=pageIndex;$.when(dataUtil.commonThirdRpc(apiCode,systemCode,rpcObj)).done(function(res){if(res&&(res.result=="1000"||res.result=="SUCCESS")){callback(res.data)}else{searchViewDom.find("."+viewType+"SearchRes .resMainContent").html(noDataHtml)}}).fail(function(err){searchViewDom.find("."+viewType+"SearchRes .resMainContent").html(noDataHtml)})}function prodListView_old(data){if(data&&data.totalRecord>0){var i=0,item="",rows=data.rows,rowsLen=rows.length,resHtml="",prodPageDivideHtml='<div class="prodPageDivideContainer"><div class="prodPageDivide pagination"></div></div>';for(i;i<rowsLen;i++){item=rows[i];var prodImgUrl=item.fileUrl?item.fileUrl:imgPath+"images/nopic.jpg",propHtml="",propHtmlBelow="",prodImgUrlWithoutProtocol=item.fileUrl?item.fileUrl.replace("http://","//"):imgPath+"images/nopic.jpg";productPropKey.forEach(function(keyItem,keyInd){var keyName=productPropKeyName[keyInd];if(productParameter!=="parameter1"){if(!isNew&&keyItem!=="salePrice"&&keyItem!=="originalPrice"){propHtml+='<p><span class="proParam'+parameterName+'">'+keyName+langUtil.Global_symbol+"</span>"+keyItem+"</p>"}}else{if(!isNew&&keyItem!=="salePrice"&&keyItem!=="originalPrice"){propHtml+='<p><span class="proParam'+parameterName+'">'+keyName+langUtil.Global_symbol+"</span>"+keyItem+"</p>"}else{if(keyItem==="originalPrice"){var targetOriginalPrice=item.originalPrice?item.originalPrice:"";propHtml+='<p class="productPrice productMarketPrice">                                            <span class="proParam'+parameterName+' langText" data-lang="disProducts_marketPrice">'+langUtil.Global_marketPrice+langUtil.Global_symbol+'</span>                                            <s>                                                <span class="langText" data-lang="disProducts_symbol" style="display:none;">'+langUtil.Global_Amount+"</span>                                                "+targetOriginalPrice+"                                            </s>                                        </p>"}else if(keyItem==="salePrice"){var targetSalePrice=item.salePrice?item.salePrice:"";propHtml+='<p class="productPrice productSalePrice">                                            <span class="proParam'+parameterName+' langText" data-lang="disProducts_currentPrice">'+langUtil.Global_currentPrice+langUtil.Global_symbol+'</span>                                            <b>                                                <span class="langText" data-lang="disProducts_symbol" style="display:none;">'+langUtil.Global_Amount+"</span>                                                "+targetSalePrice+"                                            </b>                                        </p>"}else if(keyItem==="productBrand"&&item.productBrand){propHtml+='<p class="productPrice productBrand">                                            <span class="proParam'+parameterName+' langText" data-lang="disProducts_productBrand">'+langUtil.Global_productBrand+langUtil.Global_symbol+"</span>                                            "+item.productBrand+"                                        </p>"}}}});if(productParameter!=="parameter1"){if(item.salePrice){propHtmlBelow+='<p class="productPrice productSalePrice">                                    <span class="proParam'+parameterName+' langText" data-lang="disProducts_currentPrice">'+langUtil.Global_currentPrice+langUtil.Global_symbol+'</span>                                    <b>                                        <span class="langText" data-lang="disProducts_symbol" style="display:none;">'+langUtil.Global_Amount+"</span>                                        "+item.salePrice+"                                    </b>                                </p>"}if(item.originalPrice){propHtmlBelow+='<p class="productPrice productMarketPrice">                                    <span class="proParam'+parameterName+' langText" data-lang="disProducts_marketPrice">'+langUtil.Global_marketPrice+langUtil.Global_symbol+'</span>                                    <s>                                        <span class="langText" data-lang="disProducts_symbol" style="display:none;">'+langUtil.Global_Amount+"</span>                                        "+item.originalPrice+"                                    </s>                                </p>"}if(item.productBrand){propHtmlBelow+='<p class="productBrand">                                    <span class="proParam'+parameterName+' langText" data-lang="disProducts_productBrand">'+langUtil.Global_productBrand+langUtil.Global_symbol+'</span>                                    <s>                                        <font class="langText" data-lang="disProducts_symbol" style="display:none;">'+langUtil.Global_Amount+"</font>                                        "+item.productBrand+"                                    </s>                                </p>"}}resHtml+='<li class="imgDiv imgDiv'+column+'">                            <div class="productImgForm_c">                                <a href="displayproduct.html?id='+item.productId+'" class="productEffects" target="'+detailOpen+'">                                    <span></span>                                </a>                                <a href="displayproduct.html?id='+item.productId+'" class="productImgForm" data-pwidth="'+pro_w_num+'" data-pheight="'+pro_h_num+'" style="width:'+pro_w+"; height:"+pro_h+';" target="'+detailOpen+'">                                    <img class="'+lazyclass+'" '+proSrc+'="'+prodImgUrl+'">                                </a>                            </div>                            <div class="productDetailForm1" data-href="displayproduct.html?id='+item.productId+'" data-target="'+detailOpen+'">                                <div class="productDetailForm2">                                    <div class="productDetailForm">                                        <a href="displayproduct.html?id='+item.productId+'" target="'+detailOpen+'" class="productTitleForm">'+item.productName+'</a>                                        <div class="productDetail">                                            '+propHtml+"                                            "+propHtmlBelow+'                                        </div>                                    </div>                                    <div class="productShopCart productShopCartDisplay'+shopButton+'">                                        <b></b>                                        <a href="javascript:void(0)" class="langText" data-lang="products_buy" data-src="'+prodImgUrlWithoutProtocol+'" data-id="'+item.productId+'">'+langUtil.products_buy+"</a>                                    </div>                                </div>                            </div>                        </li>                    "}$("#"+mdId+" #proList_"+mdId).html(resHtml);$("#"+mdId+" .productShopCart a").off("click").on("click",webUtil.addCar);if(imageEffects=="effects2"||imageEffects=="effects4"||imageEffects=="effects5"){webUtil.setProductEffects(mdId,template,imageEffects,color,opacity)}var switching=!name101||name101==""?1:name101;var rolling=!name102||name102==""?50:name102;webUtil.setProductModel(mdId,template,modelstyle,column,productParameter,switching,rolling);webUtil.lazyloadList("#"+template+"_"+mdId+" img.lazy",".productImgForm");if(isShowPage=="1"&&showPage=="1"){if($("#"+mdId+" .view .page_style_dh").length>0){$("#"+mdId+" .view .page_style_dh").remove()}if($("#"+mdId+" .view").find(".prodPageDivideContainer").length==0){$("#"+mdId+" .view .pro_form_mainDiv").after(prodPageDivideHtml)}dataUtil.page($("#"+mdId+" .prodPageDivide"),data.pageIndex,data.totalRecord,data.pageMax,data.pageNum);$("#"+mdId+" .prodPageDivide").undelegate("a","click").delegate("a","click",function(e){e.stopPropagation();e.preventDefault();var curPage=Number($(this).closest(".prodPageDivideContainer").find(".Act").data("page")),dataType=$(this).data("type"),targetPage=1;if(isNaN(dataType)){targetPage=Number($(this).data("page"))}else{if(dataType===1){targetPage=curPage+1}else if(dataType===0){targetPage=curPage-1}}dataUtil.loadPageInfo("",$(this),targetPage,"#"+mdId+" #proList_"+mdId);viewByPage("prod",targetPage,data.pageMax,function(resData){prodListView_old(resData)})})}}else{searchViewDom.find(".prodSearchRes .resMainContent").html(noDataHtml)}}function prodListView_new(data){if(data&&data.totalRecord>0){var i=0,item,rows=data.rows,rowsLen=rows.length,resHtml="",pageDivideHtml='<div class="pageDivide"><div class="prodPageDivide pagination"></div></div>';for(i;i<rowsLen;i++){item=rows[i];resHtml+=getProdPanelHtml(item)}searchViewDom.find(".prodSearchRes .resMainContent").html(resHtml);if(searchViewDom.find(".prodSearchRes").find(".prodPageDivide").length==0){searchViewDom.find(".prodSearchRes").find(".resMainContent").append(pageDivideHtml)}dataUtil.page(searchViewDom.find(".prodPageDivide"),data.pageIndex,data.totalRecord,data.pageMax,data.pageNum);searchViewDom.find(".prodPageDivide").undelegate("a","click").delegate("a","click",function(e){e.stopPropagation();e.preventDefault();var curPage=Number($(this).closest(".pageDivide").find(".Act").data("page")),dataType=$(this).data("type"),targetPage=1;if(isNaN(dataType)){targetPage=Number($(this).data("page"))}else{if(dataType===1){targetPage=curPage+1}else if(dataType===0){targetPage=curPage-1}}dataUtil.loadPageInfo("",$(this),targetPage,".searchContent_"+id+"_view .prodSearchRes");viewByPage(targetPage,data.pageMax,function(resData){prodListView_new(resData)})})}else{searchViewDom.find(".prodSearchRes .resMainContent").html(noDataHtml)}}function articleListView(data){if(data&&data.totalRecord>0){var i=0,item,rows=data.rows,rowsLen=rows.length,resHtml="",pageDivideHtml='<div class="pageDivide"><div class="articlePageDivide pagination"></div></div>';for(i;i<rowsLen;i++){item=rows[i];resHtml+=getArticlePanelHtml(item)}searchViewDom.find(".articleSearchRes .resMainContent").html(resHtml);if(searchViewDom.find(".articleSearchRes .articlePageDivide").length==0){searchViewDom.find(".articleSearchRes .resMainContent").append(pageDivideHtml)}dataUtil.page(searchViewDom.find(".articlePageDivide"),data.pageIndex,data.totalRecord,data.pageMax,data.pageNum);searchViewDom.find(".articlePageDivide").undelegate("a","click").delegate("a","click",function(e){e.stopPropagation();e.preventDefault();var curPage=Number($(this).closest(".pageDivide").find(".Act").data("page")),dataType=$(this).data("type"),targetPage=1;if(isNaN(dataType)){targetPage=Number($(this).data("page"))}else{if(dataType===1){targetPage=curPage+1}else if(dataType===0){targetPage=curPage-1}}dataUtil.loadPageInfo("",$(this),targetPage,"#searchContent_"+mdId+"_view .articleSearchRes");viewByPage("article",targetPage,data.pageMax,function(resData){articleListView(resData)})})}else{searchViewDom.find(".articleSearchRes .resMainContent").html(noDataHtml)}}function getProdPanelHtml(itemData){var tempHtml="",prodObj={},tempPricePanelHtml="";prodObj["prodPicUrl"]=itemData.middtbnurl?itemData.middtbnurl:imgPath+"images/nopic.jpg";prodObj["prodPrice"]=itemData.salePrice;prodObj["prodPriceUnit"]=itemData.currencySymbol?itemData.currencySymbol:"￥";tempPricePanelHtml=!itemData.salePrice?'<div class="prodPricePanel textEllipsis"></div>':'<div class="prodPricePanel textEllipsis">'+'<span class="prodPriceUnit">'+prodObj["prodPriceUnit"]+"</span>"+'<span class="prodPriceNum">'+prodObj["prodPrice"]+"</span>"+"</div>";tempHtml='<div class="prodResPanel prodResLink">'+'<a href="displayproduct.html?id='+itemData.productId+'" target="_blank">'+'<div class="prodPic" style="background-image:url('+prodObj.prodPicUrl+')"></div>'+"</a>"+'<div class="prodDetail">'+'<a href="displayproduct.html?id='+itemData.productId+'" target="_blank">'+'<div class="prodTitlePanel">'+'<div class="prodTitle textEllipsis">'+itemData.productName+"</div>"+"</div>"+"</a>"+tempPricePanelHtml+"</div>"+"</div>";return tempHtml}function getArticlePanelHtml(itemData){var articlePicUrl=itemData.fileUrl,articlePubDate=itemData.publishDatetime.split(" ")[0],articleTypeHtml=itemData.typeName?'<span class="articleType articleIntroItem">'+langUtil.article_category+langUtil.Global_symbol+itemData.typeName+"</span>":"",authorHtml=itemData.author?'<span class="articleAuthor articleIntroItem">'+langUtil.article_author+langUtil.Global_symbol+itemData.author+"</span>":"",clickTimes=Number(itemData.clickTimes),viewNum=clickTimes>1e4?Math.floor(clickTimes/1e4)+"万"+"+":clickTimes,tempHtml="";if(!/((\/\/)+|(\.)+)/gi.test(articlePicUrl)){articlePicUrl=imgPath+"images/iyong/article-pic.jpg"}tempHtml='<div class="articleResPanel articleResLink">'+'<a href="displaynews.html?id='+itemData.articleId+'" target="_blank">'+'<div class="articlePic inline" style="background-image:url('+articlePicUrl+')"></div>'+"</a>"+'<div class="articleDetail inline">'+'<div class="articleTitlePanel">'+'<a href="displaynews.html?id='+itemData.articleId+'" target="_blank">'+'<div class="articleTitle">'+itemData.articleTitle+"</div>"+"</a>"+'<div class="articleIntro">'+articleTypeHtml+authorHtml+'<span class="articlePubDate articleIntroItem">'+langUtil.Global_data+langUtil.Global_symbol+articlePubDate+"</span>"+'<span class="articleRead">'+readLangStr+" "+viewNum+"</span>"+"</div>"+"</div>"+'<div class="articleDesc">'+itemData.articleDescription+"</div>"+"</div>"+"</div>";return tempHtml}}searchExecFn();searchViewDom.on("click",".searchExec",function(){var searchInputVal=$(this).closest(".searchContainer").find(".searchInput").val();searchExecFn(true,searchInputVal)}).on("focus",".searchInput",function(){$(this).on("keyup",function(e){if(e.keyCode===13){var searchInputVal=$(this).val();searchExecFn(true,searchInputVal)}})})};webUtil.decodeGueryString=function(name){var reg=new RegExp("(^|&)"+name+"=([^&]*)(&|$)"),r=window.location.search.substring(1).match(reg);if(r!=null){return decodeURI(r[2])}else{return null}};webUtil.fixedImageEvent=function(mdId,template,time,timeNum){$("#"+mdId+" .fixedImageCloseButton").click(function(){$("#"+mdId).addClass("moduleHide");if(time=="1"){if($("#"+mdId).find(".has_wow").css("animation-delay")){$("#"+mdId).find(".has_wow").css("animation-delay","0s")}setTimeout(function(){$("#"+mdId).removeClass("moduleHide")},parseInt(timeNum)*1e3)}});if(WebModel=="edit"){sysUtil.fixedImageEvent(mdId,template)}};webUtil.checkBrowser=function(){var ua=navigator.userAgent.toLocaleLowerCase();var browserType=null;if(ua.match(/msie/)!=null||ua.match(/trident/)!=null){browserType="ie";browserVersion=ua.match(/msie ([\d.]+)/)!=null?ua.match(/msie ([\d.]+)/)[1]:ua.match(/rv:([\d.]+)/)[1]}else if(ua.match(/firefox/)!=null){browserType="firefox"}else if(ua.match(/ubrowser/)!=null){browserType="uc"}else if(ua.match(/opera/)!=null||ua.match(/opr/)!=null){browserType="opera"}else if(ua.match(/bidubrowser/)!=null){browserType="baidu"}else if(ua.match(/metasr/)!=null){browserType="sougou"}else if(ua.match(/tencenttraveler/)!=null||ua.match(/qqbrowse/)!=null){browserType="qq"}else if(ua.match(/maxthon/)!=null){browserType="aoyou"}else if(ua.match(/chrome/)!=null){var _mime=function _mime(option,value){var mimeTypes=navigator.mimeTypes;for(var mt in mimeTypes){if(mimeTypes[mt][option]==value){return true}}return false};var is360=_mime("type","application/vnd.chromium.remoting-viewer");if(is360){browserType="360"}else{browserType="chrome"}}else if(ua.match(/safari/)!=null){browserType="Safari"}return browserType};webUtil.onlineMap_Multipoint=function(mdId,newdata,oldlng,oldlat,oldinfo,oldprovice,oldaddress,width,height){require(["jquery","async!BMap"],function($){var dmap=new BMap.Map("baiduMap2_"+mdId);var $mapDom=$("#baiduMap2_"+mdId);if(width){if(width.indexOf("%")<0){width=width+"px"}$mapDom.css({width:width,height:height})}var pointArray=new Array;var opts={width:250};var data=[];var really_old_provice="";if(oldlng!=""){var oldcity=oldprovice.replace("市","");require(["linkage/allcity"],function(cityData){$.each(cityData,function(i,n){$.each(n.city,function(j,k){if(k.name==oldcity){really_old_provice=n.name;data.push({address:oldaddress,city:oldcity,lat:oldlat,lng:oldlng,name:"",phone:"",province:really_old_provice,oldinfo:oldinfo});map_data_load()}})})})}else if(newdata.length===0){var dpoint=new BMap.Point(116.32842,39.979148);dmap.centerAndZoom("中山",12);dmap.enableScrollWheelZoom();dmap.enableContinuousZoom();dmap.enableInertialDragging();var bMapNavigation=new BMap.NavigationControl;dmap.addControl(bMapNavigation);var bMapScale=new BMap.ScaleControl;dmap.addControl(bMapScale)}else{data=newdata;map_data_load()}function map_data_load(){for(var i=0;i<data.length;i++){if(i==0){var dpoint=new BMap.Point(data[i].lng,data[i].lat)}pointArray[i]=new BMap.Point(data[i].lng,data[i].lat);var dmarker=new BMap.Marker(new BMap.Point(data[i].lng,data[i].lat));dmap.addOverlay(dmarker);var dlabel=new BMap.Label(data[i].name,{offset:new BMap.Size(15,-25)});dlabel.setStyle({maxWidth:"none",padding:"0 7px",color:"#fff",backgroundColor:"rgba(255,100,100,1)",border:'1px solid "rgba(255,100,100,1)"',borderRadius:"5px",textAlign:"center",height:"26px",lineHeight:"26px"});if(data[i].name.length){dmarker.setLabel(dlabel)}else{dmap.removeOverlay(dmarker.getLabel())}var content="<p>网点名称："+data[i].name+"</p>                                <p>联系电话："+data[i].phone+"</p>                                <p>地址："+data[i].province+"省"+data[i].city+"市"+data[i].address+"</p>";if(newdata.length===0){content=content+"<p>"+data[i].oldinfo+"</p>"}else if(data[i].mapinfo!=""){var textarea=document.createElement("textarea");textarea.setAttribute("class","mapinfo_scrollHeight");var t=document.createTextNode(data[i].mapinfo);textarea.appendChild(t);$("#baiduMap2_"+mdId)[0].appendChild(textarea);var height=$("#baiduMap2_"+mdId+" .mapinfo_scrollHeight")[0].scrollHeight+"px";var info_textarea='<textarea class="old_map_info_textarea" style="width:100%;outline:none;border:none;height:'+height+'">'+data[i].mapinfo+"</textarea>";content=content+info_textarea}addClickHandler(content,dmarker)}dmap.setViewport(pointArray)}function addClickHandler(content,dmarker){dmarker.addEventListener("click",function(e){openInfo(content,e,dmarker)})}function openInfo(content,e,dmarker){var p=e.target;var dpoint=new BMap.Point(p.getPosition().lng,p.getPosition().lat);var infoWindow=new BMap.InfoWindow(content,opts);dmarker.openInfoWindow(infoWindow,dpoint)}dmap.enableScrollWheelZoom();dmap.enableContinuousZoom();dmap.enableInertialDragging();var bMapNavigation=new BMap.NavigationControl;dmap.addControl(bMapNavigation);var bMapScale=new BMap.ScaleControl;dmap.addControl(bMapScale);setTimeout(function(){$("#baiduMap2_"+mdId+" .BMap_scaleCtrl").show()},1)})};webUtil.columnBgVideoPlay=function(mdId){var dataStoreDom=$("#"+mdId).find(".columnBgVideo");webUtil.loadSlideVideo({curDom:dataStoreDom,editShowFakeVideoCon:false,callback:function callback(){var videoDom=dataStoreDom.next("video"),browserType=webUtil.checkBrowser();if(browserType==="chrome"||browserType==="opera"){videoDom.prop("muted",true).attr("muted",true)}videoDom.css("display","block").get(0).play()}})};webUtil.prodCompReplacement=function(prodDom){var paramStr=JSON.stringify({isShelf:1,pageIndex:1,pageMax:50}),rpcPostData={syscode:"ecommerce",apicode:"listProductByPage",params:paramStr};$.ajax({type:"post",url:"/w/thirdSys/commonThirdRpc.do",data:rpcPostData,crossDomain:true,xhrFields:{withCredentials:true},success:function success(res){if(res.result=="SUCCESS"||res.result=="1000"){var rows=res.data.rows;if(rows.length>0){var replacement="",optionsElem="";rows.forEach(function(prodItem,i){var saveInHideStr=JSON.stringify({prodName:prodItem.productName,prodPic:prodItem.fileUrl,prodID:prodItem.productId});optionsElem+='\n                            <option value="'+prodItem.productName+"\" data-saveInHide='"+saveInHideStr+"'>\n                                "+prodItem.productName+"\n                            </option>\n                        "});replacement='\n                        <select class="itemSelect selectReplaceProd replaceProd input fullLen">\n                            <option value="">请选择</option>\n                            '+optionsElem+"\n                        </select>\n                    ";prodDom.html(replacement);var prodSelectDom=prodDom.find(".replaceProd");prodSelectDom.off("change").on("change",function(){var prodSelData=$(this).find("option:selected").attr("data-saveInHide");prodDom.data("prodSelData",prodSelData)})}}else{return}},error:function error(){return}})};